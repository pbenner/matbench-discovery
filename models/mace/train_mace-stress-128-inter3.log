2023-11-27 13:35:26.543 INFO: MACE version: 0.1.0
2023-11-27 13:35:26.543 INFO: Configuration: Namespace(name='MACE_MPtrj_2022.9', seed=42, log_dir='data-train-result-128-inter3/logs', model_dir='data-train-result-128-inter3', checkpoints_dir='data-train-result-128-inter3/checkpoints', results_dir='data-train-result-128-inter3/results', downloads_dir='data-train-result-128-inter3/downloads', default_dtype='float64', log_level='INFO', error_table='PerAtomMAE', model='ScaleShiftMACE', r_max=5.0, num_radial_basis=8, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=3, MLP_irreps='16x0e', hidden_irreps='32x0e', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='./data-train-preprocessed/train.h5', valid_file='./data-train-preprocessed/valid.h5', valid_fraction=0.1, test_file=None, test_dir=None, num_workers=8, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file='./data-train-preprocessed/statistics.json', E0s=None, energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='weighted-l1', forces_weight=1.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=32, valid_batch_size=32, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=40, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=True, restart_lr=0.001, save_cpu=True, clip_grad=10.0, wandb=False, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-11-27 13:35:26.544 INFO: Using statistics json file
2023-11-27 13:35:26.544 INFO: Using atomic numbers from statistics file
2023-11-27 13:35:26.544 INFO: AtomicNumberTable: (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 89, 90, 91, 92, 93, 94)
2023-11-27 13:35:26.544 INFO: Atomic Energies not in training file, using command line argument E0s
2023-11-27 13:35:26.545 INFO: Atomic energies: [-3.6673775936325184, -1.321978574671279, -3.47815910592578, -4.724966512505185, -7.727941403300326, -8.404543836565129, -7.359429774977432, -7.284436081345614, -4.896162007436489, -0.03005797428312995, -2.7527187727369, -2.8138258116559136, -4.844369939040846, -7.6966307568316115, -6.96321292174237, -4.673811566998673, -2.813984104722163, -0.06233472731112788, -2.6251773081704863, -5.384791381758609, -7.916197568907359, -10.270820955634214, -8.672390387555845, -9.2371580345617, -8.305620224433062, -7.054671703876374, -5.570915377375696, -5.174147851464132, -3.251035550574451, -1.2879654275024013, -3.5321835252059812, -4.711328365973749, -3.9717755452456673, -3.886221455984922, -2.5183143168985502, 6.706842222672468, -2.566057480857263, -4.938993788294903, -10.153603816562159, -11.857062150232505, -12.14164656151253, -8.786094380920531, -8.795434431218645, -7.778351502991773, -6.838726494373795, -4.881216430056056, -2.0605586704343675, -0.6439905162993389, -2.788575343692543, -3.816810475940441, -3.587983770584603, -2.8805917608627976, -1.6360524330360255, 9.796001071919388, -2.7486371263604354, -4.986670776340143, -8.929476698318382, -8.74170685282431, -8.01217127881877, -8.233598378021814, -7.62454389634746, -8.161368139142393, -13.591451290378114, -18.538136714242995, -7.644552511106582, -8.115049752450005, -7.614570319217799, -6.82962645334957, -7.820026786949461, -3.5770491745130024, -7.469205400904766, -12.770648602823787, -14.110986902146283, -9.354405708044254, -11.376459286198285, -9.611613368883013, -7.321263077561875, -5.304305597659051, -2.3873175082519373, 0.24792131307789267, -2.31553585581406, -3.7254481655069127, -3.4301772252097935, -5.065907805804548, -11.017529306980132, -12.244262478240024, -13.846602972246156, -14.952721865054968, -15.303292182007306]
2023-11-27 13:35:26.607 INFO: WeightedEnergyForcesLossL1(energy_weight=1.000, forces_weight=1.000)
2023-11-27 13:35:26.607 INFO: Average number of neighbors: 25.57754135131836
2023-11-27 13:35:26.607 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': False, 'dipoles': False}
2023-11-27 13:35:26.607 INFO: Building model
2023-11-27 13:35:26.607 INFO: Hidden irreps: 128x0e + 128x1o
2023-11-27 13:35:30.640 WARNING: Cannot find checkpoint with tag 'MACE_MPtrj_2022.9_run-42' in 'data-train-result-128-inter3/checkpoints'
2023-11-27 13:35:30.641 INFO: DistributedDataParallel(
  (module): ScaleShiftMACE(
    (node_embedding): LinearNodeEmbeddingBlock(
      (linear): Linear(89x0e -> 128x0e | 11392 weights)
    )
    (radial_embedding): RadialEmbeddingBlock(
      (bessel_fn): BesselBasis(r_max=4.5, num_basis=8, trainable=False)
      (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
    )
    (spherical_harmonics): SphericalHarmonics()
    (atomic_energies_fn): AtomicEnergiesBlock(energies=[-3.6674, -1.3220, -3.4782, -4.7250, -7.7279, -8.4045, -7.3594, -7.2844, -4.8962, -0.0301, -2.7527, -2.8138, -4.8444, -7.6966, -6.9632, -4.6738, -2.8140, -0.0623, -2.6252, -5.3848, -7.9162, -10.2708, -8.6724, -9.2372, -8.3056, -7.0547, -5.5709, -5.1741, -3.2510, -1.2880, -3.5322, -4.7113, -3.9718, -3.8862, -2.5183, 6.7068, -2.5661, -4.9390, -10.1536, -11.8571, -12.1416, -8.7861, -8.7954, -7.7784, -6.8387, -4.8812, -2.0606, -0.6440, -2.7886, -3.8168, -3.5880, -2.8806, -1.6361, 9.7960, -2.7486, -4.9867, -8.9295, -8.7417, -8.0122, -8.2336, -7.6245, -8.1614, -13.5915, -18.5381, -7.6446, -8.1150, -7.6146, -6.8296, -7.8200, -3.5770, -7.4692, -12.7706, -14.1110, -9.3544, -11.3765, -9.6116, -7.3213, -5.3043, -2.3873, 0.2479, -2.3155, -3.7254, -3.4302, -5.0659, -11.0175, -12.2443, -13.8466, -14.9527, -15.3033])
    (interactions): ModuleList(
      (0): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
        (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 512]
        (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e x 89x0e -> 128x0e+128x1o | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
      (1): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
        (conv_tp): TensorProduct(128x0e+128x1o x 1x0e+1x1o+1x2e+1x3o -> 256x0e+384x1o+384x2e+256x3o | 1280 paths | 1280 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1280]
        (linear): Linear(256x0e+384x1o+384x2e+256x3o -> 128x0e+128x1o+128x2e+128x3o | 163840 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o x 89x0e -> 128x0e+128x1o | 2916352 paths | 2916352 weights)
        (reshape): reshape_irreps()
      )
      (2): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
        (conv_tp): TensorProduct(128x0e+128x1o x 1x0e+1x1o+1x2e+1x3o -> 256x0e+384x1o+384x2e+256x3o | 1280 paths | 1280 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1280]
        (linear): Linear(256x0e+384x1o+384x2e+256x3o -> 128x0e+128x1o+128x2e+128x3o | 163840 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o x 89x0e -> 128x0e | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
    )
    (products): ModuleList(
      (0-1): 2 x EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
            (1): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x6x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
      )
      (2): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e -> 128x0e | 16384 weights)
      )
    )
    (readouts): ModuleList(
      (0-1): 2 x LinearReadoutBlock(
        (linear): Linear(128x0e+128x1o -> 1x0e | 128 weights)
      )
      (2): NonLinearReadoutBlock(
        (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
        (non_linearity): Activation [x] (16x0e -> 16x0e)
        (linear_2): Linear(16x0e -> 1x0e | 16 weights)
      )
    )
    (scale_shift): ScaleShiftBlock(scale=0.804340, shift=0.164779)
  )
)
2023-11-27 13:35:30.646 INFO: Number of parameters: 8904592
2023-11-27 13:35:30.646 INFO: Optimizer: AcceleratedOptimizer (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    name: interactions_decay
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    name: interactions_no_decay
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    name: products
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2023-11-27 13:35:30.646 INFO: Using gradient clipping with tolerance=10.000
2023-11-27 13:35:30.646 INFO: Started training
2023-11-27 13:35:32.599 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-27 13:35:32.599 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-27 13:35:32.600 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-27 13:35:32.600 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-27 15:33:21.540 INFO: Epoch 0: loss=0.0062, MAE_E_per_atom=72.7 meV, MAE_F=126.7 meV / A
2023-11-27 15:33:21.543 INFO: Saving current state to data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-0
2023-11-27 15:33:21.648 INFO: Model weights saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-0/pytorch_model.bin
2023-11-27 15:33:21.828 INFO: Optimizer state saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-0/optimizer.bin
2023-11-27 15:33:21.832 INFO: Random states saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-0/random_states_0.pkl
2023-11-27 19:22:43.060 INFO: Epoch 2: loss=0.0043, MAE_E_per_atom=40.4 meV, MAE_F=97.4 meV / A
2023-11-27 19:22:43.082 INFO: Saving current state to data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-2
2023-11-27 19:22:43.168 INFO: Model weights saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-2/pytorch_model.bin
2023-11-27 19:22:43.382 INFO: Optimizer state saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-2/optimizer.bin
2023-11-27 19:22:43.383 INFO: Random states saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-2/random_states_0.pkl
2023-11-27 23:19:44.651 INFO: Epoch 4: loss=0.0037, MAE_E_per_atom=32.6 meV, MAE_F=86.8 meV / A
2023-11-27 23:19:44.676 INFO: Saving current state to data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-4
2023-11-27 23:19:44.781 INFO: Model weights saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-4/pytorch_model.bin
2023-11-27 23:19:45.013 INFO: Optimizer state saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-4/optimizer.bin
2023-11-27 23:19:45.014 INFO: Random states saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-4/random_states_0.pkl
2023-11-28 03:31:13.636 INFO: Epoch 6: loss=0.0034, MAE_E_per_atom=28.7 meV, MAE_F=80.3 meV / A
2023-11-28 03:31:13.662 INFO: Saving current state to data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-6
2023-11-28 03:31:13.771 INFO: Model weights saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-6/pytorch_model.bin
2023-11-28 03:31:14.014 INFO: Optimizer state saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-6/optimizer.bin
2023-11-28 03:31:14.016 INFO: Random states saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-6/random_states_0.pkl
2023-11-28 08:06:17.057 INFO: Epoch 8: loss=0.0032, MAE_E_per_atom=26.0 meV, MAE_F=76.2 meV / A
2023-11-28 08:06:17.083 INFO: Saving current state to data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-8
2023-11-28 08:06:17.178 INFO: Model weights saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-8/pytorch_model.bin
2023-11-28 08:06:17.344 INFO: Optimizer state saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-8/optimizer.bin
2023-11-28 08:06:17.346 INFO: Random states saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-8/random_states_0.pkl
2023-11-28 13:03:40.194 INFO: Epoch 10: loss=0.0031, MAE_E_per_atom=25.3 meV, MAE_F=74.5 meV / A
2023-11-28 13:03:40.218 INFO: Saving current state to data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-10
2023-11-28 13:03:40.297 INFO: Model weights saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-10/pytorch_model.bin
2023-11-28 13:03:40.463 INFO: Optimizer state saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-10/optimizer.bin
2023-11-28 13:03:40.465 INFO: Random states saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-10/random_states_0.pkl
2023-11-28 18:17:25.520 INFO: Epoch 12: loss=0.0029, MAE_E_per_atom=22.8 meV, MAE_F=70.0 meV / A
2023-11-28 18:17:25.548 INFO: Saving current state to data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-12
2023-11-28 18:17:25.655 INFO: Model weights saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-12/pytorch_model.bin
2023-11-28 18:17:25.871 INFO: Optimizer state saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-12/optimizer.bin
2023-11-28 18:17:25.872 INFO: Random states saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-12/random_states_0.pkl
2023-11-28 23:59:20.000 INFO: Epoch 14: loss=0.0028, MAE_E_per_atom=21.8 meV, MAE_F=68.1 meV / A
2023-11-28 23:59:20.027 INFO: Saving current state to data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-14
2023-11-28 23:59:20.134 INFO: Model weights saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-14/pytorch_model.bin
2023-11-28 23:59:20.363 INFO: Optimizer state saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-14/optimizer.bin
2023-11-28 23:59:20.364 INFO: Random states saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-14/random_states_0.pkl
2023-11-29 06:16:37.877 INFO: Epoch 16: loss=0.0027, MAE_E_per_atom=21.0 meV, MAE_F=66.4 meV / A
2023-11-29 06:16:37.902 INFO: Saving current state to data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-16
2023-11-29 06:16:38.012 INFO: Model weights saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-16/pytorch_model.bin
2023-11-29 06:16:38.255 INFO: Optimizer state saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-16/optimizer.bin
2023-11-29 06:16:38.256 INFO: Random states saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-16/random_states_0.pkl
2023-11-29 12:35:43.918 INFO: MACE version: 0.1.0
2023-11-29 12:35:43.918 INFO: Configuration: Namespace(name='MACE_MPtrj_2022.9', seed=42, log_dir='data-train-result-128-inter3/logs', model_dir='data-train-result-128-inter3', checkpoints_dir='data-train-result-128-inter3/checkpoints', results_dir='data-train-result-128-inter3/results', downloads_dir='data-train-result-128-inter3/downloads', default_dtype='float64', log_level='INFO', error_table='PerAtomMAE', model='ScaleShiftMACE', r_max=5.0, num_radial_basis=8, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=3, MLP_irreps='16x0e', hidden_irreps='32x0e', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='./data-train-preprocessed/train.h5', valid_file='./data-train-preprocessed/valid.h5', valid_fraction=0.1, test_file=None, test_dir=None, num_workers=8, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file='./data-train-preprocessed/statistics.json', E0s=None, energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='weighted-l1', forces_weight=1.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=32, valid_batch_size=32, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=40, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=True, restart_lr=0.001, save_cpu=True, clip_grad=10.0, wandb=False, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-11-29 12:35:43.918 INFO: Using statistics json file
2023-11-29 12:35:43.919 INFO: Using atomic numbers from statistics file
2023-11-29 12:35:43.919 INFO: AtomicNumberTable: (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 89, 90, 91, 92, 93, 94)
2023-11-29 12:35:43.919 INFO: Atomic Energies not in training file, using command line argument E0s
2023-11-29 12:35:43.920 INFO: Atomic energies: [-3.6673775936325184, -1.321978574671279, -3.47815910592578, -4.724966512505185, -7.727941403300326, -8.404543836565129, -7.359429774977432, -7.284436081345614, -4.896162007436489, -0.03005797428312995, -2.7527187727369, -2.8138258116559136, -4.844369939040846, -7.6966307568316115, -6.96321292174237, -4.673811566998673, -2.813984104722163, -0.06233472731112788, -2.6251773081704863, -5.384791381758609, -7.916197568907359, -10.270820955634214, -8.672390387555845, -9.2371580345617, -8.305620224433062, -7.054671703876374, -5.570915377375696, -5.174147851464132, -3.251035550574451, -1.2879654275024013, -3.5321835252059812, -4.711328365973749, -3.9717755452456673, -3.886221455984922, -2.5183143168985502, 6.706842222672468, -2.566057480857263, -4.938993788294903, -10.153603816562159, -11.857062150232505, -12.14164656151253, -8.786094380920531, -8.795434431218645, -7.778351502991773, -6.838726494373795, -4.881216430056056, -2.0605586704343675, -0.6439905162993389, -2.788575343692543, -3.816810475940441, -3.587983770584603, -2.8805917608627976, -1.6360524330360255, 9.796001071919388, -2.7486371263604354, -4.986670776340143, -8.929476698318382, -8.74170685282431, -8.01217127881877, -8.233598378021814, -7.62454389634746, -8.161368139142393, -13.591451290378114, -18.538136714242995, -7.644552511106582, -8.115049752450005, -7.614570319217799, -6.82962645334957, -7.820026786949461, -3.5770491745130024, -7.469205400904766, -12.770648602823787, -14.110986902146283, -9.354405708044254, -11.376459286198285, -9.611613368883013, -7.321263077561875, -5.304305597659051, -2.3873175082519373, 0.24792131307789267, -2.31553585581406, -3.7254481655069127, -3.4301772252097935, -5.065907805804548, -11.017529306980132, -12.244262478240024, -13.846602972246156, -14.952721865054968, -15.303292182007306]
2023-11-29 12:35:43.983 INFO: WeightedEnergyForcesLossL1(energy_weight=1.000, forces_weight=1.000)
2023-11-29 12:35:43.983 INFO: Average number of neighbors: 25.57754135131836
2023-11-29 12:35:43.983 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': False, 'dipoles': False}
2023-11-29 12:35:43.984 INFO: Building model
2023-11-29 12:35:43.984 INFO: Hidden irreps: 128x0e + 128x1o
2023-11-29 12:35:47.599 INFO: Loading states from data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-16
2023-11-29 12:35:47.656 INFO: All model weights loaded successfully
2023-11-29 12:35:47.774 INFO: All optimizer states loaded successfully
2023-11-29 12:35:47.774 INFO: All scheduler states loaded successfully
2023-11-29 12:35:47.779 INFO: All random states loaded successfully
2023-11-29 12:35:47.779 INFO: Loading in 0 custom states
2023-11-29 12:35:47.780 INFO: DistributedDataParallel(
  (module): ScaleShiftMACE(
    (node_embedding): LinearNodeEmbeddingBlock(
      (linear): Linear(89x0e -> 128x0e | 11392 weights)
    )
    (radial_embedding): RadialEmbeddingBlock(
      (bessel_fn): BesselBasis(r_max=4.5, num_basis=8, trainable=False)
      (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
    )
    (spherical_harmonics): SphericalHarmonics()
    (atomic_energies_fn): AtomicEnergiesBlock(energies=[-3.6674, -1.3220, -3.4782, -4.7250, -7.7279, -8.4045, -7.3594, -7.2844, -4.8962, -0.0301, -2.7527, -2.8138, -4.8444, -7.6966, -6.9632, -4.6738, -2.8140, -0.0623, -2.6252, -5.3848, -7.9162, -10.2708, -8.6724, -9.2372, -8.3056, -7.0547, -5.5709, -5.1741, -3.2510, -1.2880, -3.5322, -4.7113, -3.9718, -3.8862, -2.5183, 6.7068, -2.5661, -4.9390, -10.1536, -11.8571, -12.1416, -8.7861, -8.7954, -7.7784, -6.8387, -4.8812, -2.0606, -0.6440, -2.7886, -3.8168, -3.5880, -2.8806, -1.6361, 9.7960, -2.7486, -4.9867, -8.9295, -8.7417, -8.0122, -8.2336, -7.6245, -8.1614, -13.5915, -18.5381, -7.6446, -8.1150, -7.6146, -6.8296, -7.8200, -3.5770, -7.4692, -12.7706, -14.1110, -9.3544, -11.3765, -9.6116, -7.3213, -5.3043, -2.3873, 0.2479, -2.3155, -3.7254, -3.4302, -5.0659, -11.0175, -12.2443, -13.8466, -14.9527, -15.3033])
    (interactions): ModuleList(
      (0): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
        (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 512]
        (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e x 89x0e -> 128x0e+128x1o | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
      (1): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
        (conv_tp): TensorProduct(128x0e+128x1o x 1x0e+1x1o+1x2e+1x3o -> 256x0e+384x1o+384x2e+256x3o | 1280 paths | 1280 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1280]
        (linear): Linear(256x0e+384x1o+384x2e+256x3o -> 128x0e+128x1o+128x2e+128x3o | 163840 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o x 89x0e -> 128x0e+128x1o | 2916352 paths | 2916352 weights)
        (reshape): reshape_irreps()
      )
      (2): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
        (conv_tp): TensorProduct(128x0e+128x1o x 1x0e+1x1o+1x2e+1x3o -> 256x0e+384x1o+384x2e+256x3o | 1280 paths | 1280 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1280]
        (linear): Linear(256x0e+384x1o+384x2e+256x3o -> 128x0e+128x1o+128x2e+128x3o | 163840 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o x 89x0e -> 128x0e | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
    )
    (products): ModuleList(
      (0-1): 2 x EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
            (1): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x6x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
      )
      (2): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e -> 128x0e | 16384 weights)
      )
    )
    (readouts): ModuleList(
      (0-1): 2 x LinearReadoutBlock(
        (linear): Linear(128x0e+128x1o -> 1x0e | 128 weights)
      )
      (2): NonLinearReadoutBlock(
        (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
        (non_linearity): Activation [x] (16x0e -> 16x0e)
        (linear_2): Linear(16x0e -> 1x0e | 16 weights)
      )
    )
    (scale_shift): ScaleShiftBlock(scale=0.804340, shift=0.164779)
  )
)
2023-11-29 12:35:47.785 INFO: Number of parameters: 8904592
2023-11-29 12:35:47.785 INFO: Optimizer: AcceleratedOptimizer (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    name: interactions_decay
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    name: interactions_no_decay
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    name: products
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2023-11-29 12:35:47.785 INFO: Using gradient clipping with tolerance=10.000
2023-11-29 12:35:47.785 INFO: Started training
2023-11-29 12:35:49.717 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-29 12:35:49.717 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-29 12:35:49.717 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-29 15:06:26.710 INFO: Epoch 16: loss=0.0027, MAE_E_per_atom=20.9 meV, MAE_F=66.3 meV / A
2023-11-29 15:06:26.712 INFO: Saving current state to data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-16
2023-11-29 15:06:26.860 INFO: Model weights saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-16/pytorch_model.bin
2023-11-29 15:06:27.228 INFO: Optimizer state saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-16/optimizer.bin
2023-11-29 15:06:27.232 INFO: Random states saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-16/random_states_0.pkl
2023-11-29 20:05:20.162 INFO: Epoch 18: loss=0.0027, MAE_E_per_atom=20.3 meV, MAE_F=64.8 meV / A
2023-11-29 20:05:20.187 INFO: Saving current state to data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-18
2023-11-29 20:05:20.296 INFO: Model weights saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-18/pytorch_model.bin
2023-11-29 20:05:20.532 INFO: Optimizer state saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-18/optimizer.bin
2023-11-29 20:05:20.533 INFO: Random states saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-18/random_states_0.pkl
2023-11-30 01:23:04.264 INFO: Epoch 20: loss=0.0026, MAE_E_per_atom=20.0 meV, MAE_F=64.1 meV / A
2023-11-30 01:23:04.294 INFO: Saving current state to data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-20
2023-11-30 01:23:04.398 INFO: Model weights saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-20/pytorch_model.bin
2023-11-30 01:23:04.623 INFO: Optimizer state saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-20/optimizer.bin
2023-11-30 01:23:04.624 INFO: Random states saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-20/random_states_0.pkl
2023-11-30 07:27:26.883 INFO: Epoch 22: loss=0.0025, MAE_E_per_atom=19.0 meV, MAE_F=61.9 meV / A
2023-11-30 07:27:26.911 INFO: Saving current state to data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-22
2023-11-30 07:27:27.015 INFO: Model weights saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-22/pytorch_model.bin
2023-11-30 07:27:27.217 INFO: Optimizer state saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-22/optimizer.bin
2023-11-30 07:27:27.218 INFO: Random states saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-22/random_states_0.pkl
2023-11-30 14:15:09.084 INFO: Epoch 24: loss=0.0025, MAE_E_per_atom=18.9 meV, MAE_F=62.2 meV / A
2023-11-30 21:08:48.314 INFO: Epoch 26: loss=0.0024, MAE_E_per_atom=18.0 meV, MAE_F=60.0 meV / A
2023-11-30 21:08:48.335 INFO: Saving current state to data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-26
2023-11-30 21:08:48.414 INFO: Model weights saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-26/pytorch_model.bin
2023-11-30 21:08:48.584 INFO: Optimizer state saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-26/optimizer.bin
2023-11-30 21:08:48.585 INFO: Random states saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-26/random_states_0.pkl
2023-12-01 04:25:47.236 INFO: Epoch 28: loss=0.0024, MAE_E_per_atom=17.7 meV, MAE_F=59.2 meV / A
2023-12-01 04:25:47.256 INFO: Saving current state to data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-28
2023-12-01 04:25:47.330 INFO: Model weights saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-28/pytorch_model.bin
2023-12-01 04:25:47.494 INFO: Optimizer state saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-28/optimizer.bin
2023-12-01 04:25:47.496 INFO: Random states saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-28/random_states_0.pkl
2023-12-01 13:03:07.907 INFO: Epoch 30: loss=0.0024, MAE_E_per_atom=17.2 meV, MAE_F=58.4 meV / A
2023-12-01 13:03:07.934 INFO: Saving current state to data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-30
2023-12-01 13:03:08.042 INFO: Model weights saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-30/pytorch_model.bin
2023-12-01 13:03:08.282 INFO: Optimizer state saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-30/optimizer.bin
2023-12-01 13:03:08.284 INFO: Random states saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-30/random_states_0.pkl
2023-12-01 22:55:56.958 INFO: Epoch 32: loss=0.0023, MAE_E_per_atom=17.1 meV, MAE_F=57.8 meV / A
2023-12-01 22:55:56.983 INFO: Saving current state to data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-32
2023-12-01 22:55:57.087 INFO: Model weights saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-32/pytorch_model.bin
2023-12-01 22:55:57.317 INFO: Optimizer state saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-32/optimizer.bin
2023-12-01 22:55:57.318 INFO: Random states saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-32/random_states_0.pkl
2023-12-02 09:29:35.951 INFO: Epoch 34: loss=0.0023, MAE_E_per_atom=16.7 meV, MAE_F=57.4 meV / A
2023-12-02 09:29:35.979 INFO: Saving current state to data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-34
2023-12-02 09:29:36.078 INFO: Model weights saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-34/pytorch_model.bin
2023-12-02 09:29:36.255 INFO: Optimizer state saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-34/optimizer.bin
2023-12-02 09:29:36.256 INFO: Random states saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-34/random_states_0.pkl
2023-12-02 10:35:06.599 INFO: MACE version: 0.1.0
2023-12-02 10:35:06.599 INFO: Configuration: Namespace(name='MACE_MPtrj_2022.9', seed=42, log_dir='data-train-result-128-inter3/logs', model_dir='data-train-result-128-inter3', checkpoints_dir='data-train-result-128-inter3/checkpoints', results_dir='data-train-result-128-inter3/results', downloads_dir='data-train-result-128-inter3/downloads', default_dtype='float64', log_level='INFO', error_table='PerAtomMAE', model='ScaleShiftMACE', r_max=5.0, num_radial_basis=8, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=3, MLP_irreps='16x0e', hidden_irreps='32x0e', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='./data-train-preprocessed/train.h5', valid_file='./data-train-preprocessed/valid.h5', valid_fraction=0.1, test_file=None, test_dir=None, num_workers=8, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file='./data-train-preprocessed/statistics.json', E0s=None, energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='weighted-l1', forces_weight=1.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=32, valid_batch_size=32, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=40, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=True, restart_lr=0.001, save_cpu=True, clip_grad=10.0, wandb=False, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-12-02 10:35:06.599 INFO: Using statistics json file
2023-12-02 10:35:06.599 INFO: Using atomic numbers from statistics file
2023-12-02 10:35:06.600 INFO: AtomicNumberTable: (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 89, 90, 91, 92, 93, 94)
2023-12-02 10:35:06.600 INFO: Atomic Energies not in training file, using command line argument E0s
2023-12-02 10:35:06.600 INFO: Atomic energies: [-3.6673775936325184, -1.321978574671279, -3.47815910592578, -4.724966512505185, -7.727941403300326, -8.404543836565129, -7.359429774977432, -7.284436081345614, -4.896162007436489, -0.03005797428312995, -2.7527187727369, -2.8138258116559136, -4.844369939040846, -7.6966307568316115, -6.96321292174237, -4.673811566998673, -2.813984104722163, -0.06233472731112788, -2.6251773081704863, -5.384791381758609, -7.916197568907359, -10.270820955634214, -8.672390387555845, -9.2371580345617, -8.305620224433062, -7.054671703876374, -5.570915377375696, -5.174147851464132, -3.251035550574451, -1.2879654275024013, -3.5321835252059812, -4.711328365973749, -3.9717755452456673, -3.886221455984922, -2.5183143168985502, 6.706842222672468, -2.566057480857263, -4.938993788294903, -10.153603816562159, -11.857062150232505, -12.14164656151253, -8.786094380920531, -8.795434431218645, -7.778351502991773, -6.838726494373795, -4.881216430056056, -2.0605586704343675, -0.6439905162993389, -2.788575343692543, -3.816810475940441, -3.587983770584603, -2.8805917608627976, -1.6360524330360255, 9.796001071919388, -2.7486371263604354, -4.986670776340143, -8.929476698318382, -8.74170685282431, -8.01217127881877, -8.233598378021814, -7.62454389634746, -8.161368139142393, -13.591451290378114, -18.538136714242995, -7.644552511106582, -8.115049752450005, -7.614570319217799, -6.82962645334957, -7.820026786949461, -3.5770491745130024, -7.469205400904766, -12.770648602823787, -14.110986902146283, -9.354405708044254, -11.376459286198285, -9.611613368883013, -7.321263077561875, -5.304305597659051, -2.3873175082519373, 0.24792131307789267, -2.31553585581406, -3.7254481655069127, -3.4301772252097935, -5.065907805804548, -11.017529306980132, -12.244262478240024, -13.846602972246156, -14.952721865054968, -15.303292182007306]
2023-12-02 10:35:06.662 INFO: WeightedEnergyForcesLossL1(energy_weight=1.000, forces_weight=1.000)
2023-12-02 10:35:06.662 INFO: Average number of neighbors: 25.57754135131836
2023-12-02 10:35:06.663 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': False, 'dipoles': False}
2023-12-02 10:35:06.663 INFO: Building model
2023-12-02 10:35:06.663 INFO: Hidden irreps: 128x0e + 128x1o
2023-12-02 10:35:10.646 INFO: Loading states from data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-34
2023-12-02 10:35:10.699 INFO: All model weights loaded successfully
2023-12-02 10:35:10.813 INFO: All optimizer states loaded successfully
2023-12-02 10:35:10.813 INFO: All scheduler states loaded successfully
2023-12-02 10:35:10.817 INFO: All random states loaded successfully
2023-12-02 10:35:10.818 INFO: Loading in 0 custom states
2023-12-02 10:35:10.819 INFO: DistributedDataParallel(
  (module): ScaleShiftMACE(
    (node_embedding): LinearNodeEmbeddingBlock(
      (linear): Linear(89x0e -> 128x0e | 11392 weights)
    )
    (radial_embedding): RadialEmbeddingBlock(
      (bessel_fn): BesselBasis(r_max=4.5, num_basis=8, trainable=False)
      (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
    )
    (spherical_harmonics): SphericalHarmonics()
    (atomic_energies_fn): AtomicEnergiesBlock(energies=[-3.6674, -1.3220, -3.4782, -4.7250, -7.7279, -8.4045, -7.3594, -7.2844, -4.8962, -0.0301, -2.7527, -2.8138, -4.8444, -7.6966, -6.9632, -4.6738, -2.8140, -0.0623, -2.6252, -5.3848, -7.9162, -10.2708, -8.6724, -9.2372, -8.3056, -7.0547, -5.5709, -5.1741, -3.2510, -1.2880, -3.5322, -4.7113, -3.9718, -3.8862, -2.5183, 6.7068, -2.5661, -4.9390, -10.1536, -11.8571, -12.1416, -8.7861, -8.7954, -7.7784, -6.8387, -4.8812, -2.0606, -0.6440, -2.7886, -3.8168, -3.5880, -2.8806, -1.6361, 9.7960, -2.7486, -4.9867, -8.9295, -8.7417, -8.0122, -8.2336, -7.6245, -8.1614, -13.5915, -18.5381, -7.6446, -8.1150, -7.6146, -6.8296, -7.8200, -3.5770, -7.4692, -12.7706, -14.1110, -9.3544, -11.3765, -9.6116, -7.3213, -5.3043, -2.3873, 0.2479, -2.3155, -3.7254, -3.4302, -5.0659, -11.0175, -12.2443, -13.8466, -14.9527, -15.3033])
    (interactions): ModuleList(
      (0): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
        (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 512]
        (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e x 89x0e -> 128x0e+128x1o | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
      (1): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
        (conv_tp): TensorProduct(128x0e+128x1o x 1x0e+1x1o+1x2e+1x3o -> 256x0e+384x1o+384x2e+256x3o | 1280 paths | 1280 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1280]
        (linear): Linear(256x0e+384x1o+384x2e+256x3o -> 128x0e+128x1o+128x2e+128x3o | 163840 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o x 89x0e -> 128x0e+128x1o | 2916352 paths | 2916352 weights)
        (reshape): reshape_irreps()
      )
      (2): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
        (conv_tp): TensorProduct(128x0e+128x1o x 1x0e+1x1o+1x2e+1x3o -> 256x0e+384x1o+384x2e+256x3o | 1280 paths | 1280 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1280]
        (linear): Linear(256x0e+384x1o+384x2e+256x3o -> 128x0e+128x1o+128x2e+128x3o | 163840 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o x 89x0e -> 128x0e | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
    )
    (products): ModuleList(
      (0-1): 2 x EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
            (1): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x6x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
      )
      (2): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e -> 128x0e | 16384 weights)
      )
    )
    (readouts): ModuleList(
      (0-1): 2 x LinearReadoutBlock(
        (linear): Linear(128x0e+128x1o -> 1x0e | 128 weights)
      )
      (2): NonLinearReadoutBlock(
        (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
        (non_linearity): Activation [x] (16x0e -> 16x0e)
        (linear_2): Linear(16x0e -> 1x0e | 16 weights)
      )
    )
    (scale_shift): ScaleShiftBlock(scale=0.804340, shift=0.164779)
  )
)
2023-12-02 10:35:10.824 INFO: Number of parameters: 8904592
2023-12-02 10:35:10.824 INFO: Optimizer: AcceleratedOptimizer (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    name: interactions_decay
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    name: interactions_no_decay
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    name: products
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2023-12-02 10:35:10.824 INFO: Using gradient clipping with tolerance=10.000
2023-12-02 10:35:10.824 INFO: Started training
2023-12-02 10:35:12.902 INFO: Reducer buckets have been rebuilt in this iteration.
2023-12-02 10:35:12.902 INFO: Reducer buckets have been rebuilt in this iteration.
2023-12-02 10:35:12.902 INFO: Reducer buckets have been rebuilt in this iteration.
2023-12-02 10:35:12.902 INFO: Reducer buckets have been rebuilt in this iteration.
2023-12-02 12:33:05.257 INFO: Epoch 34: loss=0.0023, MAE_E_per_atom=16.1 meV, MAE_F=56.2 meV / A
2023-12-02 12:33:05.259 INFO: Saving current state to data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-34
2023-12-02 12:33:05.415 INFO: Model weights saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-34/pytorch_model.bin
2023-12-02 12:33:05.708 INFO: Optimizer state saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-34/optimizer.bin
2023-12-02 12:33:05.710 INFO: Random states saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-34/random_states_0.pkl
2023-12-02 16:22:15.669 INFO: Epoch 36: loss=0.0022, MAE_E_per_atom=15.9 meV, MAE_F=55.8 meV / A
2023-12-02 16:22:15.694 INFO: Saving current state to data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-36
2023-12-02 16:22:15.795 INFO: Model weights saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-36/pytorch_model.bin
2023-12-02 16:22:16.019 INFO: Optimizer state saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-36/optimizer.bin
2023-12-02 16:22:16.021 INFO: Random states saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-36/random_states_0.pkl
2023-12-02 20:19:11.940 INFO: Epoch 38: loss=0.0022, MAE_E_per_atom=15.8 meV, MAE_F=55.4 meV / A
2023-12-02 20:19:11.966 INFO: Saving current state to data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-38
2023-12-02 20:19:12.072 INFO: Model weights saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-38/pytorch_model.bin
2023-12-02 20:19:12.260 INFO: Optimizer state saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-38/optimizer.bin
2023-12-02 20:19:12.261 INFO: Random states saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-38/random_states_0.pkl
2023-12-02 22:17:32.988 INFO: Training complete
2023-12-02 22:17:32.989 INFO: Computing metrics for training, validation, and test sets
2023-12-02 22:17:32.989 INFO: Loading states from data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-38
2023-12-02 22:17:33.039 INFO: All model weights loaded successfully
2023-12-02 22:17:33.164 INFO: All optimizer states loaded successfully
2023-12-02 22:17:33.164 INFO: All scheduler states loaded successfully
2023-12-02 22:17:33.164 INFO: All random states loaded successfully
2023-12-02 22:17:33.165 INFO: Loading in 0 custom states
2023-12-02 22:17:33.165 INFO: Loaded model from epoch 38
2023-12-02 22:17:33.165 INFO: Evaluating train ...
2023-12-02 23:07:45.164 INFO: Evaluating valid ...
2023-12-02 23:18:14.158 INFO: 
+-------------+--------------------+-----------------+------------------+
| config_type | MAE E / meV / atom | MAE F / meV / A | relative F MAE % |
+-------------+--------------------+-----------------+------------------+
|    train    |        14.9        |       52.6      |      33.27       |
|    valid    |        15.8        |       55.4      |      35.91       |
+-------------+--------------------+-----------------+------------------+
2023-12-02 23:18:14.158 INFO: Saving model to data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42.model
2023-12-02 23:18:14.529 INFO: Done
2023-12-03 10:49:09.931 INFO: MACE version: 0.1.0
2023-12-03 10:49:09.931 INFO: Configuration: Namespace(name='MACE_MPtrj_2022.9', seed=42, log_dir='data-train-result-128-inter3/logs', model_dir='data-train-result-128-inter3', checkpoints_dir='data-train-result-128-inter3/checkpoints', results_dir='data-train-result-128-inter3/results', downloads_dir='data-train-result-128-inter3/downloads', default_dtype='float64', log_level='INFO', error_table='PerAtomMAE', model='ScaleShiftMACE', r_max=5.0, num_radial_basis=8, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=3, MLP_irreps='16x0e', hidden_irreps='32x0e', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='./data-train-preprocessed/train.h5', valid_file='./data-train-preprocessed/valid.h5', valid_fraction=0.1, test_file=None, test_dir=None, num_workers=8, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file='./data-train-preprocessed/statistics.json', E0s=None, energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='weighted-l1', forces_weight=1.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=32, valid_batch_size=32, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=120, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=True, restart_lr=0.0005, save_cpu=True, clip_grad=10.0, wandb=False, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-12-03 10:49:09.931 INFO: Using statistics json file
2023-12-03 10:49:09.931 INFO: Using atomic numbers from statistics file
2023-12-03 10:49:09.932 INFO: AtomicNumberTable: (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 89, 90, 91, 92, 93, 94)
2023-12-03 10:49:09.932 INFO: Atomic Energies not in training file, using command line argument E0s
2023-12-03 10:49:09.933 INFO: Atomic energies: [-3.6673775936325184, -1.321978574671279, -3.47815910592578, -4.724966512505185, -7.727941403300326, -8.404543836565129, -7.359429774977432, -7.284436081345614, -4.896162007436489, -0.03005797428312995, -2.7527187727369, -2.8138258116559136, -4.844369939040846, -7.6966307568316115, -6.96321292174237, -4.673811566998673, -2.813984104722163, -0.06233472731112788, -2.6251773081704863, -5.384791381758609, -7.916197568907359, -10.270820955634214, -8.672390387555845, -9.2371580345617, -8.305620224433062, -7.054671703876374, -5.570915377375696, -5.174147851464132, -3.251035550574451, -1.2879654275024013, -3.5321835252059812, -4.711328365973749, -3.9717755452456673, -3.886221455984922, -2.5183143168985502, 6.706842222672468, -2.566057480857263, -4.938993788294903, -10.153603816562159, -11.857062150232505, -12.14164656151253, -8.786094380920531, -8.795434431218645, -7.778351502991773, -6.838726494373795, -4.881216430056056, -2.0605586704343675, -0.6439905162993389, -2.788575343692543, -3.816810475940441, -3.587983770584603, -2.8805917608627976, -1.6360524330360255, 9.796001071919388, -2.7486371263604354, -4.986670776340143, -8.929476698318382, -8.74170685282431, -8.01217127881877, -8.233598378021814, -7.62454389634746, -8.161368139142393, -13.591451290378114, -18.538136714242995, -7.644552511106582, -8.115049752450005, -7.614570319217799, -6.82962645334957, -7.820026786949461, -3.5770491745130024, -7.469205400904766, -12.770648602823787, -14.110986902146283, -9.354405708044254, -11.376459286198285, -9.611613368883013, -7.321263077561875, -5.304305597659051, -2.3873175082519373, 0.24792131307789267, -2.31553585581406, -3.7254481655069127, -3.4301772252097935, -5.065907805804548, -11.017529306980132, -12.244262478240024, -13.846602972246156, -14.952721865054968, -15.303292182007306]
2023-12-03 10:49:09.989 INFO: WeightedEnergyForcesLossL1(energy_weight=1.000, forces_weight=1.000)
2023-12-03 10:49:09.989 INFO: Average number of neighbors: 25.57754135131836
2023-12-03 10:49:09.989 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': False, 'dipoles': False}
2023-12-03 10:49:09.989 INFO: Building model
2023-12-03 10:49:09.990 INFO: Hidden irreps: 128x0e + 128x1o
2023-12-03 10:49:14.016 INFO: Loading states from data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-38
2023-12-03 10:49:14.068 INFO: All model weights loaded successfully
2023-12-03 10:49:14.192 INFO: All optimizer states loaded successfully
2023-12-03 10:49:14.192 INFO: All scheduler states loaded successfully
2023-12-03 10:49:14.196 INFO: All random states loaded successfully
2023-12-03 10:49:14.196 INFO: Loading in 0 custom states
2023-12-03 10:49:14.198 INFO: DistributedDataParallel(
  (module): ScaleShiftMACE(
    (node_embedding): LinearNodeEmbeddingBlock(
      (linear): Linear(89x0e -> 128x0e | 11392 weights)
    )
    (radial_embedding): RadialEmbeddingBlock(
      (bessel_fn): BesselBasis(r_max=4.5, num_basis=8, trainable=False)
      (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
    )
    (spherical_harmonics): SphericalHarmonics()
    (atomic_energies_fn): AtomicEnergiesBlock(energies=[-3.6674, -1.3220, -3.4782, -4.7250, -7.7279, -8.4045, -7.3594, -7.2844, -4.8962, -0.0301, -2.7527, -2.8138, -4.8444, -7.6966, -6.9632, -4.6738, -2.8140, -0.0623, -2.6252, -5.3848, -7.9162, -10.2708, -8.6724, -9.2372, -8.3056, -7.0547, -5.5709, -5.1741, -3.2510, -1.2880, -3.5322, -4.7113, -3.9718, -3.8862, -2.5183, 6.7068, -2.5661, -4.9390, -10.1536, -11.8571, -12.1416, -8.7861, -8.7954, -7.7784, -6.8387, -4.8812, -2.0606, -0.6440, -2.7886, -3.8168, -3.5880, -2.8806, -1.6361, 9.7960, -2.7486, -4.9867, -8.9295, -8.7417, -8.0122, -8.2336, -7.6245, -8.1614, -13.5915, -18.5381, -7.6446, -8.1150, -7.6146, -6.8296, -7.8200, -3.5770, -7.4692, -12.7706, -14.1110, -9.3544, -11.3765, -9.6116, -7.3213, -5.3043, -2.3873, 0.2479, -2.3155, -3.7254, -3.4302, -5.0659, -11.0175, -12.2443, -13.8466, -14.9527, -15.3033])
    (interactions): ModuleList(
      (0): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
        (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 512]
        (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e x 89x0e -> 128x0e+128x1o | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
      (1): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
        (conv_tp): TensorProduct(128x0e+128x1o x 1x0e+1x1o+1x2e+1x3o -> 256x0e+384x1o+384x2e+256x3o | 1280 paths | 1280 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1280]
        (linear): Linear(256x0e+384x1o+384x2e+256x3o -> 128x0e+128x1o+128x2e+128x3o | 163840 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o x 89x0e -> 128x0e+128x1o | 2916352 paths | 2916352 weights)
        (reshape): reshape_irreps()
      )
      (2): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
        (conv_tp): TensorProduct(128x0e+128x1o x 1x0e+1x1o+1x2e+1x3o -> 256x0e+384x1o+384x2e+256x3o | 1280 paths | 1280 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1280]
        (linear): Linear(256x0e+384x1o+384x2e+256x3o -> 128x0e+128x1o+128x2e+128x3o | 163840 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o x 89x0e -> 128x0e | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
    )
    (products): ModuleList(
      (0-1): 2 x EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
            (1): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x6x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
      )
      (2): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e -> 128x0e | 16384 weights)
      )
    )
    (readouts): ModuleList(
      (0-1): 2 x LinearReadoutBlock(
        (linear): Linear(128x0e+128x1o -> 1x0e | 128 weights)
      )
      (2): NonLinearReadoutBlock(
        (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
        (non_linearity): Activation [x] (16x0e -> 16x0e)
        (linear_2): Linear(16x0e -> 1x0e | 16 weights)
      )
    )
    (scale_shift): ScaleShiftBlock(scale=0.804340, shift=0.164779)
  )
)
2023-12-03 10:49:14.203 INFO: Number of parameters: 8904592
2023-12-03 10:49:14.203 INFO: Optimizer: AcceleratedOptimizer (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: interactions_decay
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: interactions_no_decay
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: products
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2023-12-03 10:49:14.203 INFO: Using gradient clipping with tolerance=10.000
2023-12-03 10:49:14.203 INFO: Started training
2023-12-03 10:49:16.159 INFO: Reducer buckets have been rebuilt in this iteration.
2023-12-03 10:49:16.159 INFO: Reducer buckets have been rebuilt in this iteration.
2023-12-03 10:49:16.159 INFO: Reducer buckets have been rebuilt in this iteration.
2023-12-03 10:49:16.159 INFO: Reducer buckets have been rebuilt in this iteration.
2023-12-03 12:46:52.233 INFO: Epoch 38: loss=0.0022, MAE_E_per_atom=15.0 meV, MAE_F=54.1 meV / A
2023-12-03 12:46:52.235 INFO: Saving current state to data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-38
2023-12-03 12:46:52.396 INFO: Model weights saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-38/pytorch_model.bin
2023-12-03 12:46:52.747 INFO: Optimizer state saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-38/optimizer.bin
2023-12-03 12:46:52.754 INFO: Random states saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-38/random_states_0.pkl
2023-12-03 16:35:36.932 INFO: Epoch 40: loss=0.0021, MAE_E_per_atom=14.8 meV, MAE_F=53.8 meV / A
2023-12-03 16:35:36.959 INFO: Saving current state to data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-40
2023-12-03 16:35:37.066 INFO: Model weights saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-40/pytorch_model.bin
2023-12-03 16:35:37.309 INFO: Optimizer state saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-40/optimizer.bin
2023-12-03 16:35:37.310 INFO: Random states saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-40/random_states_0.pkl
2023-12-03 20:31:51.508 INFO: Epoch 42: loss=0.0021, MAE_E_per_atom=14.7 meV, MAE_F=53.5 meV / A
2023-12-03 20:31:51.534 INFO: Saving current state to data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-42
2023-12-03 20:31:51.637 INFO: Model weights saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-42/pytorch_model.bin
2023-12-03 20:31:51.863 INFO: Optimizer state saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-42/optimizer.bin
2023-12-03 20:31:51.864 INFO: Random states saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-42/random_states_0.pkl
2023-12-04 00:42:10.971 INFO: Epoch 44: loss=0.0021, MAE_E_per_atom=14.6 meV, MAE_F=53.1 meV / A
2023-12-04 00:42:10.997 INFO: Saving current state to data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-44
2023-12-04 00:42:11.102 INFO: Model weights saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-44/pytorch_model.bin
2023-12-04 00:42:11.336 INFO: Optimizer state saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-44/optimizer.bin
2023-12-04 00:42:11.338 INFO: Random states saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-44/random_states_0.pkl
2023-12-04 05:15:16.295 INFO: Epoch 46: loss=0.0021, MAE_E_per_atom=14.4 meV, MAE_F=52.9 meV / A
2023-12-04 05:15:16.315 INFO: Saving current state to data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-46
2023-12-04 05:15:16.401 INFO: Model weights saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-46/pytorch_model.bin
2023-12-04 05:15:16.604 INFO: Optimizer state saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-46/optimizer.bin
2023-12-04 05:15:16.606 INFO: Random states saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-46/random_states_0.pkl
2023-12-04 10:13:00.371 INFO: Epoch 48: loss=0.0021, MAE_E_per_atom=14.3 meV, MAE_F=52.6 meV / A
2023-12-04 10:13:00.403 INFO: Saving current state to data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-48
2023-12-04 10:13:00.523 INFO: Model weights saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-48/pytorch_model.bin
2023-12-04 10:13:00.774 INFO: Optimizer state saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-48/optimizer.bin
2023-12-04 10:13:00.776 INFO: Random states saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-48/random_states_0.pkl
2023-12-04 15:38:45.085 INFO: Epoch 50: loss=0.0021, MAE_E_per_atom=14.3 meV, MAE_F=52.3 meV / A
2023-12-04 15:38:45.107 INFO: Saving current state to data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-50
2023-12-04 15:38:45.201 INFO: Model weights saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-50/pytorch_model.bin
2023-12-04 15:38:45.418 INFO: Optimizer state saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-50/optimizer.bin
2023-12-04 15:38:45.420 INFO: Random states saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-50/random_states_0.pkl
2023-12-04 21:32:44.560 INFO: Epoch 52: loss=0.0021, MAE_E_per_atom=14.3 meV, MAE_F=52.2 meV / A
2023-12-05 03:54:22.215 INFO: Epoch 54: loss=0.0021, MAE_E_per_atom=14.1 meV, MAE_F=51.8 meV / A
2023-12-05 03:54:22.241 INFO: Saving current state to data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-54
2023-12-05 03:54:22.323 INFO: Model weights saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-54/pytorch_model.bin
2023-12-05 03:54:22.489 INFO: Optimizer state saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-54/optimizer.bin
2023-12-05 03:54:22.490 INFO: Random states saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-54/random_states_0.pkl
2023-12-05 10:44:05.021 INFO: Epoch 56: loss=0.0020, MAE_E_per_atom=14.0 meV, MAE_F=51.6 meV / A
2023-12-05 10:44:05.043 INFO: Saving current state to data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-56
2023-12-05 10:44:05.121 INFO: Model weights saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-56/pytorch_model.bin
2023-12-05 10:44:05.292 INFO: Optimizer state saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-56/optimizer.bin
2023-12-05 10:44:05.294 INFO: Random states saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-56/random_states_0.pkl
2023-12-05 17:57:25.051 INFO: Epoch 58: loss=0.0020, MAE_E_per_atom=13.9 meV, MAE_F=51.2 meV / A
2023-12-05 17:57:25.072 INFO: Saving current state to data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-58
2023-12-05 17:57:25.151 INFO: Model weights saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-58/pytorch_model.bin
2023-12-05 17:57:25.325 INFO: Optimizer state saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-58/optimizer.bin
2023-12-05 17:57:25.326 INFO: Random states saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-58/random_states_0.pkl
2023-12-06 01:40:43.120 INFO: Epoch 60: loss=0.0020, MAE_E_per_atom=13.9 meV, MAE_F=51.0 meV / A
2023-12-06 01:40:43.140 INFO: Saving current state to data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-60
2023-12-06 01:40:43.218 INFO: Model weights saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-60/pytorch_model.bin
2023-12-06 01:40:43.386 INFO: Optimizer state saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-60/optimizer.bin
2023-12-06 01:40:43.387 INFO: Random states saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-60/random_states_0.pkl
2023-12-06 09:44:50.459 INFO: Epoch 62: loss=0.0020, MAE_E_per_atom=13.8 meV, MAE_F=50.9 meV / A
2023-12-06 09:44:50.485 INFO: Saving current state to data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-62
2023-12-06 09:44:50.594 INFO: Model weights saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-62/pytorch_model.bin
2023-12-06 09:44:50.816 INFO: Optimizer state saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-62/optimizer.bin
2023-12-06 09:44:50.817 INFO: Random states saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-62/random_states_0.pkl
2023-12-06 13:02:42.406 INFO: MACE version: 0.1.0
2023-12-06 13:02:42.406 INFO: Configuration: Namespace(name='MACE_MPtrj_2022.9', seed=42, log_dir='data-train-result-128-inter3/logs', model_dir='data-train-result-128-inter3', checkpoints_dir='data-train-result-128-inter3/checkpoints', results_dir='data-train-result-128-inter3/results', downloads_dir='data-train-result-128-inter3/downloads', default_dtype='float64', log_level='INFO', error_table='PerAtomMAE', model='ScaleShiftMACE', r_max=5.0, num_radial_basis=8, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=3, MLP_irreps='16x0e', hidden_irreps='32x0e', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='./data-train-preprocessed/train.h5', valid_file='./data-train-preprocessed/valid.h5', valid_fraction=0.1, test_file=None, test_dir=None, num_workers=8, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file='./data-train-preprocessed/statistics.json', E0s=None, energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='weighted-l1', forces_weight=1.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=32, valid_batch_size=32, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=120, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=True, restart_lr=0.0001, save_cpu=True, clip_grad=10.0, wandb=False, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-12-06 13:02:42.406 INFO: Using statistics json file
2023-12-06 13:02:42.407 INFO: Using atomic numbers from statistics file
2023-12-06 13:02:42.407 INFO: AtomicNumberTable: (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 89, 90, 91, 92, 93, 94)
2023-12-06 13:02:42.407 INFO: Atomic Energies not in training file, using command line argument E0s
2023-12-06 13:02:42.408 INFO: Atomic energies: [-3.6673775936325184, -1.321978574671279, -3.47815910592578, -4.724966512505185, -7.727941403300326, -8.404543836565129, -7.359429774977432, -7.284436081345614, -4.896162007436489, -0.03005797428312995, -2.7527187727369, -2.8138258116559136, -4.844369939040846, -7.6966307568316115, -6.96321292174237, -4.673811566998673, -2.813984104722163, -0.06233472731112788, -2.6251773081704863, -5.384791381758609, -7.916197568907359, -10.270820955634214, -8.672390387555845, -9.2371580345617, -8.305620224433062, -7.054671703876374, -5.570915377375696, -5.174147851464132, -3.251035550574451, -1.2879654275024013, -3.5321835252059812, -4.711328365973749, -3.9717755452456673, -3.886221455984922, -2.5183143168985502, 6.706842222672468, -2.566057480857263, -4.938993788294903, -10.153603816562159, -11.857062150232505, -12.14164656151253, -8.786094380920531, -8.795434431218645, -7.778351502991773, -6.838726494373795, -4.881216430056056, -2.0605586704343675, -0.6439905162993389, -2.788575343692543, -3.816810475940441, -3.587983770584603, -2.8805917608627976, -1.6360524330360255, 9.796001071919388, -2.7486371263604354, -4.986670776340143, -8.929476698318382, -8.74170685282431, -8.01217127881877, -8.233598378021814, -7.62454389634746, -8.161368139142393, -13.591451290378114, -18.538136714242995, -7.644552511106582, -8.115049752450005, -7.614570319217799, -6.82962645334957, -7.820026786949461, -3.5770491745130024, -7.469205400904766, -12.770648602823787, -14.110986902146283, -9.354405708044254, -11.376459286198285, -9.611613368883013, -7.321263077561875, -5.304305597659051, -2.3873175082519373, 0.24792131307789267, -2.31553585581406, -3.7254481655069127, -3.4301772252097935, -5.065907805804548, -11.017529306980132, -12.244262478240024, -13.846602972246156, -14.952721865054968, -15.303292182007306]
2023-12-06 13:02:42.448 INFO: WeightedEnergyForcesLossL1(energy_weight=1.000, forces_weight=1.000)
2023-12-06 13:02:42.448 INFO: Average number of neighbors: 25.57754135131836
2023-12-06 13:02:42.448 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': False, 'dipoles': False}
2023-12-06 13:02:42.448 INFO: Building model
2023-12-06 13:02:42.448 INFO: Hidden irreps: 128x0e + 128x1o
2023-12-06 13:02:46.422 INFO: Loading states from data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-62
2023-12-06 13:02:46.482 INFO: All model weights loaded successfully
2023-12-06 13:02:46.611 INFO: All optimizer states loaded successfully
2023-12-06 13:02:46.611 INFO: All scheduler states loaded successfully
2023-12-06 13:02:46.616 INFO: All random states loaded successfully
2023-12-06 13:02:46.617 INFO: Loading in 0 custom states
2023-12-06 13:02:46.618 INFO: DistributedDataParallel(
  (module): ScaleShiftMACE(
    (node_embedding): LinearNodeEmbeddingBlock(
      (linear): Linear(89x0e -> 128x0e | 11392 weights)
    )
    (radial_embedding): RadialEmbeddingBlock(
      (bessel_fn): BesselBasis(r_max=4.5, num_basis=8, trainable=False)
      (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
    )
    (spherical_harmonics): SphericalHarmonics()
    (atomic_energies_fn): AtomicEnergiesBlock(energies=[-3.6674, -1.3220, -3.4782, -4.7250, -7.7279, -8.4045, -7.3594, -7.2844, -4.8962, -0.0301, -2.7527, -2.8138, -4.8444, -7.6966, -6.9632, -4.6738, -2.8140, -0.0623, -2.6252, -5.3848, -7.9162, -10.2708, -8.6724, -9.2372, -8.3056, -7.0547, -5.5709, -5.1741, -3.2510, -1.2880, -3.5322, -4.7113, -3.9718, -3.8862, -2.5183, 6.7068, -2.5661, -4.9390, -10.1536, -11.8571, -12.1416, -8.7861, -8.7954, -7.7784, -6.8387, -4.8812, -2.0606, -0.6440, -2.7886, -3.8168, -3.5880, -2.8806, -1.6361, 9.7960, -2.7486, -4.9867, -8.9295, -8.7417, -8.0122, -8.2336, -7.6245, -8.1614, -13.5915, -18.5381, -7.6446, -8.1150, -7.6146, -6.8296, -7.8200, -3.5770, -7.4692, -12.7706, -14.1110, -9.3544, -11.3765, -9.6116, -7.3213, -5.3043, -2.3873, 0.2479, -2.3155, -3.7254, -3.4302, -5.0659, -11.0175, -12.2443, -13.8466, -14.9527, -15.3033])
    (interactions): ModuleList(
      (0): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
        (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 512]
        (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e x 89x0e -> 128x0e+128x1o | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
      (1): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
        (conv_tp): TensorProduct(128x0e+128x1o x 1x0e+1x1o+1x2e+1x3o -> 256x0e+384x1o+384x2e+256x3o | 1280 paths | 1280 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1280]
        (linear): Linear(256x0e+384x1o+384x2e+256x3o -> 128x0e+128x1o+128x2e+128x3o | 163840 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o x 89x0e -> 128x0e+128x1o | 2916352 paths | 2916352 weights)
        (reshape): reshape_irreps()
      )
      (2): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
        (conv_tp): TensorProduct(128x0e+128x1o x 1x0e+1x1o+1x2e+1x3o -> 256x0e+384x1o+384x2e+256x3o | 1280 paths | 1280 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1280]
        (linear): Linear(256x0e+384x1o+384x2e+256x3o -> 128x0e+128x1o+128x2e+128x3o | 163840 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o x 89x0e -> 128x0e | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
    )
    (products): ModuleList(
      (0-1): 2 x EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
            (1): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x6x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
      )
      (2): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e -> 128x0e | 16384 weights)
      )
    )
    (readouts): ModuleList(
      (0-1): 2 x LinearReadoutBlock(
        (linear): Linear(128x0e+128x1o -> 1x0e | 128 weights)
      )
      (2): NonLinearReadoutBlock(
        (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
        (non_linearity): Activation [x] (16x0e -> 16x0e)
        (linear_2): Linear(16x0e -> 1x0e | 16 weights)
      )
    )
    (scale_shift): ScaleShiftBlock(scale=0.804340, shift=0.164779)
  )
)
2023-12-06 13:02:46.623 INFO: Number of parameters: 8904592
2023-12-06 13:02:46.623 INFO: Optimizer: AcceleratedOptimizer (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0001
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0001
    maximize: False
    name: interactions_decay
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0001
    maximize: False
    name: interactions_no_decay
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0001
    maximize: False
    name: products
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0001
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2023-12-06 13:02:46.624 INFO: Using gradient clipping with tolerance=10.000
2023-12-06 13:02:46.624 INFO: Started training
2023-12-06 13:03:47.376 INFO: MACE version: 0.1.0
2023-12-06 13:03:47.377 INFO: Configuration: Namespace(name='MACE_MPtrj_2022.9', seed=42, log_dir='data-train-result-128-inter3/logs', model_dir='data-train-result-128-inter3', checkpoints_dir='data-train-result-128-inter3/checkpoints', results_dir='data-train-result-128-inter3/results', downloads_dir='data-train-result-128-inter3/downloads', default_dtype='float64', log_level='INFO', error_table='PerAtomMAE', model='ScaleShiftMACE', r_max=5.0, num_radial_basis=8, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=3, MLP_irreps='16x0e', hidden_irreps='32x0e', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='./data-train-preprocessed/train.h5', valid_file='./data-train-preprocessed/valid.h5', valid_fraction=0.1, test_file=None, test_dir=None, num_workers=8, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file='./data-train-preprocessed/statistics.json', E0s=None, energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='weighted-l1', forces_weight=1.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=32, valid_batch_size=32, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=120, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=True, restart_lr=0.0001, save_cpu=True, clip_grad=10.0, wandb=False, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-12-06 13:03:47.377 INFO: Using statistics json file
2023-12-06 13:03:47.377 INFO: Using atomic numbers from statistics file
2023-12-06 13:03:47.377 INFO: AtomicNumberTable: (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 89, 90, 91, 92, 93, 94)
2023-12-06 13:03:47.377 INFO: Atomic Energies not in training file, using command line argument E0s
2023-12-06 13:03:47.378 INFO: Atomic energies: [-3.6673775936325184, -1.321978574671279, -3.47815910592578, -4.724966512505185, -7.727941403300326, -8.404543836565129, -7.359429774977432, -7.284436081345614, -4.896162007436489, -0.03005797428312995, -2.7527187727369, -2.8138258116559136, -4.844369939040846, -7.6966307568316115, -6.96321292174237, -4.673811566998673, -2.813984104722163, -0.06233472731112788, -2.6251773081704863, -5.384791381758609, -7.916197568907359, -10.270820955634214, -8.672390387555845, -9.2371580345617, -8.305620224433062, -7.054671703876374, -5.570915377375696, -5.174147851464132, -3.251035550574451, -1.2879654275024013, -3.5321835252059812, -4.711328365973749, -3.9717755452456673, -3.886221455984922, -2.5183143168985502, 6.706842222672468, -2.566057480857263, -4.938993788294903, -10.153603816562159, -11.857062150232505, -12.14164656151253, -8.786094380920531, -8.795434431218645, -7.778351502991773, -6.838726494373795, -4.881216430056056, -2.0605586704343675, -0.6439905162993389, -2.788575343692543, -3.816810475940441, -3.587983770584603, -2.8805917608627976, -1.6360524330360255, 9.796001071919388, -2.7486371263604354, -4.986670776340143, -8.929476698318382, -8.74170685282431, -8.01217127881877, -8.233598378021814, -7.62454389634746, -8.161368139142393, -13.591451290378114, -18.538136714242995, -7.644552511106582, -8.115049752450005, -7.614570319217799, -6.82962645334957, -7.820026786949461, -3.5770491745130024, -7.469205400904766, -12.770648602823787, -14.110986902146283, -9.354405708044254, -11.376459286198285, -9.611613368883013, -7.321263077561875, -5.304305597659051, -2.3873175082519373, 0.24792131307789267, -2.31553585581406, -3.7254481655069127, -3.4301772252097935, -5.065907805804548, -11.017529306980132, -12.244262478240024, -13.846602972246156, -14.952721865054968, -15.303292182007306]
2023-12-06 13:03:47.412 INFO: WeightedEnergyForcesLossL1(energy_weight=1.000, forces_weight=1.000)
2023-12-06 13:03:47.412 INFO: Average number of neighbors: 25.57754135131836
2023-12-06 13:03:47.412 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': False, 'dipoles': False}
2023-12-06 13:03:47.413 INFO: Building model
2023-12-06 13:03:47.413 INFO: Hidden irreps: 128x0e + 128x1o
2023-12-06 13:03:50.778 INFO: Loading states from data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-62
2023-12-06 13:03:50.832 INFO: All model weights loaded successfully
2023-12-06 13:03:50.947 INFO: All optimizer states loaded successfully
2023-12-06 13:03:50.947 INFO: All scheduler states loaded successfully
2023-12-06 13:03:50.952 INFO: All random states loaded successfully
2023-12-06 13:03:50.952 INFO: Loading in 0 custom states
2023-12-06 13:03:50.954 INFO: DistributedDataParallel(
  (module): ScaleShiftMACE(
    (node_embedding): LinearNodeEmbeddingBlock(
      (linear): Linear(89x0e -> 128x0e | 11392 weights)
    )
    (radial_embedding): RadialEmbeddingBlock(
      (bessel_fn): BesselBasis(r_max=4.5, num_basis=8, trainable=False)
      (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
    )
    (spherical_harmonics): SphericalHarmonics()
    (atomic_energies_fn): AtomicEnergiesBlock(energies=[-3.6674, -1.3220, -3.4782, -4.7250, -7.7279, -8.4045, -7.3594, -7.2844, -4.8962, -0.0301, -2.7527, -2.8138, -4.8444, -7.6966, -6.9632, -4.6738, -2.8140, -0.0623, -2.6252, -5.3848, -7.9162, -10.2708, -8.6724, -9.2372, -8.3056, -7.0547, -5.5709, -5.1741, -3.2510, -1.2880, -3.5322, -4.7113, -3.9718, -3.8862, -2.5183, 6.7068, -2.5661, -4.9390, -10.1536, -11.8571, -12.1416, -8.7861, -8.7954, -7.7784, -6.8387, -4.8812, -2.0606, -0.6440, -2.7886, -3.8168, -3.5880, -2.8806, -1.6361, 9.7960, -2.7486, -4.9867, -8.9295, -8.7417, -8.0122, -8.2336, -7.6245, -8.1614, -13.5915, -18.5381, -7.6446, -8.1150, -7.6146, -6.8296, -7.8200, -3.5770, -7.4692, -12.7706, -14.1110, -9.3544, -11.3765, -9.6116, -7.3213, -5.3043, -2.3873, 0.2479, -2.3155, -3.7254, -3.4302, -5.0659, -11.0175, -12.2443, -13.8466, -14.9527, -15.3033])
    (interactions): ModuleList(
      (0): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
        (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 512]
        (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e x 89x0e -> 128x0e+128x1o | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
      (1): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
        (conv_tp): TensorProduct(128x0e+128x1o x 1x0e+1x1o+1x2e+1x3o -> 256x0e+384x1o+384x2e+256x3o | 1280 paths | 1280 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1280]
        (linear): Linear(256x0e+384x1o+384x2e+256x3o -> 128x0e+128x1o+128x2e+128x3o | 163840 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o x 89x0e -> 128x0e+128x1o | 2916352 paths | 2916352 weights)
        (reshape): reshape_irreps()
      )
      (2): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
        (conv_tp): TensorProduct(128x0e+128x1o x 1x0e+1x1o+1x2e+1x3o -> 256x0e+384x1o+384x2e+256x3o | 1280 paths | 1280 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1280]
        (linear): Linear(256x0e+384x1o+384x2e+256x3o -> 128x0e+128x1o+128x2e+128x3o | 163840 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o x 89x0e -> 128x0e | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
    )
    (products): ModuleList(
      (0-1): 2 x EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
            (1): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x6x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
      )
      (2): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e -> 128x0e | 16384 weights)
      )
    )
    (readouts): ModuleList(
      (0-1): 2 x LinearReadoutBlock(
        (linear): Linear(128x0e+128x1o -> 1x0e | 128 weights)
      )
      (2): NonLinearReadoutBlock(
        (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
        (non_linearity): Activation [x] (16x0e -> 16x0e)
        (linear_2): Linear(16x0e -> 1x0e | 16 weights)
      )
    )
    (scale_shift): ScaleShiftBlock(scale=0.804340, shift=0.164779)
  )
)
2023-12-06 13:03:50.959 INFO: Number of parameters: 8904592
2023-12-06 13:03:50.959 INFO: Optimizer: AcceleratedOptimizer (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0001
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0001
    maximize: False
    name: interactions_decay
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0001
    maximize: False
    name: interactions_no_decay
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0001
    maximize: False
    name: products
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0001
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2023-12-06 13:03:50.959 INFO: Using gradient clipping with tolerance=10.000
2023-12-06 13:03:50.959 INFO: Started training
2023-12-06 13:03:52.763 INFO: Reducer buckets have been rebuilt in this iteration.
2023-12-06 13:03:52.763 INFO: Reducer buckets have been rebuilt in this iteration.
2023-12-06 13:03:52.764 INFO: Reducer buckets have been rebuilt in this iteration.
2023-12-06 15:33:49.611 INFO: Epoch 62: loss=0.0020, MAE_E_per_atom=13.1 meV, MAE_F=49.9 meV / A
2023-12-06 15:33:49.613 INFO: Saving current state to data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-62
2023-12-06 15:33:49.724 INFO: Model weights saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-62/pytorch_model.bin
2023-12-06 15:33:50.016 INFO: Optimizer state saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-62/optimizer.bin
2023-12-06 15:33:50.018 INFO: Random states saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-62/random_states_0.pkl
2023-12-06 20:31:42.092 INFO: Epoch 64: loss=0.0020, MAE_E_per_atom=13.0 meV, MAE_F=49.8 meV / A
2023-12-06 20:31:42.126 INFO: Saving current state to data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-64
2023-12-06 20:31:42.242 INFO: Model weights saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-64/pytorch_model.bin
2023-12-06 20:31:42.451 INFO: Optimizer state saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-64/optimizer.bin
2023-12-06 20:31:42.453 INFO: Random states saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-64/random_states_0.pkl
2023-12-07 01:51:02.770 INFO: Epoch 66: loss=0.0020, MAE_E_per_atom=13.0 meV, MAE_F=49.7 meV / A
2023-12-07 01:51:02.798 INFO: Saving current state to data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-66
2023-12-07 01:51:02.910 INFO: Model weights saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-66/pytorch_model.bin
2023-12-07 01:51:03.162 INFO: Optimizer state saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-66/optimizer.bin
2023-12-07 01:51:03.163 INFO: Random states saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-66/random_states_0.pkl
2023-12-07 07:53:24.286 INFO: Epoch 68: loss=0.0019, MAE_E_per_atom=12.9 meV, MAE_F=49.5 meV / A
2023-12-07 07:53:24.314 INFO: Saving current state to data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-68
2023-12-07 07:53:24.429 INFO: Model weights saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-68/pytorch_model.bin
2023-12-07 07:53:24.682 INFO: Optimizer state saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-68/optimizer.bin
2023-12-07 07:53:24.684 INFO: Random states saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-68/random_states_0.pkl
2023-12-07 14:32:45.229 INFO: Epoch 70: loss=0.0019, MAE_E_per_atom=12.9 meV, MAE_F=49.4 meV / A
2023-12-07 14:32:45.254 INFO: Saving current state to data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-70
2023-12-07 14:32:45.334 INFO: Model weights saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-70/pytorch_model.bin
2023-12-07 14:32:45.512 INFO: Optimizer state saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-70/optimizer.bin
2023-12-07 14:32:45.513 INFO: Random states saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-70/random_states_0.pkl
2023-12-07 22:03:29.986 INFO: Epoch 72: loss=0.0019, MAE_E_per_atom=12.8 meV, MAE_F=49.3 meV / A
2023-12-08 06:33:53.891 INFO: Epoch 74: loss=0.0019, MAE_E_per_atom=12.8 meV, MAE_F=49.2 meV / A
2023-12-08 06:33:53.916 INFO: Saving current state to data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-74
2023-12-08 06:33:54.035 INFO: Model weights saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-74/pytorch_model.bin
2023-12-08 06:33:54.287 INFO: Optimizer state saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-74/optimizer.bin
2023-12-08 06:33:54.288 INFO: Random states saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-74/random_states_0.pkl
2023-12-08 15:58:50.286 INFO: Epoch 76: loss=0.0019, MAE_E_per_atom=12.7 meV, MAE_F=49.1 meV / A
2023-12-08 17:10:48.932 INFO: MACE version: 0.1.0
2023-12-08 17:10:48.932 INFO: Configuration: Namespace(name='MACE_MPtrj_2022.9', seed=42, log_dir='data-train-result-128-inter3/logs', model_dir='data-train-result-128-inter3', checkpoints_dir='data-train-result-128-inter3/checkpoints', results_dir='data-train-result-128-inter3/results', downloads_dir='data-train-result-128-inter3/downloads', default_dtype='float64', log_level='INFO', error_table='PerAtomMAE', model='ScaleShiftMACE', r_max=5.0, num_radial_basis=8, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=3, MLP_irreps='16x0e', hidden_irreps='32x0e', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='./data-train-preprocessed/train.h5', valid_file='./data-train-preprocessed/valid.h5', valid_fraction=0.1, test_file=None, test_dir=None, num_workers=8, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file='./data-train-preprocessed/statistics.json', E0s=None, energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='weighted-l1', forces_weight=1.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=32, valid_batch_size=32, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=78, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=True, restart_lr=0.0002, save_cpu=True, clip_grad=10.0, wandb=False, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-12-08 17:10:48.933 INFO: Using statistics json file
2023-12-08 17:10:48.933 INFO: Using atomic numbers from statistics file
2023-12-08 17:10:48.933 INFO: AtomicNumberTable: (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 89, 90, 91, 92, 93, 94)
2023-12-08 17:10:48.933 INFO: Atomic Energies not in training file, using command line argument E0s
2023-12-08 17:10:48.934 INFO: Atomic energies: [-3.6673775936325184, -1.321978574671279, -3.47815910592578, -4.724966512505185, -7.727941403300326, -8.404543836565129, -7.359429774977432, -7.284436081345614, -4.896162007436489, -0.03005797428312995, -2.7527187727369, -2.8138258116559136, -4.844369939040846, -7.6966307568316115, -6.96321292174237, -4.673811566998673, -2.813984104722163, -0.06233472731112788, -2.6251773081704863, -5.384791381758609, -7.916197568907359, -10.270820955634214, -8.672390387555845, -9.2371580345617, -8.305620224433062, -7.054671703876374, -5.570915377375696, -5.174147851464132, -3.251035550574451, -1.2879654275024013, -3.5321835252059812, -4.711328365973749, -3.9717755452456673, -3.886221455984922, -2.5183143168985502, 6.706842222672468, -2.566057480857263, -4.938993788294903, -10.153603816562159, -11.857062150232505, -12.14164656151253, -8.786094380920531, -8.795434431218645, -7.778351502991773, -6.838726494373795, -4.881216430056056, -2.0605586704343675, -0.6439905162993389, -2.788575343692543, -3.816810475940441, -3.587983770584603, -2.8805917608627976, -1.6360524330360255, 9.796001071919388, -2.7486371263604354, -4.986670776340143, -8.929476698318382, -8.74170685282431, -8.01217127881877, -8.233598378021814, -7.62454389634746, -8.161368139142393, -13.591451290378114, -18.538136714242995, -7.644552511106582, -8.115049752450005, -7.614570319217799, -6.82962645334957, -7.820026786949461, -3.5770491745130024, -7.469205400904766, -12.770648602823787, -14.110986902146283, -9.354405708044254, -11.376459286198285, -9.611613368883013, -7.321263077561875, -5.304305597659051, -2.3873175082519373, 0.24792131307789267, -2.31553585581406, -3.7254481655069127, -3.4301772252097935, -5.065907805804548, -11.017529306980132, -12.244262478240024, -13.846602972246156, -14.952721865054968, -15.303292182007306]
2023-12-08 17:10:48.985 INFO: WeightedEnergyForcesLossL1(energy_weight=1.000, forces_weight=1.000)
2023-12-08 17:10:48.985 INFO: Average number of neighbors: 25.57754135131836
2023-12-08 17:10:48.985 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': False, 'dipoles': False}
2023-12-08 17:10:48.985 INFO: Building model
2023-12-08 17:10:48.985 INFO: Hidden irreps: 128x0e + 128x1o
2023-12-08 17:10:53.348 INFO: Loading states from data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-74
2023-12-08 17:10:53.409 INFO: All model weights loaded successfully
2023-12-08 17:10:53.544 INFO: All optimizer states loaded successfully
2023-12-08 17:10:53.544 INFO: All scheduler states loaded successfully
2023-12-08 17:10:53.547 INFO: All random states loaded successfully
2023-12-08 17:10:53.547 INFO: Loading in 0 custom states
2023-12-08 17:10:53.549 INFO: DistributedDataParallel(
  (module): ScaleShiftMACE(
    (node_embedding): LinearNodeEmbeddingBlock(
      (linear): Linear(89x0e -> 128x0e | 11392 weights)
    )
    (radial_embedding): RadialEmbeddingBlock(
      (bessel_fn): BesselBasis(r_max=4.5, num_basis=8, trainable=False)
      (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
    )
    (spherical_harmonics): SphericalHarmonics()
    (atomic_energies_fn): AtomicEnergiesBlock(energies=[-3.6674, -1.3220, -3.4782, -4.7250, -7.7279, -8.4045, -7.3594, -7.2844, -4.8962, -0.0301, -2.7527, -2.8138, -4.8444, -7.6966, -6.9632, -4.6738, -2.8140, -0.0623, -2.6252, -5.3848, -7.9162, -10.2708, -8.6724, -9.2372, -8.3056, -7.0547, -5.5709, -5.1741, -3.2510, -1.2880, -3.5322, -4.7113, -3.9718, -3.8862, -2.5183, 6.7068, -2.5661, -4.9390, -10.1536, -11.8571, -12.1416, -8.7861, -8.7954, -7.7784, -6.8387, -4.8812, -2.0606, -0.6440, -2.7886, -3.8168, -3.5880, -2.8806, -1.6361, 9.7960, -2.7486, -4.9867, -8.9295, -8.7417, -8.0122, -8.2336, -7.6245, -8.1614, -13.5915, -18.5381, -7.6446, -8.1150, -7.6146, -6.8296, -7.8200, -3.5770, -7.4692, -12.7706, -14.1110, -9.3544, -11.3765, -9.6116, -7.3213, -5.3043, -2.3873, 0.2479, -2.3155, -3.7254, -3.4302, -5.0659, -11.0175, -12.2443, -13.8466, -14.9527, -15.3033])
    (interactions): ModuleList(
      (0): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
        (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 512]
        (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e x 89x0e -> 128x0e+128x1o | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
      (1): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
        (conv_tp): TensorProduct(128x0e+128x1o x 1x0e+1x1o+1x2e+1x3o -> 256x0e+384x1o+384x2e+256x3o | 1280 paths | 1280 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1280]
        (linear): Linear(256x0e+384x1o+384x2e+256x3o -> 128x0e+128x1o+128x2e+128x3o | 163840 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o x 89x0e -> 128x0e+128x1o | 2916352 paths | 2916352 weights)
        (reshape): reshape_irreps()
      )
      (2): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
        (conv_tp): TensorProduct(128x0e+128x1o x 1x0e+1x1o+1x2e+1x3o -> 256x0e+384x1o+384x2e+256x3o | 1280 paths | 1280 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1280]
        (linear): Linear(256x0e+384x1o+384x2e+256x3o -> 128x0e+128x1o+128x2e+128x3o | 163840 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o x 89x0e -> 128x0e | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
    )
    (products): ModuleList(
      (0-1): 2 x EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
            (1): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x6x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
      )
      (2): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e -> 128x0e | 16384 weights)
      )
    )
    (readouts): ModuleList(
      (0-1): 2 x LinearReadoutBlock(
        (linear): Linear(128x0e+128x1o -> 1x0e | 128 weights)
      )
      (2): NonLinearReadoutBlock(
        (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
        (non_linearity): Activation [x] (16x0e -> 16x0e)
        (linear_2): Linear(16x0e -> 1x0e | 16 weights)
      )
    )
    (scale_shift): ScaleShiftBlock(scale=0.804340, shift=0.164779)
  )
)
2023-12-08 17:10:53.553 INFO: Number of parameters: 8904592
2023-12-08 17:10:53.553 INFO: Optimizer: AcceleratedOptimizer (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    name: interactions_decay
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    name: interactions_no_decay
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    name: products
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2023-12-08 17:10:53.553 INFO: Using gradient clipping with tolerance=10.000
2023-12-08 17:10:53.553 INFO: Started training
2023-12-08 17:10:55.424 INFO: Reducer buckets have been rebuilt in this iteration.
2023-12-08 17:10:55.424 INFO: Reducer buckets have been rebuilt in this iteration.
2023-12-08 17:10:55.425 INFO: Reducer buckets have been rebuilt in this iteration.
2023-12-08 19:41:52.451 INFO: Epoch 74: loss=0.0019, MAE_E_per_atom=13.0 meV, MAE_F=49.4 meV / A
2023-12-08 19:41:52.453 INFO: Saving current state to data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-74
2023-12-08 19:41:52.619 INFO: Model weights saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-74/pytorch_model.bin
2023-12-08 19:41:53.000 INFO: Optimizer state saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-74/optimizer.bin
2023-12-08 19:41:53.003 INFO: Random states saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-74/random_states_0.pkl
2023-12-09 00:40:56.282 INFO: Epoch 76: loss=0.0019, MAE_E_per_atom=13.1 meV, MAE_F=49.2 meV / A
2023-12-09 00:40:56.315 INFO: Saving current state to data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-76
2023-12-09 00:40:56.434 INFO: Model weights saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-76/pytorch_model.bin
2023-12-09 00:40:56.704 INFO: Optimizer state saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-76/optimizer.bin
2023-12-09 00:40:56.706 INFO: Random states saved in data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-76/random_states_0.pkl
2023-12-09 03:12:19.118 INFO: Training complete
2023-12-09 03:12:19.119 INFO: Computing metrics for training, validation, and test sets
2023-12-09 03:12:19.120 INFO: Loading states from data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-76
2023-12-09 03:12:19.171 INFO: All model weights loaded successfully
2023-12-09 03:12:19.289 INFO: All optimizer states loaded successfully
2023-12-09 03:12:19.289 INFO: All scheduler states loaded successfully
2023-12-09 03:12:19.290 INFO: All random states loaded successfully
2023-12-09 03:12:19.291 INFO: Loading in 0 custom states
2023-12-09 03:12:19.291 INFO: Loaded model from epoch 76
2023-12-09 03:12:19.291 INFO: Evaluating train ...
2023-12-09 04:16:53.388 INFO: Evaluating valid ...
2023-12-09 04:27:31.847 INFO: 
+-------------+--------------------+-----------------+------------------+
| config_type | MAE E / meV / atom | MAE F / meV / A | relative F MAE % |
+-------------+--------------------+-----------------+------------------+
|    train    |        12.0        |       45.8      |      28.97       |
|    valid    |        13.1        |       49.2      |      31.91       |
+-------------+--------------------+-----------------+------------------+
2023-12-09 04:27:31.847 INFO: Saving model to data-train-result-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42.model
2023-12-09 04:27:32.352 INFO: Done
2023-12-09 09:06:57.766 INFO: MACE version: 0.1.0
2023-12-09 09:06:57.766 INFO: Configuration: Namespace(name='MACE_MPtrj_2022.9', seed=42, log_dir='data-train-result-stress-128-inter3/logs', model_dir='data-train-result-stress-128-inter3', checkpoints_dir='data-train-result-stress-128-inter3/checkpoints', results_dir='data-train-result-stress-128-inter3/results', downloads_dir='data-train-result-stress-128-inter3/downloads', default_dtype='float64', log_level='INFO', error_table='PerAtomMAEstress', model='ScaleShiftMACE', r_max=5.0, num_radial_basis=8, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=3, MLP_irreps='16x0e', hidden_irreps='32x0e', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='./data-train-preprocessed/train.h5', valid_file='./data-train-preprocessed/valid.h5', valid_fraction=0.1, test_file=None, test_dir=None, num_workers=8, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file='./data-train-preprocessed/statistics.json', E0s=None, energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='stress-l1', forces_weight=5.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=400.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=32, valid_batch_size=32, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=100, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=True, restart_lr=0.0002, save_cpu=True, clip_grad=10.0, wandb=False, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-12-09 09:06:57.767 INFO: Using statistics json file
2023-12-09 09:06:57.767 INFO: Using atomic numbers from statistics file
2023-12-09 09:06:57.767 INFO: AtomicNumberTable: (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 89, 90, 91, 92, 93, 94)
2023-12-09 09:06:57.767 INFO: Atomic Energies not in training file, using command line argument E0s
2023-12-09 09:06:57.768 INFO: Atomic energies: [-3.6673775936325184, -1.321978574671279, -3.47815910592578, -4.724966512505185, -7.727941403300326, -8.404543836565129, -7.359429774977432, -7.284436081345614, -4.896162007436489, -0.03005797428312995, -2.7527187727369, -2.8138258116559136, -4.844369939040846, -7.6966307568316115, -6.96321292174237, -4.673811566998673, -2.813984104722163, -0.06233472731112788, -2.6251773081704863, -5.384791381758609, -7.916197568907359, -10.270820955634214, -8.672390387555845, -9.2371580345617, -8.305620224433062, -7.054671703876374, -5.570915377375696, -5.174147851464132, -3.251035550574451, -1.2879654275024013, -3.5321835252059812, -4.711328365973749, -3.9717755452456673, -3.886221455984922, -2.5183143168985502, 6.706842222672468, -2.566057480857263, -4.938993788294903, -10.153603816562159, -11.857062150232505, -12.14164656151253, -8.786094380920531, -8.795434431218645, -7.778351502991773, -6.838726494373795, -4.881216430056056, -2.0605586704343675, -0.6439905162993389, -2.788575343692543, -3.816810475940441, -3.587983770584603, -2.8805917608627976, -1.6360524330360255, 9.796001071919388, -2.7486371263604354, -4.986670776340143, -8.929476698318382, -8.74170685282431, -8.01217127881877, -8.233598378021814, -7.62454389634746, -8.161368139142393, -13.591451290378114, -18.538136714242995, -7.644552511106582, -8.115049752450005, -7.614570319217799, -6.82962645334957, -7.820026786949461, -3.5770491745130024, -7.469205400904766, -12.770648602823787, -14.110986902146283, -9.354405708044254, -11.376459286198285, -9.611613368883013, -7.321263077561875, -5.304305597659051, -2.3873175082519373, 0.24792131307789267, -2.31553585581406, -3.7254481655069127, -3.4301772252097935, -5.065907805804548, -11.017529306980132, -12.244262478240024, -13.846602972246156, -14.952721865054968, -15.303292182007306]
2023-12-09 09:06:57.819 INFO: WeightedEnergyForcesStressLossL1(energy_weight=1.000, forces_weight=5.000, stress_weight=400.000)
2023-12-09 09:06:57.819 INFO: Average number of neighbors: 25.57754135131836
2023-12-09 09:06:57.819 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': False, 'dipoles': False}
2023-12-09 09:06:57.819 INFO: Building model
2023-12-09 09:06:57.819 INFO: Hidden irreps: 128x0e + 128x1o
2023-12-09 09:07:01.848 INFO: Loading states from data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-76
2023-12-09 09:07:01.928 INFO: All model weights loaded successfully
2023-12-09 09:07:02.070 INFO: All optimizer states loaded successfully
2023-12-09 09:07:02.070 INFO: All scheduler states loaded successfully
2023-12-09 09:07:02.073 INFO: All random states loaded successfully
2023-12-09 09:07:02.073 INFO: Loading in 0 custom states
2023-12-09 09:07:02.074 INFO: DistributedDataParallel(
  (module): ScaleShiftMACE(
    (node_embedding): LinearNodeEmbeddingBlock(
      (linear): Linear(89x0e -> 128x0e | 11392 weights)
    )
    (radial_embedding): RadialEmbeddingBlock(
      (bessel_fn): BesselBasis(r_max=4.5, num_basis=8, trainable=False)
      (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
    )
    (spherical_harmonics): SphericalHarmonics()
    (atomic_energies_fn): AtomicEnergiesBlock(energies=[-3.6674, -1.3220, -3.4782, -4.7250, -7.7279, -8.4045, -7.3594, -7.2844, -4.8962, -0.0301, -2.7527, -2.8138, -4.8444, -7.6966, -6.9632, -4.6738, -2.8140, -0.0623, -2.6252, -5.3848, -7.9162, -10.2708, -8.6724, -9.2372, -8.3056, -7.0547, -5.5709, -5.1741, -3.2510, -1.2880, -3.5322, -4.7113, -3.9718, -3.8862, -2.5183, 6.7068, -2.5661, -4.9390, -10.1536, -11.8571, -12.1416, -8.7861, -8.7954, -7.7784, -6.8387, -4.8812, -2.0606, -0.6440, -2.7886, -3.8168, -3.5880, -2.8806, -1.6361, 9.7960, -2.7486, -4.9867, -8.9295, -8.7417, -8.0122, -8.2336, -7.6245, -8.1614, -13.5915, -18.5381, -7.6446, -8.1150, -7.6146, -6.8296, -7.8200, -3.5770, -7.4692, -12.7706, -14.1110, -9.3544, -11.3765, -9.6116, -7.3213, -5.3043, -2.3873, 0.2479, -2.3155, -3.7254, -3.4302, -5.0659, -11.0175, -12.2443, -13.8466, -14.9527, -15.3033])
    (interactions): ModuleList(
      (0): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
        (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 512]
        (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e x 89x0e -> 128x0e+128x1o | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
      (1): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
        (conv_tp): TensorProduct(128x0e+128x1o x 1x0e+1x1o+1x2e+1x3o -> 256x0e+384x1o+384x2e+256x3o | 1280 paths | 1280 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1280]
        (linear): Linear(256x0e+384x1o+384x2e+256x3o -> 128x0e+128x1o+128x2e+128x3o | 163840 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o x 89x0e -> 128x0e+128x1o | 2916352 paths | 2916352 weights)
        (reshape): reshape_irreps()
      )
      (2): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
        (conv_tp): TensorProduct(128x0e+128x1o x 1x0e+1x1o+1x2e+1x3o -> 256x0e+384x1o+384x2e+256x3o | 1280 paths | 1280 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1280]
        (linear): Linear(256x0e+384x1o+384x2e+256x3o -> 128x0e+128x1o+128x2e+128x3o | 163840 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o x 89x0e -> 128x0e | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
    )
    (products): ModuleList(
      (0-1): 2 x EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
            (1): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x6x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
      )
      (2): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e -> 128x0e | 16384 weights)
      )
    )
    (readouts): ModuleList(
      (0-1): 2 x LinearReadoutBlock(
        (linear): Linear(128x0e+128x1o -> 1x0e | 128 weights)
      )
      (2): NonLinearReadoutBlock(
        (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
        (non_linearity): Activation [x] (16x0e -> 16x0e)
        (linear_2): Linear(16x0e -> 1x0e | 16 weights)
      )
    )
    (scale_shift): ScaleShiftBlock(scale=0.804340, shift=0.164779)
  )
)
2023-12-09 09:07:02.079 INFO: Number of parameters: 8904592
2023-12-09 09:07:02.079 INFO: Optimizer: AcceleratedOptimizer (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    name: interactions_decay
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    name: interactions_no_decay
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    name: products
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2023-12-09 09:07:02.079 INFO: Using gradient clipping with tolerance=10.000
2023-12-09 09:07:02.079 INFO: Started training
2023-12-09 09:08:32.857 INFO: MACE version: 0.1.0
2023-12-09 09:08:32.857 INFO: Configuration: Namespace(name='MACE_MPtrj_2022.9', seed=42, log_dir='data-train-result-stress-128-inter3/logs', model_dir='data-train-result-stress-128-inter3', checkpoints_dir='data-train-result-stress-128-inter3/checkpoints', results_dir='data-train-result-stress-128-inter3/results', downloads_dir='data-train-result-stress-128-inter3/downloads', default_dtype='float64', log_level='INFO', error_table='PerAtomMAEstress', model='ScaleShiftMACE', r_max=5.0, num_radial_basis=8, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=3, MLP_irreps='16x0e', hidden_irreps='32x0e', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=True, compute_forces=True, train_file='./data-train-preprocessed/train.h5', valid_file='./data-train-preprocessed/valid.h5', valid_fraction=0.1, test_file=None, test_dir=None, num_workers=8, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file='./data-train-preprocessed/statistics.json', E0s=None, energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='stress-l1', forces_weight=5.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=400.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=32, valid_batch_size=32, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=100, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=True, restart_lr=0.0002, save_cpu=True, clip_grad=10.0, wandb=False, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-12-09 09:08:32.857 INFO: Using statistics json file
2023-12-09 09:08:32.857 INFO: Using atomic numbers from statistics file
2023-12-09 09:08:32.858 INFO: AtomicNumberTable: (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 89, 90, 91, 92, 93, 94)
2023-12-09 09:08:32.858 INFO: Atomic Energies not in training file, using command line argument E0s
2023-12-09 09:08:32.859 INFO: Atomic energies: [-3.6673775936325184, -1.321978574671279, -3.47815910592578, -4.724966512505185, -7.727941403300326, -8.404543836565129, -7.359429774977432, -7.284436081345614, -4.896162007436489, -0.03005797428312995, -2.7527187727369, -2.8138258116559136, -4.844369939040846, -7.6966307568316115, -6.96321292174237, -4.673811566998673, -2.813984104722163, -0.06233472731112788, -2.6251773081704863, -5.384791381758609, -7.916197568907359, -10.270820955634214, -8.672390387555845, -9.2371580345617, -8.305620224433062, -7.054671703876374, -5.570915377375696, -5.174147851464132, -3.251035550574451, -1.2879654275024013, -3.5321835252059812, -4.711328365973749, -3.9717755452456673, -3.886221455984922, -2.5183143168985502, 6.706842222672468, -2.566057480857263, -4.938993788294903, -10.153603816562159, -11.857062150232505, -12.14164656151253, -8.786094380920531, -8.795434431218645, -7.778351502991773, -6.838726494373795, -4.881216430056056, -2.0605586704343675, -0.6439905162993389, -2.788575343692543, -3.816810475940441, -3.587983770584603, -2.8805917608627976, -1.6360524330360255, 9.796001071919388, -2.7486371263604354, -4.986670776340143, -8.929476698318382, -8.74170685282431, -8.01217127881877, -8.233598378021814, -7.62454389634746, -8.161368139142393, -13.591451290378114, -18.538136714242995, -7.644552511106582, -8.115049752450005, -7.614570319217799, -6.82962645334957, -7.820026786949461, -3.5770491745130024, -7.469205400904766, -12.770648602823787, -14.110986902146283, -9.354405708044254, -11.376459286198285, -9.611613368883013, -7.321263077561875, -5.304305597659051, -2.3873175082519373, 0.24792131307789267, -2.31553585581406, -3.7254481655069127, -3.4301772252097935, -5.065907805804548, -11.017529306980132, -12.244262478240024, -13.846602972246156, -14.952721865054968, -15.303292182007306]
2023-12-09 09:08:32.923 INFO: WeightedEnergyForcesStressLossL1(energy_weight=1.000, forces_weight=5.000, stress_weight=400.000)
2023-12-09 09:08:32.924 INFO: Average number of neighbors: 25.57754135131836
2023-12-09 09:08:32.924 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': True, 'dipoles': False}
2023-12-09 09:08:32.924 INFO: Building model
2023-12-09 09:08:32.924 INFO: Hidden irreps: 128x0e + 128x1o
2023-12-09 09:08:37.006 INFO: Loading states from data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-76
2023-12-09 09:08:37.059 INFO: All model weights loaded successfully
2023-12-09 09:08:37.167 INFO: All optimizer states loaded successfully
2023-12-09 09:08:37.167 INFO: All scheduler states loaded successfully
2023-12-09 09:08:37.170 INFO: All random states loaded successfully
2023-12-09 09:08:37.171 INFO: Loading in 0 custom states
2023-12-09 09:08:37.172 INFO: DistributedDataParallel(
  (module): ScaleShiftMACE(
    (node_embedding): LinearNodeEmbeddingBlock(
      (linear): Linear(89x0e -> 128x0e | 11392 weights)
    )
    (radial_embedding): RadialEmbeddingBlock(
      (bessel_fn): BesselBasis(r_max=4.5, num_basis=8, trainable=False)
      (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
    )
    (spherical_harmonics): SphericalHarmonics()
    (atomic_energies_fn): AtomicEnergiesBlock(energies=[-3.6674, -1.3220, -3.4782, -4.7250, -7.7279, -8.4045, -7.3594, -7.2844, -4.8962, -0.0301, -2.7527, -2.8138, -4.8444, -7.6966, -6.9632, -4.6738, -2.8140, -0.0623, -2.6252, -5.3848, -7.9162, -10.2708, -8.6724, -9.2372, -8.3056, -7.0547, -5.5709, -5.1741, -3.2510, -1.2880, -3.5322, -4.7113, -3.9718, -3.8862, -2.5183, 6.7068, -2.5661, -4.9390, -10.1536, -11.8571, -12.1416, -8.7861, -8.7954, -7.7784, -6.8387, -4.8812, -2.0606, -0.6440, -2.7886, -3.8168, -3.5880, -2.8806, -1.6361, 9.7960, -2.7486, -4.9867, -8.9295, -8.7417, -8.0122, -8.2336, -7.6245, -8.1614, -13.5915, -18.5381, -7.6446, -8.1150, -7.6146, -6.8296, -7.8200, -3.5770, -7.4692, -12.7706, -14.1110, -9.3544, -11.3765, -9.6116, -7.3213, -5.3043, -2.3873, 0.2479, -2.3155, -3.7254, -3.4302, -5.0659, -11.0175, -12.2443, -13.8466, -14.9527, -15.3033])
    (interactions): ModuleList(
      (0): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
        (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 512]
        (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e x 89x0e -> 128x0e+128x1o | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
      (1): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
        (conv_tp): TensorProduct(128x0e+128x1o x 1x0e+1x1o+1x2e+1x3o -> 256x0e+384x1o+384x2e+256x3o | 1280 paths | 1280 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1280]
        (linear): Linear(256x0e+384x1o+384x2e+256x3o -> 128x0e+128x1o+128x2e+128x3o | 163840 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o x 89x0e -> 128x0e+128x1o | 2916352 paths | 2916352 weights)
        (reshape): reshape_irreps()
      )
      (2): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
        (conv_tp): TensorProduct(128x0e+128x1o x 1x0e+1x1o+1x2e+1x3o -> 256x0e+384x1o+384x2e+256x3o | 1280 paths | 1280 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1280]
        (linear): Linear(256x0e+384x1o+384x2e+256x3o -> 128x0e+128x1o+128x2e+128x3o | 163840 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o x 89x0e -> 128x0e | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
    )
    (products): ModuleList(
      (0-1): 2 x EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
            (1): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x6x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
      )
      (2): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e -> 128x0e | 16384 weights)
      )
    )
    (readouts): ModuleList(
      (0-1): 2 x LinearReadoutBlock(
        (linear): Linear(128x0e+128x1o -> 1x0e | 128 weights)
      )
      (2): NonLinearReadoutBlock(
        (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
        (non_linearity): Activation [x] (16x0e -> 16x0e)
        (linear_2): Linear(16x0e -> 1x0e | 16 weights)
      )
    )
    (scale_shift): ScaleShiftBlock(scale=0.804340, shift=0.164779)
  )
)
2023-12-09 09:08:37.177 INFO: Number of parameters: 8904592
2023-12-09 09:08:37.177 INFO: Optimizer: AcceleratedOptimizer (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    name: interactions_decay
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    name: interactions_no_decay
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    name: products
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2023-12-09 09:08:37.177 INFO: Using gradient clipping with tolerance=10.000
2023-12-09 09:08:37.177 INFO: Started training
2023-12-09 09:08:39.156 INFO: Reducer buckets have been rebuilt in this iteration.
2023-12-09 09:08:39.156 INFO: Reducer buckets have been rebuilt in this iteration.
2023-12-09 09:08:39.156 INFO: Reducer buckets have been rebuilt in this iteration.
2023-12-09 09:08:39.156 INFO: Reducer buckets have been rebuilt in this iteration.
2023-12-09 11:07:37.824 INFO: Epoch 76: loss=0.0109, MAE_E_per_atom=17.2 meV, MAE_F=49.0 meV / A, MAE_S_per_atom=0.217 meV / A^3
2023-12-09 11:07:37.826 INFO: Saving current state to data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-76
2023-12-09 11:07:37.972 INFO: Model weights saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-76/pytorch_model.bin
2023-12-09 11:07:38.357 INFO: Optimizer state saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-76/optimizer.bin
2023-12-09 11:07:38.364 INFO: Random states saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-76/random_states_0.pkl
2023-12-09 11:20:41.182 INFO: MACE version: 0.1.0
2023-12-09 11:20:41.183 INFO: Configuration: Namespace(name='MACE_MPtrj_2022.9', seed=42, log_dir='data-train-result-stress-128-inter3/logs', model_dir='data-train-result-stress-128-inter3', checkpoints_dir='data-train-result-stress-128-inter3/checkpoints', results_dir='data-train-result-stress-128-inter3/results', downloads_dir='data-train-result-stress-128-inter3/downloads', default_dtype='float64', log_level='INFO', error_table='PerAtomMAEstress', model='ScaleShiftMACE', r_max=5.0, num_radial_basis=8, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=3, MLP_irreps='16x0e', hidden_irreps='32x0e', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=True, compute_forces=True, train_file='./data-train-preprocessed/train.h5', valid_file='./data-train-preprocessed/valid.h5', valid_fraction=0.1, test_file=None, test_dir=None, num_workers=8, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file='./data-train-preprocessed/statistics.json', E0s=None, energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='stress-l1', forces_weight=1.0, swa_forces_weight=1.0, energy_weight=5.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=400.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=32, valid_batch_size=32, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=100, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=True, restart_lr=0.0002, save_cpu=True, clip_grad=10.0, wandb=False, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-12-09 11:20:41.183 INFO: Using statistics json file
2023-12-09 11:20:41.183 INFO: Using atomic numbers from statistics file
2023-12-09 11:20:41.183 INFO: AtomicNumberTable: (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 89, 90, 91, 92, 93, 94)
2023-12-09 11:20:41.183 INFO: Atomic Energies not in training file, using command line argument E0s
2023-12-09 11:20:41.184 INFO: Atomic energies: [-3.6673775936325184, -1.321978574671279, -3.47815910592578, -4.724966512505185, -7.727941403300326, -8.404543836565129, -7.359429774977432, -7.284436081345614, -4.896162007436489, -0.03005797428312995, -2.7527187727369, -2.8138258116559136, -4.844369939040846, -7.6966307568316115, -6.96321292174237, -4.673811566998673, -2.813984104722163, -0.06233472731112788, -2.6251773081704863, -5.384791381758609, -7.916197568907359, -10.270820955634214, -8.672390387555845, -9.2371580345617, -8.305620224433062, -7.054671703876374, -5.570915377375696, -5.174147851464132, -3.251035550574451, -1.2879654275024013, -3.5321835252059812, -4.711328365973749, -3.9717755452456673, -3.886221455984922, -2.5183143168985502, 6.706842222672468, -2.566057480857263, -4.938993788294903, -10.153603816562159, -11.857062150232505, -12.14164656151253, -8.786094380920531, -8.795434431218645, -7.778351502991773, -6.838726494373795, -4.881216430056056, -2.0605586704343675, -0.6439905162993389, -2.788575343692543, -3.816810475940441, -3.587983770584603, -2.8805917608627976, -1.6360524330360255, 9.796001071919388, -2.7486371263604354, -4.986670776340143, -8.929476698318382, -8.74170685282431, -8.01217127881877, -8.233598378021814, -7.62454389634746, -8.161368139142393, -13.591451290378114, -18.538136714242995, -7.644552511106582, -8.115049752450005, -7.614570319217799, -6.82962645334957, -7.820026786949461, -3.5770491745130024, -7.469205400904766, -12.770648602823787, -14.110986902146283, -9.354405708044254, -11.376459286198285, -9.611613368883013, -7.321263077561875, -5.304305597659051, -2.3873175082519373, 0.24792131307789267, -2.31553585581406, -3.7254481655069127, -3.4301772252097935, -5.065907805804548, -11.017529306980132, -12.244262478240024, -13.846602972246156, -14.952721865054968, -15.303292182007306]
2023-12-09 11:20:41.233 INFO: WeightedEnergyForcesStressLossL1(energy_weight=5.000, forces_weight=1.000, stress_weight=400.000)
2023-12-09 11:20:41.233 INFO: Average number of neighbors: 25.57754135131836
2023-12-09 11:20:41.233 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': True, 'dipoles': False}
2023-12-09 11:20:41.233 INFO: Building model
2023-12-09 11:20:41.233 INFO: Hidden irreps: 128x0e + 128x1o
2023-12-09 11:20:45.298 INFO: Loading states from data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-76
2023-12-09 11:20:45.357 INFO: All model weights loaded successfully
2023-12-09 11:20:45.482 INFO: All optimizer states loaded successfully
2023-12-09 11:20:45.482 INFO: All scheduler states loaded successfully
2023-12-09 11:20:45.484 INFO: All random states loaded successfully
2023-12-09 11:20:45.484 INFO: Loading in 0 custom states
2023-12-09 11:20:45.485 INFO: DistributedDataParallel(
  (module): ScaleShiftMACE(
    (node_embedding): LinearNodeEmbeddingBlock(
      (linear): Linear(89x0e -> 128x0e | 11392 weights)
    )
    (radial_embedding): RadialEmbeddingBlock(
      (bessel_fn): BesselBasis(r_max=4.5, num_basis=8, trainable=False)
      (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
    )
    (spherical_harmonics): SphericalHarmonics()
    (atomic_energies_fn): AtomicEnergiesBlock(energies=[-3.6674, -1.3220, -3.4782, -4.7250, -7.7279, -8.4045, -7.3594, -7.2844, -4.8962, -0.0301, -2.7527, -2.8138, -4.8444, -7.6966, -6.9632, -4.6738, -2.8140, -0.0623, -2.6252, -5.3848, -7.9162, -10.2708, -8.6724, -9.2372, -8.3056, -7.0547, -5.5709, -5.1741, -3.2510, -1.2880, -3.5322, -4.7113, -3.9718, -3.8862, -2.5183, 6.7068, -2.5661, -4.9390, -10.1536, -11.8571, -12.1416, -8.7861, -8.7954, -7.7784, -6.8387, -4.8812, -2.0606, -0.6440, -2.7886, -3.8168, -3.5880, -2.8806, -1.6361, 9.7960, -2.7486, -4.9867, -8.9295, -8.7417, -8.0122, -8.2336, -7.6245, -8.1614, -13.5915, -18.5381, -7.6446, -8.1150, -7.6146, -6.8296, -7.8200, -3.5770, -7.4692, -12.7706, -14.1110, -9.3544, -11.3765, -9.6116, -7.3213, -5.3043, -2.3873, 0.2479, -2.3155, -3.7254, -3.4302, -5.0659, -11.0175, -12.2443, -13.8466, -14.9527, -15.3033])
    (interactions): ModuleList(
      (0): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
        (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 512]
        (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e x 89x0e -> 128x0e+128x1o | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
      (1): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
        (conv_tp): TensorProduct(128x0e+128x1o x 1x0e+1x1o+1x2e+1x3o -> 256x0e+384x1o+384x2e+256x3o | 1280 paths | 1280 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1280]
        (linear): Linear(256x0e+384x1o+384x2e+256x3o -> 128x0e+128x1o+128x2e+128x3o | 163840 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o x 89x0e -> 128x0e+128x1o | 2916352 paths | 2916352 weights)
        (reshape): reshape_irreps()
      )
      (2): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
        (conv_tp): TensorProduct(128x0e+128x1o x 1x0e+1x1o+1x2e+1x3o -> 256x0e+384x1o+384x2e+256x3o | 1280 paths | 1280 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1280]
        (linear): Linear(256x0e+384x1o+384x2e+256x3o -> 128x0e+128x1o+128x2e+128x3o | 163840 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o x 89x0e -> 128x0e | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
    )
    (products): ModuleList(
      (0-1): 2 x EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
            (1): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x6x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
      )
      (2): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e -> 128x0e | 16384 weights)
      )
    )
    (readouts): ModuleList(
      (0-1): 2 x LinearReadoutBlock(
        (linear): Linear(128x0e+128x1o -> 1x0e | 128 weights)
      )
      (2): NonLinearReadoutBlock(
        (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
        (non_linearity): Activation [x] (16x0e -> 16x0e)
        (linear_2): Linear(16x0e -> 1x0e | 16 weights)
      )
    )
    (scale_shift): ScaleShiftBlock(scale=0.804340, shift=0.164779)
  )
)
2023-12-09 11:20:45.490 INFO: Number of parameters: 8904592
2023-12-09 11:20:45.490 INFO: Optimizer: AcceleratedOptimizer (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    name: interactions_decay
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    name: interactions_no_decay
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    name: products
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2023-12-09 11:20:45.490 INFO: Using gradient clipping with tolerance=10.000
2023-12-09 11:20:45.490 INFO: Started training
2023-12-09 11:20:47.534 INFO: Reducer buckets have been rebuilt in this iteration.
2023-12-09 11:20:47.534 INFO: Reducer buckets have been rebuilt in this iteration.
2023-12-09 11:20:47.536 INFO: Reducer buckets have been rebuilt in this iteration.
2023-12-09 11:20:47.536 INFO: Reducer buckets have been rebuilt in this iteration.
2023-12-09 13:19:45.821 INFO: Epoch 76: loss=0.0064, MAE_E_per_atom=13.4 meV, MAE_F=51.4 meV / A, MAE_S_per_atom=0.213 meV / A^3
2023-12-09 13:19:45.824 INFO: Saving current state to data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-76
2023-12-09 13:19:45.956 INFO: Model weights saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-76/pytorch_model.bin
2023-12-09 13:19:46.307 INFO: Optimizer state saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-76/optimizer.bin
2023-12-09 13:19:46.309 INFO: Random states saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-76/random_states_0.pkl
2023-12-09 17:11:33.538 INFO: Epoch 78: loss=0.0060, MAE_E_per_atom=12.8 meV, MAE_F=52.2 meV / A, MAE_S_per_atom=0.190 meV / A^3
2023-12-09 17:11:33.560 INFO: Saving current state to data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-78
2023-12-09 17:11:33.648 INFO: Model weights saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-78/pytorch_model.bin
2023-12-09 17:11:33.886 INFO: Optimizer state saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-78/optimizer.bin
2023-12-09 17:11:33.888 INFO: Random states saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-78/random_states_0.pkl
2023-12-09 21:11:02.257 INFO: Epoch 80: loss=0.0058, MAE_E_per_atom=12.4 meV, MAE_F=52.7 meV / A, MAE_S_per_atom=0.180 meV / A^3
2023-12-09 21:11:02.279 INFO: Saving current state to data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-80
2023-12-09 21:11:02.366 INFO: Model weights saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-80/pytorch_model.bin
2023-12-09 21:11:02.602 INFO: Optimizer state saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-80/optimizer.bin
2023-12-09 21:11:02.604 INFO: Random states saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-80/random_states_0.pkl
2023-12-10 01:23:08.063 INFO: Epoch 82: loss=0.0057, MAE_E_per_atom=12.2 meV, MAE_F=52.9 meV / A, MAE_S_per_atom=0.174 meV / A^3
2023-12-10 01:23:08.090 INFO: Saving current state to data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-82
2023-12-10 01:23:08.202 INFO: Model weights saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-82/pytorch_model.bin
2023-12-10 01:23:08.412 INFO: Optimizer state saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-82/optimizer.bin
2023-12-10 01:23:08.413 INFO: Random states saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-82/random_states_0.pkl
2023-12-10 05:58:07.983 INFO: Epoch 84: loss=0.0057, MAE_E_per_atom=11.9 meV, MAE_F=53.0 meV / A, MAE_S_per_atom=0.170 meV / A^3
2023-12-10 05:58:08.005 INFO: Saving current state to data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-84
2023-12-10 05:58:08.106 INFO: Model weights saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-84/pytorch_model.bin
2023-12-10 05:58:08.317 INFO: Optimizer state saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-84/optimizer.bin
2023-12-10 05:58:08.319 INFO: Random states saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-84/random_states_0.pkl
2023-12-10 10:59:58.587 INFO: Epoch 86: loss=0.0056, MAE_E_per_atom=11.8 meV, MAE_F=53.1 meV / A, MAE_S_per_atom=0.167 meV / A^3
2023-12-10 10:59:58.608 INFO: Saving current state to data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-86
2023-12-10 10:59:58.695 INFO: Model weights saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-86/pytorch_model.bin
2023-12-10 10:59:58.934 INFO: Optimizer state saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-86/optimizer.bin
2023-12-10 10:59:58.936 INFO: Random states saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-86/random_states_0.pkl
2023-12-10 11:20:34.967 INFO: MACE version: 0.1.0
2023-12-10 11:20:34.967 INFO: Configuration: Namespace(name='MACE_MPtrj_2022.9', seed=42, log_dir='data-train-result-stress-128-inter3/logs', model_dir='data-train-result-stress-128-inter3', checkpoints_dir='data-train-result-stress-128-inter3/checkpoints', results_dir='data-train-result-stress-128-inter3/results', downloads_dir='data-train-result-stress-128-inter3/downloads', default_dtype='float64', log_level='INFO', error_table='PerAtomMAEstress', model='ScaleShiftMACE', r_max=5.0, num_radial_basis=8, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=3, MLP_irreps='16x0e', hidden_irreps='32x0e', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=True, compute_forces=True, train_file='./data-train-preprocessed/train.h5', valid_file='./data-train-preprocessed/valid.h5', valid_fraction=0.1, test_file=None, test_dir=None, num_workers=8, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file='./data-train-preprocessed/statistics.json', E0s=None, energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='stress-l1', forces_weight=1.0, swa_forces_weight=1.0, energy_weight=5.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=500.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=32, valid_batch_size=32, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=100, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=True, restart_lr=0.0002, save_cpu=True, clip_grad=10.0, wandb=False, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-12-10 11:20:34.967 INFO: Using statistics json file
2023-12-10 11:20:34.967 INFO: Using atomic numbers from statistics file
2023-12-10 11:20:34.968 INFO: AtomicNumberTable: (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 89, 90, 91, 92, 93, 94)
2023-12-10 11:20:34.968 INFO: Atomic Energies not in training file, using command line argument E0s
2023-12-10 11:20:34.969 INFO: Atomic energies: [-3.6673775936325184, -1.321978574671279, -3.47815910592578, -4.724966512505185, -7.727941403300326, -8.404543836565129, -7.359429774977432, -7.284436081345614, -4.896162007436489, -0.03005797428312995, -2.7527187727369, -2.8138258116559136, -4.844369939040846, -7.6966307568316115, -6.96321292174237, -4.673811566998673, -2.813984104722163, -0.06233472731112788, -2.6251773081704863, -5.384791381758609, -7.916197568907359, -10.270820955634214, -8.672390387555845, -9.2371580345617, -8.305620224433062, -7.054671703876374, -5.570915377375696, -5.174147851464132, -3.251035550574451, -1.2879654275024013, -3.5321835252059812, -4.711328365973749, -3.9717755452456673, -3.886221455984922, -2.5183143168985502, 6.706842222672468, -2.566057480857263, -4.938993788294903, -10.153603816562159, -11.857062150232505, -12.14164656151253, -8.786094380920531, -8.795434431218645, -7.778351502991773, -6.838726494373795, -4.881216430056056, -2.0605586704343675, -0.6439905162993389, -2.788575343692543, -3.816810475940441, -3.587983770584603, -2.8805917608627976, -1.6360524330360255, 9.796001071919388, -2.7486371263604354, -4.986670776340143, -8.929476698318382, -8.74170685282431, -8.01217127881877, -8.233598378021814, -7.62454389634746, -8.161368139142393, -13.591451290378114, -18.538136714242995, -7.644552511106582, -8.115049752450005, -7.614570319217799, -6.82962645334957, -7.820026786949461, -3.5770491745130024, -7.469205400904766, -12.770648602823787, -14.110986902146283, -9.354405708044254, -11.376459286198285, -9.611613368883013, -7.321263077561875, -5.304305597659051, -2.3873175082519373, 0.24792131307789267, -2.31553585581406, -3.7254481655069127, -3.4301772252097935, -5.065907805804548, -11.017529306980132, -12.244262478240024, -13.846602972246156, -14.952721865054968, -15.303292182007306]
2023-12-10 11:20:35.048 INFO: WeightedEnergyForcesStressLossL1(energy_weight=5.000, forces_weight=1.000, stress_weight=500.000)
2023-12-10 11:20:35.048 INFO: Average number of neighbors: 25.57754135131836
2023-12-10 11:20:35.048 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': True, 'dipoles': False}
2023-12-10 11:20:35.048 INFO: Building model
2023-12-10 11:20:35.048 INFO: Hidden irreps: 128x0e + 128x1o
2023-12-10 11:20:39.094 INFO: Loading states from data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-86
2023-12-10 11:20:39.152 INFO: All model weights loaded successfully
2023-12-10 11:20:39.271 INFO: All optimizer states loaded successfully
2023-12-10 11:20:39.271 INFO: All scheduler states loaded successfully
2023-12-10 11:20:39.275 INFO: All random states loaded successfully
2023-12-10 11:20:39.276 INFO: Loading in 0 custom states
2023-12-10 11:20:39.277 INFO: DistributedDataParallel(
  (module): ScaleShiftMACE(
    (node_embedding): LinearNodeEmbeddingBlock(
      (linear): Linear(89x0e -> 128x0e | 11392 weights)
    )
    (radial_embedding): RadialEmbeddingBlock(
      (bessel_fn): BesselBasis(r_max=4.5, num_basis=8, trainable=False)
      (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
    )
    (spherical_harmonics): SphericalHarmonics()
    (atomic_energies_fn): AtomicEnergiesBlock(energies=[-3.6674, -1.3220, -3.4782, -4.7250, -7.7279, -8.4045, -7.3594, -7.2844, -4.8962, -0.0301, -2.7527, -2.8138, -4.8444, -7.6966, -6.9632, -4.6738, -2.8140, -0.0623, -2.6252, -5.3848, -7.9162, -10.2708, -8.6724, -9.2372, -8.3056, -7.0547, -5.5709, -5.1741, -3.2510, -1.2880, -3.5322, -4.7113, -3.9718, -3.8862, -2.5183, 6.7068, -2.5661, -4.9390, -10.1536, -11.8571, -12.1416, -8.7861, -8.7954, -7.7784, -6.8387, -4.8812, -2.0606, -0.6440, -2.7886, -3.8168, -3.5880, -2.8806, -1.6361, 9.7960, -2.7486, -4.9867, -8.9295, -8.7417, -8.0122, -8.2336, -7.6245, -8.1614, -13.5915, -18.5381, -7.6446, -8.1150, -7.6146, -6.8296, -7.8200, -3.5770, -7.4692, -12.7706, -14.1110, -9.3544, -11.3765, -9.6116, -7.3213, -5.3043, -2.3873, 0.2479, -2.3155, -3.7254, -3.4302, -5.0659, -11.0175, -12.2443, -13.8466, -14.9527, -15.3033])
    (interactions): ModuleList(
      (0): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
        (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 512]
        (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e x 89x0e -> 128x0e+128x1o | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
      (1): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
        (conv_tp): TensorProduct(128x0e+128x1o x 1x0e+1x1o+1x2e+1x3o -> 256x0e+384x1o+384x2e+256x3o | 1280 paths | 1280 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1280]
        (linear): Linear(256x0e+384x1o+384x2e+256x3o -> 128x0e+128x1o+128x2e+128x3o | 163840 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o x 89x0e -> 128x0e+128x1o | 2916352 paths | 2916352 weights)
        (reshape): reshape_irreps()
      )
      (2): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
        (conv_tp): TensorProduct(128x0e+128x1o x 1x0e+1x1o+1x2e+1x3o -> 256x0e+384x1o+384x2e+256x3o | 1280 paths | 1280 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1280]
        (linear): Linear(256x0e+384x1o+384x2e+256x3o -> 128x0e+128x1o+128x2e+128x3o | 163840 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o x 89x0e -> 128x0e | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
    )
    (products): ModuleList(
      (0-1): 2 x EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
            (1): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x6x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
      )
      (2): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e -> 128x0e | 16384 weights)
      )
    )
    (readouts): ModuleList(
      (0-1): 2 x LinearReadoutBlock(
        (linear): Linear(128x0e+128x1o -> 1x0e | 128 weights)
      )
      (2): NonLinearReadoutBlock(
        (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
        (non_linearity): Activation [x] (16x0e -> 16x0e)
        (linear_2): Linear(16x0e -> 1x0e | 16 weights)
      )
    )
    (scale_shift): ScaleShiftBlock(scale=0.804340, shift=0.164779)
  )
)
2023-12-10 11:20:39.282 INFO: Number of parameters: 8904592
2023-12-10 11:20:39.282 INFO: Optimizer: AcceleratedOptimizer (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    name: interactions_decay
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    name: interactions_no_decay
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    name: products
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2023-12-10 11:20:39.282 INFO: Using gradient clipping with tolerance=10.000
2023-12-10 11:20:39.282 INFO: Started training
2023-12-10 11:20:41.297 INFO: Reducer buckets have been rebuilt in this iteration.
2023-12-10 11:20:41.297 INFO: Reducer buckets have been rebuilt in this iteration.
2023-12-10 11:20:41.297 INFO: Reducer buckets have been rebuilt in this iteration.
2023-12-10 11:20:41.297 INFO: Reducer buckets have been rebuilt in this iteration.
2023-12-10 13:19:34.963 INFO: Epoch 86: loss=0.0062, MAE_E_per_atom=11.8 meV, MAE_F=53.4 meV / A, MAE_S_per_atom=0.2 meV / A^3
2023-12-10 13:19:34.966 INFO: Saving current state to data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-86
2023-12-10 13:19:35.119 INFO: Model weights saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-86/pytorch_model.bin
2023-12-10 13:19:35.518 INFO: Optimizer state saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-86/optimizer.bin
2023-12-10 13:19:35.521 INFO: Random states saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-86/random_states_0.pkl
2023-12-10 17:11:22.780 INFO: Epoch 88: loss=0.0060, MAE_E_per_atom=11.7 meV, MAE_F=53.6 meV / A, MAE_S_per_atom=0.2 meV / A^3
2023-12-10 17:11:22.802 INFO: Saving current state to data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-88
2023-12-10 17:11:22.880 INFO: Model weights saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-88/pytorch_model.bin
2023-12-10 17:11:23.048 INFO: Optimizer state saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-88/optimizer.bin
2023-12-10 17:11:23.049 INFO: Random states saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-88/random_states_0.pkl
2023-12-10 21:10:50.861 INFO: Epoch 90: loss=0.0060, MAE_E_per_atom=11.6 meV, MAE_F=53.7 meV / A, MAE_S_per_atom=0.2 meV / A^3
2023-12-10 21:10:50.882 INFO: Saving current state to data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-90
2023-12-10 21:10:50.959 INFO: Model weights saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-90/pytorch_model.bin
2023-12-10 21:10:51.127 INFO: Optimizer state saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-90/optimizer.bin
2023-12-10 21:10:51.128 INFO: Random states saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-90/random_states_0.pkl
2023-12-10 21:45:49.957 INFO: MACE version: 0.1.0
2023-12-10 21:45:49.958 INFO: Configuration: Namespace(name='MACE_MPtrj_2022.9', seed=42, log_dir='data-train-result-stress-128-inter3/logs', model_dir='data-train-result-stress-128-inter3', checkpoints_dir='data-train-result-stress-128-inter3/checkpoints', results_dir='data-train-result-stress-128-inter3/results', downloads_dir='data-train-result-stress-128-inter3/downloads', default_dtype='float64', log_level='INFO', error_table='PerAtomMAEstress', model='ScaleShiftMACE', r_max=5.0, num_radial_basis=8, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=3, MLP_irreps='16x0e', hidden_irreps='32x0e', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=True, compute_forces=True, train_file='./data-train-preprocessed/train.h5', valid_file='./data-train-preprocessed/valid.h5', valid_fraction=0.1, test_file=None, test_dir=None, num_workers=8, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file='./data-train-preprocessed/statistics.json', E0s=None, energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='stress-l1', forces_weight=1.0, swa_forces_weight=1.0, energy_weight=5.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=500.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=32, valid_batch_size=32, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=100, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=True, restart_lr=0.0002, save_cpu=True, clip_grad=10.0, wandb=False, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-12-10 21:45:49.958 INFO: Using statistics json file
2023-12-10 21:45:49.958 INFO: Using atomic numbers from statistics file
2023-12-10 21:45:49.958 INFO: AtomicNumberTable: (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 89, 90, 91, 92, 93, 94)
2023-12-10 21:45:49.959 INFO: Atomic Energies not in training file, using command line argument E0s
2023-12-10 21:45:49.959 INFO: Atomic energies: [-3.6673775936325184, -1.321978574671279, -3.47815910592578, -4.724966512505185, -7.727941403300326, -8.404543836565129, -7.359429774977432, -7.284436081345614, -4.896162007436489, -0.03005797428312995, -2.7527187727369, -2.8138258116559136, -4.844369939040846, -7.6966307568316115, -6.96321292174237, -4.673811566998673, -2.813984104722163, -0.06233472731112788, -2.6251773081704863, -5.384791381758609, -7.916197568907359, -10.270820955634214, -8.672390387555845, -9.2371580345617, -8.305620224433062, -7.054671703876374, -5.570915377375696, -5.174147851464132, -3.251035550574451, -1.2879654275024013, -3.5321835252059812, -4.711328365973749, -3.9717755452456673, -3.886221455984922, -2.5183143168985502, 6.706842222672468, -2.566057480857263, -4.938993788294903, -10.153603816562159, -11.857062150232505, -12.14164656151253, -8.786094380920531, -8.795434431218645, -7.778351502991773, -6.838726494373795, -4.881216430056056, -2.0605586704343675, -0.6439905162993389, -2.788575343692543, -3.816810475940441, -3.587983770584603, -2.8805917608627976, -1.6360524330360255, 9.796001071919388, -2.7486371263604354, -4.986670776340143, -8.929476698318382, -8.74170685282431, -8.01217127881877, -8.233598378021814, -7.62454389634746, -8.161368139142393, -13.591451290378114, -18.538136714242995, -7.644552511106582, -8.115049752450005, -7.614570319217799, -6.82962645334957, -7.820026786949461, -3.5770491745130024, -7.469205400904766, -12.770648602823787, -14.110986902146283, -9.354405708044254, -11.376459286198285, -9.611613368883013, -7.321263077561875, -5.304305597659051, -2.3873175082519373, 0.24792131307789267, -2.31553585581406, -3.7254481655069127, -3.4301772252097935, -5.065907805804548, -11.017529306980132, -12.244262478240024, -13.846602972246156, -14.952721865054968, -15.303292182007306]
2023-12-10 21:45:50.041 INFO: WeightedEnergyForcesStressLossL1(energy_weight=5.000, forces_weight=1.000, stress_weight=500.000)
2023-12-10 21:45:50.041 INFO: Average number of neighbors: 25.57754135131836
2023-12-10 21:45:50.041 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': True, 'dipoles': False}
2023-12-10 21:45:50.041 INFO: Building model
2023-12-10 21:45:50.041 INFO: Hidden irreps: 128x0e + 128x1o
2023-12-10 21:45:54.120 INFO: Loading states from data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-90
2023-12-10 21:45:54.181 INFO: All model weights loaded successfully
2023-12-10 21:45:54.287 INFO: All optimizer states loaded successfully
2023-12-10 21:45:54.287 INFO: All scheduler states loaded successfully
2023-12-10 21:45:54.290 INFO: All random states loaded successfully
2023-12-10 21:45:54.291 INFO: Loading in 0 custom states
2023-12-10 21:45:54.292 INFO: DistributedDataParallel(
  (module): ScaleShiftMACE(
    (node_embedding): LinearNodeEmbeddingBlock(
      (linear): Linear(89x0e -> 128x0e | 11392 weights)
    )
    (radial_embedding): RadialEmbeddingBlock(
      (bessel_fn): BesselBasis(r_max=4.5, num_basis=8, trainable=False)
      (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
    )
    (spherical_harmonics): SphericalHarmonics()
    (atomic_energies_fn): AtomicEnergiesBlock(energies=[-3.6674, -1.3220, -3.4782, -4.7250, -7.7279, -8.4045, -7.3594, -7.2844, -4.8962, -0.0301, -2.7527, -2.8138, -4.8444, -7.6966, -6.9632, -4.6738, -2.8140, -0.0623, -2.6252, -5.3848, -7.9162, -10.2708, -8.6724, -9.2372, -8.3056, -7.0547, -5.5709, -5.1741, -3.2510, -1.2880, -3.5322, -4.7113, -3.9718, -3.8862, -2.5183, 6.7068, -2.5661, -4.9390, -10.1536, -11.8571, -12.1416, -8.7861, -8.7954, -7.7784, -6.8387, -4.8812, -2.0606, -0.6440, -2.7886, -3.8168, -3.5880, -2.8806, -1.6361, 9.7960, -2.7486, -4.9867, -8.9295, -8.7417, -8.0122, -8.2336, -7.6245, -8.1614, -13.5915, -18.5381, -7.6446, -8.1150, -7.6146, -6.8296, -7.8200, -3.5770, -7.4692, -12.7706, -14.1110, -9.3544, -11.3765, -9.6116, -7.3213, -5.3043, -2.3873, 0.2479, -2.3155, -3.7254, -3.4302, -5.0659, -11.0175, -12.2443, -13.8466, -14.9527, -15.3033])
    (interactions): ModuleList(
      (0): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
        (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 512]
        (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e x 89x0e -> 128x0e+128x1o | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
      (1): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
        (conv_tp): TensorProduct(128x0e+128x1o x 1x0e+1x1o+1x2e+1x3o -> 256x0e+384x1o+384x2e+256x3o | 1280 paths | 1280 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1280]
        (linear): Linear(256x0e+384x1o+384x2e+256x3o -> 128x0e+128x1o+128x2e+128x3o | 163840 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o x 89x0e -> 128x0e+128x1o | 2916352 paths | 2916352 weights)
        (reshape): reshape_irreps()
      )
      (2): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
        (conv_tp): TensorProduct(128x0e+128x1o x 1x0e+1x1o+1x2e+1x3o -> 256x0e+384x1o+384x2e+256x3o | 1280 paths | 1280 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1280]
        (linear): Linear(256x0e+384x1o+384x2e+256x3o -> 128x0e+128x1o+128x2e+128x3o | 163840 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o x 89x0e -> 128x0e | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
    )
    (products): ModuleList(
      (0-1): 2 x EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
            (1): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x6x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
      )
      (2): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e -> 128x0e | 16384 weights)
      )
    )
    (readouts): ModuleList(
      (0-1): 2 x LinearReadoutBlock(
        (linear): Linear(128x0e+128x1o -> 1x0e | 128 weights)
      )
      (2): NonLinearReadoutBlock(
        (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
        (non_linearity): Activation [x] (16x0e -> 16x0e)
        (linear_2): Linear(16x0e -> 1x0e | 16 weights)
      )
    )
    (scale_shift): ScaleShiftBlock(scale=0.804340, shift=0.164779)
  )
)
2023-12-10 21:45:54.296 INFO: Number of parameters: 8904592
2023-12-10 21:45:54.296 INFO: Optimizer: AcceleratedOptimizer (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    name: interactions_decay
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    name: interactions_no_decay
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    name: products
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2023-12-10 21:45:54.297 INFO: Using gradient clipping with tolerance=10.000
2023-12-10 21:45:54.297 INFO: Started training
2023-12-10 21:45:56.342 INFO: Reducer buckets have been rebuilt in this iteration.
2023-12-10 21:45:56.342 INFO: Reducer buckets have been rebuilt in this iteration.
2023-12-10 21:45:56.342 INFO: Reducer buckets have been rebuilt in this iteration.
2023-12-10 21:45:56.342 INFO: Reducer buckets have been rebuilt in this iteration.
2023-12-10 23:44:59.294 INFO: Epoch 90: loss=0.0059, MAE_E_per_atom=11.5 meV, MAE_F=53.7 meV / A, MAE_S_per_atom=0.15890 meV / A^3
2023-12-10 23:44:59.296 INFO: Saving current state to data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-90
2023-12-10 23:44:59.428 INFO: Model weights saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-90/pytorch_model.bin
2023-12-10 23:44:59.780 INFO: Optimizer state saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-90/optimizer.bin
2023-12-10 23:44:59.783 INFO: Random states saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-90/random_states_0.pkl
2023-12-11 03:36:54.809 INFO: Epoch 92: loss=0.0059, MAE_E_per_atom=11.4 meV, MAE_F=53.8 meV / A, MAE_S_per_atom=0.15751 meV / A^3
2023-12-11 03:36:54.831 INFO: Saving current state to data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-92
2023-12-11 03:36:54.911 INFO: Model weights saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-92/pytorch_model.bin
2023-12-11 03:36:55.085 INFO: Optimizer state saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-92/optimizer.bin
2023-12-11 03:36:55.086 INFO: Random states saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-92/random_states_0.pkl
2023-12-11 07:37:09.770 INFO: Epoch 94: loss=0.0059, MAE_E_per_atom=11.3 meV, MAE_F=53.8 meV / A, MAE_S_per_atom=0.15671 meV / A^3
2023-12-11 07:37:09.791 INFO: Saving current state to data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-94
2023-12-11 07:37:09.869 INFO: Model weights saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-94/pytorch_model.bin
2023-12-11 07:37:10.039 INFO: Optimizer state saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-94/optimizer.bin
2023-12-11 07:37:10.040 INFO: Random states saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-94/random_states_0.pkl
2023-12-11 11:50:33.893 INFO: Epoch 96: loss=0.0058, MAE_E_per_atom=11.2 meV, MAE_F=53.9 meV / A, MAE_S_per_atom=0.15402 meV / A^3
2023-12-11 11:50:33.915 INFO: Saving current state to data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-96
2023-12-11 11:50:33.993 INFO: Model weights saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-96/pytorch_model.bin
2023-12-11 11:50:34.163 INFO: Optimizer state saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-96/optimizer.bin
2023-12-11 11:50:34.165 INFO: Random states saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-96/random_states_0.pkl
2023-12-11 11:55:12.715 INFO: MACE version: 0.1.0
2023-12-11 11:55:12.715 INFO: Configuration: Namespace(name='MACE_MPtrj_2022.9', seed=42, log_dir='data-train-result-stress-128-inter3/logs', model_dir='data-train-result-stress-128-inter3', checkpoints_dir='data-train-result-stress-128-inter3/checkpoints', results_dir='data-train-result-stress-128-inter3/results', downloads_dir='data-train-result-stress-128-inter3/downloads', default_dtype='float64', log_level='INFO', error_table='PerAtomMAEstress', model='ScaleShiftMACE', r_max=5.0, num_radial_basis=8, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=3, MLP_irreps='16x0e', hidden_irreps='32x0e', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=True, compute_forces=True, train_file='./data-train-preprocessed/train.h5', valid_file='./data-train-preprocessed/valid.h5', valid_fraction=0.1, test_file=None, test_dir=None, num_workers=8, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file='./data-train-preprocessed/statistics.json', E0s=None, energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='stress-l1', forces_weight=1.0, swa_forces_weight=1.0, energy_weight=5.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=500.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=32, valid_batch_size=32, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=100, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=True, restart_lr=0.0008, save_cpu=True, clip_grad=10.0, wandb=False, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-12-11 11:55:12.715 INFO: Using statistics json file
2023-12-11 11:55:12.715 INFO: Using atomic numbers from statistics file
2023-12-11 11:55:12.716 INFO: AtomicNumberTable: (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 89, 90, 91, 92, 93, 94)
2023-12-11 11:55:12.716 INFO: Atomic Energies not in training file, using command line argument E0s
2023-12-11 11:55:12.717 INFO: Atomic energies: [-3.6673775936325184, -1.321978574671279, -3.47815910592578, -4.724966512505185, -7.727941403300326, -8.404543836565129, -7.359429774977432, -7.284436081345614, -4.896162007436489, -0.03005797428312995, -2.7527187727369, -2.8138258116559136, -4.844369939040846, -7.6966307568316115, -6.96321292174237, -4.673811566998673, -2.813984104722163, -0.06233472731112788, -2.6251773081704863, -5.384791381758609, -7.916197568907359, -10.270820955634214, -8.672390387555845, -9.2371580345617, -8.305620224433062, -7.054671703876374, -5.570915377375696, -5.174147851464132, -3.251035550574451, -1.2879654275024013, -3.5321835252059812, -4.711328365973749, -3.9717755452456673, -3.886221455984922, -2.5183143168985502, 6.706842222672468, -2.566057480857263, -4.938993788294903, -10.153603816562159, -11.857062150232505, -12.14164656151253, -8.786094380920531, -8.795434431218645, -7.778351502991773, -6.838726494373795, -4.881216430056056, -2.0605586704343675, -0.6439905162993389, -2.788575343692543, -3.816810475940441, -3.587983770584603, -2.8805917608627976, -1.6360524330360255, 9.796001071919388, -2.7486371263604354, -4.986670776340143, -8.929476698318382, -8.74170685282431, -8.01217127881877, -8.233598378021814, -7.62454389634746, -8.161368139142393, -13.591451290378114, -18.538136714242995, -7.644552511106582, -8.115049752450005, -7.614570319217799, -6.82962645334957, -7.820026786949461, -3.5770491745130024, -7.469205400904766, -12.770648602823787, -14.110986902146283, -9.354405708044254, -11.376459286198285, -9.611613368883013, -7.321263077561875, -5.304305597659051, -2.3873175082519373, 0.24792131307789267, -2.31553585581406, -3.7254481655069127, -3.4301772252097935, -5.065907805804548, -11.017529306980132, -12.244262478240024, -13.846602972246156, -14.952721865054968, -15.303292182007306]
2023-12-11 11:55:12.781 INFO: WeightedEnergyForcesStressLossL1(energy_weight=5.000, forces_weight=1.000, stress_weight=500.000)
2023-12-11 11:55:12.781 INFO: Average number of neighbors: 25.57754135131836
2023-12-11 11:55:12.781 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': True, 'dipoles': False}
2023-12-11 11:55:12.781 INFO: Building model
2023-12-11 11:55:12.781 INFO: Hidden irreps: 128x0e + 128x1o
2023-12-11 11:55:16.803 INFO: Loading states from data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-96
2023-12-11 11:55:16.853 INFO: All model weights loaded successfully
2023-12-11 11:55:16.970 INFO: All optimizer states loaded successfully
2023-12-11 11:55:16.970 INFO: All scheduler states loaded successfully
2023-12-11 11:55:16.974 INFO: All random states loaded successfully
2023-12-11 11:55:16.975 INFO: Loading in 0 custom states
2023-12-11 11:55:16.976 INFO: DistributedDataParallel(
  (module): ScaleShiftMACE(
    (node_embedding): LinearNodeEmbeddingBlock(
      (linear): Linear(89x0e -> 128x0e | 11392 weights)
    )
    (radial_embedding): RadialEmbeddingBlock(
      (bessel_fn): BesselBasis(r_max=4.5, num_basis=8, trainable=False)
      (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
    )
    (spherical_harmonics): SphericalHarmonics()
    (atomic_energies_fn): AtomicEnergiesBlock(energies=[-3.6674, -1.3220, -3.4782, -4.7250, -7.7279, -8.4045, -7.3594, -7.2844, -4.8962, -0.0301, -2.7527, -2.8138, -4.8444, -7.6966, -6.9632, -4.6738, -2.8140, -0.0623, -2.6252, -5.3848, -7.9162, -10.2708, -8.6724, -9.2372, -8.3056, -7.0547, -5.5709, -5.1741, -3.2510, -1.2880, -3.5322, -4.7113, -3.9718, -3.8862, -2.5183, 6.7068, -2.5661, -4.9390, -10.1536, -11.8571, -12.1416, -8.7861, -8.7954, -7.7784, -6.8387, -4.8812, -2.0606, -0.6440, -2.7886, -3.8168, -3.5880, -2.8806, -1.6361, 9.7960, -2.7486, -4.9867, -8.9295, -8.7417, -8.0122, -8.2336, -7.6245, -8.1614, -13.5915, -18.5381, -7.6446, -8.1150, -7.6146, -6.8296, -7.8200, -3.5770, -7.4692, -12.7706, -14.1110, -9.3544, -11.3765, -9.6116, -7.3213, -5.3043, -2.3873, 0.2479, -2.3155, -3.7254, -3.4302, -5.0659, -11.0175, -12.2443, -13.8466, -14.9527, -15.3033])
    (interactions): ModuleList(
      (0): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
        (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 512]
        (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e x 89x0e -> 128x0e+128x1o | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
      (1): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
        (conv_tp): TensorProduct(128x0e+128x1o x 1x0e+1x1o+1x2e+1x3o -> 256x0e+384x1o+384x2e+256x3o | 1280 paths | 1280 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1280]
        (linear): Linear(256x0e+384x1o+384x2e+256x3o -> 128x0e+128x1o+128x2e+128x3o | 163840 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o x 89x0e -> 128x0e+128x1o | 2916352 paths | 2916352 weights)
        (reshape): reshape_irreps()
      )
      (2): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
        (conv_tp): TensorProduct(128x0e+128x1o x 1x0e+1x1o+1x2e+1x3o -> 256x0e+384x1o+384x2e+256x3o | 1280 paths | 1280 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1280]
        (linear): Linear(256x0e+384x1o+384x2e+256x3o -> 128x0e+128x1o+128x2e+128x3o | 163840 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o x 89x0e -> 128x0e | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
    )
    (products): ModuleList(
      (0-1): 2 x EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
            (1): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x6x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
      )
      (2): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e -> 128x0e | 16384 weights)
      )
    )
    (readouts): ModuleList(
      (0-1): 2 x LinearReadoutBlock(
        (linear): Linear(128x0e+128x1o -> 1x0e | 128 weights)
      )
      (2): NonLinearReadoutBlock(
        (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
        (non_linearity): Activation [x] (16x0e -> 16x0e)
        (linear_2): Linear(16x0e -> 1x0e | 16 weights)
      )
    )
    (scale_shift): ScaleShiftBlock(scale=0.804340, shift=0.164779)
  )
)
2023-12-11 11:55:16.981 INFO: Number of parameters: 8904592
2023-12-11 11:55:16.981 INFO: Optimizer: AcceleratedOptimizer (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0008
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0008
    maximize: False
    name: interactions_decay
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0008
    maximize: False
    name: interactions_no_decay
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0008
    maximize: False
    name: products
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0008
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2023-12-11 11:55:16.981 INFO: Using gradient clipping with tolerance=10.000
2023-12-11 11:55:16.981 INFO: Started training
2023-12-11 11:55:18.949 INFO: Reducer buckets have been rebuilt in this iteration.
2023-12-11 11:55:18.950 INFO: Reducer buckets have been rebuilt in this iteration.
2023-12-11 11:55:18.950 INFO: Reducer buckets have been rebuilt in this iteration.
2023-12-11 11:55:18.950 INFO: Reducer buckets have been rebuilt in this iteration.
2023-12-11 13:54:17.077 INFO: Epoch 96: loss=0.0103, MAE_E_per_atom=14.2 meV, MAE_F=58.5 meV / A, MAE_S_per_atom=0.39835 meV / A^3
2023-12-11 13:54:17.080 INFO: Saving current state to data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-96
2023-12-11 13:54:17.241 INFO: Model weights saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-96/pytorch_model.bin
2023-12-11 13:54:17.556 INFO: Optimizer state saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-96/optimizer.bin
2023-12-11 13:54:17.560 INFO: Random states saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-96/random_states_0.pkl
2023-12-11 17:46:00.009 INFO: Epoch 98: loss=0.0062, MAE_E_per_atom=12.8 meV, MAE_F=56.3 meV / A, MAE_S_per_atom=0.15933 meV / A^3
2023-12-11 17:46:00.029 INFO: Saving current state to data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-98
2023-12-11 17:46:00.116 INFO: Model weights saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-98/pytorch_model.bin
2023-12-11 17:46:00.353 INFO: Optimizer state saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-98/optimizer.bin
2023-12-11 17:46:00.355 INFO: Random states saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-98/random_states_0.pkl
2023-12-11 19:39:50.068 INFO: Training complete
2023-12-11 19:39:50.069 INFO: Computing metrics for training, validation, and test sets
2023-12-11 19:39:50.069 INFO: Loading states from data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-98
2023-12-11 19:39:50.117 INFO: All model weights loaded successfully
2023-12-11 19:39:50.215 INFO: All optimizer states loaded successfully
2023-12-11 19:39:50.215 INFO: All scheduler states loaded successfully
2023-12-11 19:39:50.216 INFO: All random states loaded successfully
2023-12-11 19:39:50.216 INFO: Loading in 0 custom states
2023-12-11 19:39:50.216 INFO: Loaded model from epoch 98
2023-12-11 19:39:50.216 INFO: Evaluating train ...
2023-12-11 20:21:57.335 INFO: MACE version: 0.1.0
2023-12-11 20:21:57.336 INFO: Configuration: Namespace(name='MACE_MPtrj_2022.9', seed=42, log_dir='data-train-result-stress-128-inter3/logs', model_dir='data-train-result-stress-128-inter3', checkpoints_dir='data-train-result-stress-128-inter3/checkpoints', results_dir='data-train-result-stress-128-inter3/results', downloads_dir='data-train-result-stress-128-inter3/downloads', default_dtype='float64', log_level='INFO', error_table='PerAtomMAEstress', model='ScaleShiftMACE', r_max=5.0, num_radial_basis=8, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=3, MLP_irreps='16x0e', hidden_irreps='32x0e', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=True, compute_forces=True, train_file='./data-train-preprocessed/train.h5', valid_file='./data-train-preprocessed/valid.h5', valid_fraction=0.1, test_file=None, test_dir=None, num_workers=8, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file='./data-train-preprocessed/statistics.json', E0s=None, energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='stress-l1', forces_weight=1.0, swa_forces_weight=1.0, energy_weight=5.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=500.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=32, valid_batch_size=32, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=120, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=True, restart_lr=0.0008, save_cpu=True, clip_grad=10.0, wandb=False, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-12-11 20:21:57.336 INFO: Using statistics json file
2023-12-11 20:21:57.336 INFO: Using atomic numbers from statistics file
2023-12-11 20:21:57.336 INFO: AtomicNumberTable: (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 89, 90, 91, 92, 93, 94)
2023-12-11 20:21:57.336 INFO: Atomic Energies not in training file, using command line argument E0s
2023-12-11 20:21:57.337 INFO: Atomic energies: [-3.6673775936325184, -1.321978574671279, -3.47815910592578, -4.724966512505185, -7.727941403300326, -8.404543836565129, -7.359429774977432, -7.284436081345614, -4.896162007436489, -0.03005797428312995, -2.7527187727369, -2.8138258116559136, -4.844369939040846, -7.6966307568316115, -6.96321292174237, -4.673811566998673, -2.813984104722163, -0.06233472731112788, -2.6251773081704863, -5.384791381758609, -7.916197568907359, -10.270820955634214, -8.672390387555845, -9.2371580345617, -8.305620224433062, -7.054671703876374, -5.570915377375696, -5.174147851464132, -3.251035550574451, -1.2879654275024013, -3.5321835252059812, -4.711328365973749, -3.9717755452456673, -3.886221455984922, -2.5183143168985502, 6.706842222672468, -2.566057480857263, -4.938993788294903, -10.153603816562159, -11.857062150232505, -12.14164656151253, -8.786094380920531, -8.795434431218645, -7.778351502991773, -6.838726494373795, -4.881216430056056, -2.0605586704343675, -0.6439905162993389, -2.788575343692543, -3.816810475940441, -3.587983770584603, -2.8805917608627976, -1.6360524330360255, 9.796001071919388, -2.7486371263604354, -4.986670776340143, -8.929476698318382, -8.74170685282431, -8.01217127881877, -8.233598378021814, -7.62454389634746, -8.161368139142393, -13.591451290378114, -18.538136714242995, -7.644552511106582, -8.115049752450005, -7.614570319217799, -6.82962645334957, -7.820026786949461, -3.5770491745130024, -7.469205400904766, -12.770648602823787, -14.110986902146283, -9.354405708044254, -11.376459286198285, -9.611613368883013, -7.321263077561875, -5.304305597659051, -2.3873175082519373, 0.24792131307789267, -2.31553585581406, -3.7254481655069127, -3.4301772252097935, -5.065907805804548, -11.017529306980132, -12.244262478240024, -13.846602972246156, -14.952721865054968, -15.303292182007306]
2023-12-11 20:21:57.391 INFO: WeightedEnergyForcesStressLossL1(energy_weight=5.000, forces_weight=1.000, stress_weight=500.000)
2023-12-11 20:21:57.392 INFO: Average number of neighbors: 25.57754135131836
2023-12-11 20:21:57.392 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': True, 'dipoles': False}
2023-12-11 20:21:57.392 INFO: Building model
2023-12-11 20:21:57.392 INFO: Hidden irreps: 128x0e + 128x1o
2023-12-11 20:22:01.679 INFO: Loading states from data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-98
2023-12-11 20:22:01.732 INFO: All model weights loaded successfully
2023-12-11 20:22:01.850 INFO: All optimizer states loaded successfully
2023-12-11 20:22:01.850 INFO: All scheduler states loaded successfully
2023-12-11 20:22:01.854 INFO: All random states loaded successfully
2023-12-11 20:22:01.854 INFO: Loading in 0 custom states
2023-12-11 20:22:01.856 INFO: DistributedDataParallel(
  (module): ScaleShiftMACE(
    (node_embedding): LinearNodeEmbeddingBlock(
      (linear): Linear(89x0e -> 128x0e | 11392 weights)
    )
    (radial_embedding): RadialEmbeddingBlock(
      (bessel_fn): BesselBasis(r_max=4.5, num_basis=8, trainable=False)
      (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
    )
    (spherical_harmonics): SphericalHarmonics()
    (atomic_energies_fn): AtomicEnergiesBlock(energies=[-3.6674, -1.3220, -3.4782, -4.7250, -7.7279, -8.4045, -7.3594, -7.2844, -4.8962, -0.0301, -2.7527, -2.8138, -4.8444, -7.6966, -6.9632, -4.6738, -2.8140, -0.0623, -2.6252, -5.3848, -7.9162, -10.2708, -8.6724, -9.2372, -8.3056, -7.0547, -5.5709, -5.1741, -3.2510, -1.2880, -3.5322, -4.7113, -3.9718, -3.8862, -2.5183, 6.7068, -2.5661, -4.9390, -10.1536, -11.8571, -12.1416, -8.7861, -8.7954, -7.7784, -6.8387, -4.8812, -2.0606, -0.6440, -2.7886, -3.8168, -3.5880, -2.8806, -1.6361, 9.7960, -2.7486, -4.9867, -8.9295, -8.7417, -8.0122, -8.2336, -7.6245, -8.1614, -13.5915, -18.5381, -7.6446, -8.1150, -7.6146, -6.8296, -7.8200, -3.5770, -7.4692, -12.7706, -14.1110, -9.3544, -11.3765, -9.6116, -7.3213, -5.3043, -2.3873, 0.2479, -2.3155, -3.7254, -3.4302, -5.0659, -11.0175, -12.2443, -13.8466, -14.9527, -15.3033])
    (interactions): ModuleList(
      (0): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
        (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 512]
        (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e x 89x0e -> 128x0e+128x1o | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
      (1): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
        (conv_tp): TensorProduct(128x0e+128x1o x 1x0e+1x1o+1x2e+1x3o -> 256x0e+384x1o+384x2e+256x3o | 1280 paths | 1280 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1280]
        (linear): Linear(256x0e+384x1o+384x2e+256x3o -> 128x0e+128x1o+128x2e+128x3o | 163840 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o x 89x0e -> 128x0e+128x1o | 2916352 paths | 2916352 weights)
        (reshape): reshape_irreps()
      )
      (2): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
        (conv_tp): TensorProduct(128x0e+128x1o x 1x0e+1x1o+1x2e+1x3o -> 256x0e+384x1o+384x2e+256x3o | 1280 paths | 1280 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1280]
        (linear): Linear(256x0e+384x1o+384x2e+256x3o -> 128x0e+128x1o+128x2e+128x3o | 163840 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o x 89x0e -> 128x0e | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
    )
    (products): ModuleList(
      (0-1): 2 x EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
            (1): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x6x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
      )
      (2): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e -> 128x0e | 16384 weights)
      )
    )
    (readouts): ModuleList(
      (0-1): 2 x LinearReadoutBlock(
        (linear): Linear(128x0e+128x1o -> 1x0e | 128 weights)
      )
      (2): NonLinearReadoutBlock(
        (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
        (non_linearity): Activation [x] (16x0e -> 16x0e)
        (linear_2): Linear(16x0e -> 1x0e | 16 weights)
      )
    )
    (scale_shift): ScaleShiftBlock(scale=0.804340, shift=0.164779)
  )
)
2023-12-11 20:22:01.861 INFO: Number of parameters: 8904592
2023-12-11 20:22:01.861 INFO: Optimizer: AcceleratedOptimizer (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0008
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0008
    maximize: False
    name: interactions_decay
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0008
    maximize: False
    name: interactions_no_decay
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0008
    maximize: False
    name: products
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0008
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2023-12-11 20:22:01.861 INFO: Using gradient clipping with tolerance=10.000
2023-12-11 20:22:01.861 INFO: Started training
2023-12-11 20:22:03.879 INFO: Reducer buckets have been rebuilt in this iteration.
2023-12-11 20:22:03.879 INFO: Reducer buckets have been rebuilt in this iteration.
2023-12-11 20:22:03.880 INFO: Reducer buckets have been rebuilt in this iteration.
2023-12-11 20:22:03.880 INFO: Reducer buckets have been rebuilt in this iteration.
2023-12-11 22:20:18.933 INFO: Epoch 98: loss=0.0062, MAE_E_per_atom=12.6 meV, MAE_F=56.2 meV / A, MAE_S_per_atom=0.16154 meV / A^3
2023-12-11 22:20:18.935 INFO: Saving current state to data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-98
2023-12-11 22:20:19.066 INFO: Model weights saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-98/pytorch_model.bin
2023-12-11 22:20:19.377 INFO: Optimizer state saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-98/optimizer.bin
2023-12-11 22:20:19.379 INFO: Random states saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-98/random_states_0.pkl
2023-12-12 02:10:34.233 INFO: Epoch 100: loss=0.0061, MAE_E_per_atom=12.3 meV, MAE_F=56.0 meV / A, MAE_S_per_atom=0.15790 meV / A^3
2023-12-12 02:10:34.254 INFO: Saving current state to data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-100
2023-12-12 02:10:34.333 INFO: Model weights saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-100/pytorch_model.bin
2023-12-12 02:10:34.503 INFO: Optimizer state saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-100/optimizer.bin
2023-12-12 02:10:34.504 INFO: Random states saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-100/random_states_0.pkl
2023-12-12 06:08:57.493 INFO: Epoch 102: loss=0.0108, MAE_E_per_atom=12.3 meV, MAE_F=55.8 meV / A, MAE_S_per_atom=0.45900 meV / A^3
2023-12-12 10:21:32.334 INFO: Epoch 104: loss=0.0060, MAE_E_per_atom=12.0 meV, MAE_F=55.5 meV / A, MAE_S_per_atom=0.15115 meV / A^3
2023-12-12 10:21:32.355 INFO: Saving current state to data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-104
2023-12-12 10:21:32.438 INFO: Model weights saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-104/pytorch_model.bin
2023-12-12 10:21:32.662 INFO: Optimizer state saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-104/optimizer.bin
2023-12-12 10:21:32.664 INFO: Random states saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-104/random_states_0.pkl
2023-12-12 10:30:12.470 INFO: MACE version: 0.1.0
2023-12-12 10:30:12.470 INFO: Configuration: Namespace(name='MACE_MPtrj_2022.9', seed=42, log_dir='data-train-result-stress-128-inter3/logs', model_dir='data-train-result-stress-128-inter3', checkpoints_dir='data-train-result-stress-128-inter3/checkpoints', results_dir='data-train-result-stress-128-inter3/results', downloads_dir='data-train-result-stress-128-inter3/downloads', default_dtype='float64', log_level='INFO', error_table='PerAtomMAEstress', model='ScaleShiftMACE', r_max=5.0, num_radial_basis=8, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=3, MLP_irreps='16x0e', hidden_irreps='32x0e', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=True, compute_forces=True, train_file='./data-train-preprocessed/train.h5', valid_file='./data-train-preprocessed/valid.h5', valid_fraction=0.1, test_file=None, test_dir=None, num_workers=8, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file='./data-train-preprocessed/statistics.json', E0s=None, energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='stress-l1', forces_weight=1.0, swa_forces_weight=1.0, energy_weight=5.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=500.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=32, valid_batch_size=32, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=120, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=True, restart_lr=0.0001, save_cpu=True, clip_grad=10.0, wandb=False, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-12-12 10:30:12.470 INFO: Using statistics json file
2023-12-12 10:30:12.470 INFO: Using atomic numbers from statistics file
2023-12-12 10:30:12.471 INFO: AtomicNumberTable: (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 89, 90, 91, 92, 93, 94)
2023-12-12 10:30:12.471 INFO: Atomic Energies not in training file, using command line argument E0s
2023-12-12 10:30:12.471 INFO: Atomic energies: [-3.6673775936325184, -1.321978574671279, -3.47815910592578, -4.724966512505185, -7.727941403300326, -8.404543836565129, -7.359429774977432, -7.284436081345614, -4.896162007436489, -0.03005797428312995, -2.7527187727369, -2.8138258116559136, -4.844369939040846, -7.6966307568316115, -6.96321292174237, -4.673811566998673, -2.813984104722163, -0.06233472731112788, -2.6251773081704863, -5.384791381758609, -7.916197568907359, -10.270820955634214, -8.672390387555845, -9.2371580345617, -8.305620224433062, -7.054671703876374, -5.570915377375696, -5.174147851464132, -3.251035550574451, -1.2879654275024013, -3.5321835252059812, -4.711328365973749, -3.9717755452456673, -3.886221455984922, -2.5183143168985502, 6.706842222672468, -2.566057480857263, -4.938993788294903, -10.153603816562159, -11.857062150232505, -12.14164656151253, -8.786094380920531, -8.795434431218645, -7.778351502991773, -6.838726494373795, -4.881216430056056, -2.0605586704343675, -0.6439905162993389, -2.788575343692543, -3.816810475940441, -3.587983770584603, -2.8805917608627976, -1.6360524330360255, 9.796001071919388, -2.7486371263604354, -4.986670776340143, -8.929476698318382, -8.74170685282431, -8.01217127881877, -8.233598378021814, -7.62454389634746, -8.161368139142393, -13.591451290378114, -18.538136714242995, -7.644552511106582, -8.115049752450005, -7.614570319217799, -6.82962645334957, -7.820026786949461, -3.5770491745130024, -7.469205400904766, -12.770648602823787, -14.110986902146283, -9.354405708044254, -11.376459286198285, -9.611613368883013, -7.321263077561875, -5.304305597659051, -2.3873175082519373, 0.24792131307789267, -2.31553585581406, -3.7254481655069127, -3.4301772252097935, -5.065907805804548, -11.017529306980132, -12.244262478240024, -13.846602972246156, -14.952721865054968, -15.303292182007306]
2023-12-12 10:30:12.532 INFO: WeightedEnergyForcesStressLossL1(energy_weight=5.000, forces_weight=1.000, stress_weight=500.000)
2023-12-12 10:30:12.533 INFO: Average number of neighbors: 25.57754135131836
2023-12-12 10:30:12.533 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': True, 'dipoles': False}
2023-12-12 10:30:12.533 INFO: Building model
2023-12-12 10:30:12.533 INFO: Hidden irreps: 128x0e + 128x1o
2023-12-12 10:30:16.603 INFO: Loading states from data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-104
2023-12-12 10:30:16.659 INFO: All model weights loaded successfully
2023-12-12 10:30:16.761 INFO: All optimizer states loaded successfully
2023-12-12 10:30:16.761 INFO: All scheduler states loaded successfully
2023-12-12 10:30:16.765 INFO: All random states loaded successfully
2023-12-12 10:30:16.765 INFO: Loading in 0 custom states
2023-12-12 10:30:16.767 INFO: DistributedDataParallel(
  (module): ScaleShiftMACE(
    (node_embedding): LinearNodeEmbeddingBlock(
      (linear): Linear(89x0e -> 128x0e | 11392 weights)
    )
    (radial_embedding): RadialEmbeddingBlock(
      (bessel_fn): BesselBasis(r_max=4.5, num_basis=8, trainable=False)
      (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
    )
    (spherical_harmonics): SphericalHarmonics()
    (atomic_energies_fn): AtomicEnergiesBlock(energies=[-3.6674, -1.3220, -3.4782, -4.7250, -7.7279, -8.4045, -7.3594, -7.2844, -4.8962, -0.0301, -2.7527, -2.8138, -4.8444, -7.6966, -6.9632, -4.6738, -2.8140, -0.0623, -2.6252, -5.3848, -7.9162, -10.2708, -8.6724, -9.2372, -8.3056, -7.0547, -5.5709, -5.1741, -3.2510, -1.2880, -3.5322, -4.7113, -3.9718, -3.8862, -2.5183, 6.7068, -2.5661, -4.9390, -10.1536, -11.8571, -12.1416, -8.7861, -8.7954, -7.7784, -6.8387, -4.8812, -2.0606, -0.6440, -2.7886, -3.8168, -3.5880, -2.8806, -1.6361, 9.7960, -2.7486, -4.9867, -8.9295, -8.7417, -8.0122, -8.2336, -7.6245, -8.1614, -13.5915, -18.5381, -7.6446, -8.1150, -7.6146, -6.8296, -7.8200, -3.5770, -7.4692, -12.7706, -14.1110, -9.3544, -11.3765, -9.6116, -7.3213, -5.3043, -2.3873, 0.2479, -2.3155, -3.7254, -3.4302, -5.0659, -11.0175, -12.2443, -13.8466, -14.9527, -15.3033])
    (interactions): ModuleList(
      (0): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
        (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 512]
        (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e x 89x0e -> 128x0e+128x1o | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
      (1): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
        (conv_tp): TensorProduct(128x0e+128x1o x 1x0e+1x1o+1x2e+1x3o -> 256x0e+384x1o+384x2e+256x3o | 1280 paths | 1280 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1280]
        (linear): Linear(256x0e+384x1o+384x2e+256x3o -> 128x0e+128x1o+128x2e+128x3o | 163840 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o x 89x0e -> 128x0e+128x1o | 2916352 paths | 2916352 weights)
        (reshape): reshape_irreps()
      )
      (2): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
        (conv_tp): TensorProduct(128x0e+128x1o x 1x0e+1x1o+1x2e+1x3o -> 256x0e+384x1o+384x2e+256x3o | 1280 paths | 1280 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1280]
        (linear): Linear(256x0e+384x1o+384x2e+256x3o -> 128x0e+128x1o+128x2e+128x3o | 163840 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o x 89x0e -> 128x0e | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
    )
    (products): ModuleList(
      (0-1): 2 x EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
            (1): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x6x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
      )
      (2): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e -> 128x0e | 16384 weights)
      )
    )
    (readouts): ModuleList(
      (0-1): 2 x LinearReadoutBlock(
        (linear): Linear(128x0e+128x1o -> 1x0e | 128 weights)
      )
      (2): NonLinearReadoutBlock(
        (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
        (non_linearity): Activation [x] (16x0e -> 16x0e)
        (linear_2): Linear(16x0e -> 1x0e | 16 weights)
      )
    )
    (scale_shift): ScaleShiftBlock(scale=0.804340, shift=0.164779)
  )
)
2023-12-12 10:30:16.772 INFO: Number of parameters: 8904592
2023-12-12 10:30:16.772 INFO: Optimizer: AcceleratedOptimizer (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0001
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0001
    maximize: False
    name: interactions_decay
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0001
    maximize: False
    name: interactions_no_decay
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0001
    maximize: False
    name: products
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0001
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2023-12-12 10:30:16.772 INFO: Using gradient clipping with tolerance=10.000
2023-12-12 10:30:16.772 INFO: Started training
2023-12-12 10:30:18.855 INFO: Reducer buckets have been rebuilt in this iteration.
2023-12-12 10:30:18.856 INFO: Reducer buckets have been rebuilt in this iteration.
2023-12-12 10:30:18.856 INFO: Reducer buckets have been rebuilt in this iteration.
2023-12-12 10:30:18.856 INFO: Reducer buckets have been rebuilt in this iteration.
2023-12-12 12:29:38.099 INFO: Epoch 104: loss=0.0056, MAE_E_per_atom=10.7 meV, MAE_F=54.4 meV / A, MAE_S_per_atom=0.14213 meV / A^3
2023-12-12 12:29:38.102 INFO: Saving current state to data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-104
2023-12-12 12:29:38.240 INFO: Model weights saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-104/pytorch_model.bin
2023-12-12 12:29:38.560 INFO: Optimizer state saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-104/optimizer.bin
2023-12-12 12:29:38.564 INFO: Random states saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-104/random_states_0.pkl
2023-12-12 16:23:01.439 INFO: Epoch 106: loss=0.0055, MAE_E_per_atom=10.5 meV, MAE_F=54.4 meV / A, MAE_S_per_atom=0.14098 meV / A^3
2023-12-12 16:23:01.465 INFO: Saving current state to data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-106
2023-12-12 16:23:01.549 INFO: Model weights saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-106/pytorch_model.bin
2023-12-12 16:23:01.714 INFO: Optimizer state saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-106/optimizer.bin
2023-12-12 16:23:01.715 INFO: Random states saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-106/random_states_0.pkl
2023-12-12 20:23:43.803 INFO: Epoch 108: loss=0.0055, MAE_E_per_atom=10.4 meV, MAE_F=54.4 meV / A, MAE_S_per_atom=0.14108 meV / A^3
2023-12-12 20:23:43.824 INFO: Saving current state to data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-108
2023-12-12 20:23:43.907 INFO: Model weights saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-108/pytorch_model.bin
2023-12-12 20:23:44.075 INFO: Optimizer state saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-108/optimizer.bin
2023-12-12 20:23:44.076 INFO: Random states saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-108/random_states_0.pkl
2023-12-12 20:27:25.413 INFO: MACE version: 0.1.0
2023-12-12 20:27:25.413 INFO: Configuration: Namespace(name='MACE_MPtrj_2022.9', seed=42, log_dir='data-train-result-stress-128-inter3/logs', model_dir='data-train-result-stress-128-inter3', checkpoints_dir='data-train-result-stress-128-inter3/checkpoints', results_dir='data-train-result-stress-128-inter3/results', downloads_dir='data-train-result-stress-128-inter3/downloads', default_dtype='float64', log_level='INFO', error_table='PerAtomMAEstress', model='ScaleShiftMACE', r_max=5.0, num_radial_basis=8, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=3, MLP_irreps='16x0e', hidden_irreps='32x0e', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=True, compute_forces=True, train_file='./data-train-preprocessed/train.h5', valid_file='./data-train-preprocessed/valid.h5', valid_fraction=0.1, test_file=None, test_dir=None, num_workers=8, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file='./data-train-preprocessed/statistics.json', E0s=None, energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='stress-l1', forces_weight=1.0, swa_forces_weight=1.0, energy_weight=5.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=500.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=32, valid_batch_size=32, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=116, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=True, restart_lr=8e-05, save_cpu=True, clip_grad=10.0, wandb=False, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-12-12 20:27:25.413 INFO: Using statistics json file
2023-12-12 20:27:25.413 INFO: Using atomic numbers from statistics file
2023-12-12 20:27:25.414 INFO: AtomicNumberTable: (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 89, 90, 91, 92, 93, 94)
2023-12-12 20:27:25.414 INFO: Atomic Energies not in training file, using command line argument E0s
2023-12-12 20:27:25.414 INFO: Atomic energies: [-3.6673775936325184, -1.321978574671279, -3.47815910592578, -4.724966512505185, -7.727941403300326, -8.404543836565129, -7.359429774977432, -7.284436081345614, -4.896162007436489, -0.03005797428312995, -2.7527187727369, -2.8138258116559136, -4.844369939040846, -7.6966307568316115, -6.96321292174237, -4.673811566998673, -2.813984104722163, -0.06233472731112788, -2.6251773081704863, -5.384791381758609, -7.916197568907359, -10.270820955634214, -8.672390387555845, -9.2371580345617, -8.305620224433062, -7.054671703876374, -5.570915377375696, -5.174147851464132, -3.251035550574451, -1.2879654275024013, -3.5321835252059812, -4.711328365973749, -3.9717755452456673, -3.886221455984922, -2.5183143168985502, 6.706842222672468, -2.566057480857263, -4.938993788294903, -10.153603816562159, -11.857062150232505, -12.14164656151253, -8.786094380920531, -8.795434431218645, -7.778351502991773, -6.838726494373795, -4.881216430056056, -2.0605586704343675, -0.6439905162993389, -2.788575343692543, -3.816810475940441, -3.587983770584603, -2.8805917608627976, -1.6360524330360255, 9.796001071919388, -2.7486371263604354, -4.986670776340143, -8.929476698318382, -8.74170685282431, -8.01217127881877, -8.233598378021814, -7.62454389634746, -8.161368139142393, -13.591451290378114, -18.538136714242995, -7.644552511106582, -8.115049752450005, -7.614570319217799, -6.82962645334957, -7.820026786949461, -3.5770491745130024, -7.469205400904766, -12.770648602823787, -14.110986902146283, -9.354405708044254, -11.376459286198285, -9.611613368883013, -7.321263077561875, -5.304305597659051, -2.3873175082519373, 0.24792131307789267, -2.31553585581406, -3.7254481655069127, -3.4301772252097935, -5.065907805804548, -11.017529306980132, -12.244262478240024, -13.846602972246156, -14.952721865054968, -15.303292182007306]
2023-12-12 20:27:25.464 INFO: WeightedEnergyForcesStressLossL1(energy_weight=5.000, forces_weight=1.000, stress_weight=500.000)
2023-12-12 20:27:25.464 INFO: Average number of neighbors: 25.57754135131836
2023-12-12 20:27:25.465 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': True, 'dipoles': False}
2023-12-12 20:27:25.465 INFO: Building model
2023-12-12 20:27:25.465 INFO: Hidden irreps: 128x0e + 128x1o
2023-12-12 20:27:29.542 INFO: Loading states from data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-108
2023-12-12 20:27:29.599 INFO: All model weights loaded successfully
2023-12-12 20:27:29.724 INFO: All optimizer states loaded successfully
2023-12-12 20:27:29.724 INFO: All scheduler states loaded successfully
2023-12-12 20:27:29.728 INFO: All random states loaded successfully
2023-12-12 20:27:29.728 INFO: Loading in 0 custom states
2023-12-12 20:27:29.729 INFO: DistributedDataParallel(
  (module): ScaleShiftMACE(
    (node_embedding): LinearNodeEmbeddingBlock(
      (linear): Linear(89x0e -> 128x0e | 11392 weights)
    )
    (radial_embedding): RadialEmbeddingBlock(
      (bessel_fn): BesselBasis(r_max=4.5, num_basis=8, trainable=False)
      (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
    )
    (spherical_harmonics): SphericalHarmonics()
    (atomic_energies_fn): AtomicEnergiesBlock(energies=[-3.6674, -1.3220, -3.4782, -4.7250, -7.7279, -8.4045, -7.3594, -7.2844, -4.8962, -0.0301, -2.7527, -2.8138, -4.8444, -7.6966, -6.9632, -4.6738, -2.8140, -0.0623, -2.6252, -5.3848, -7.9162, -10.2708, -8.6724, -9.2372, -8.3056, -7.0547, -5.5709, -5.1741, -3.2510, -1.2880, -3.5322, -4.7113, -3.9718, -3.8862, -2.5183, 6.7068, -2.5661, -4.9390, -10.1536, -11.8571, -12.1416, -8.7861, -8.7954, -7.7784, -6.8387, -4.8812, -2.0606, -0.6440, -2.7886, -3.8168, -3.5880, -2.8806, -1.6361, 9.7960, -2.7486, -4.9867, -8.9295, -8.7417, -8.0122, -8.2336, -7.6245, -8.1614, -13.5915, -18.5381, -7.6446, -8.1150, -7.6146, -6.8296, -7.8200, -3.5770, -7.4692, -12.7706, -14.1110, -9.3544, -11.3765, -9.6116, -7.3213, -5.3043, -2.3873, 0.2479, -2.3155, -3.7254, -3.4302, -5.0659, -11.0175, -12.2443, -13.8466, -14.9527, -15.3033])
    (interactions): ModuleList(
      (0): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
        (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 512]
        (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e x 89x0e -> 128x0e+128x1o | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
      (1): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
        (conv_tp): TensorProduct(128x0e+128x1o x 1x0e+1x1o+1x2e+1x3o -> 256x0e+384x1o+384x2e+256x3o | 1280 paths | 1280 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1280]
        (linear): Linear(256x0e+384x1o+384x2e+256x3o -> 128x0e+128x1o+128x2e+128x3o | 163840 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o x 89x0e -> 128x0e+128x1o | 2916352 paths | 2916352 weights)
        (reshape): reshape_irreps()
      )
      (2): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
        (conv_tp): TensorProduct(128x0e+128x1o x 1x0e+1x1o+1x2e+1x3o -> 256x0e+384x1o+384x2e+256x3o | 1280 paths | 1280 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1280]
        (linear): Linear(256x0e+384x1o+384x2e+256x3o -> 128x0e+128x1o+128x2e+128x3o | 163840 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o x 89x0e -> 128x0e | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
    )
    (products): ModuleList(
      (0-1): 2 x EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
            (1): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x6x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
      )
      (2): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e -> 128x0e | 16384 weights)
      )
    )
    (readouts): ModuleList(
      (0-1): 2 x LinearReadoutBlock(
        (linear): Linear(128x0e+128x1o -> 1x0e | 128 weights)
      )
      (2): NonLinearReadoutBlock(
        (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
        (non_linearity): Activation [x] (16x0e -> 16x0e)
        (linear_2): Linear(16x0e -> 1x0e | 16 weights)
      )
    )
    (scale_shift): ScaleShiftBlock(scale=0.804340, shift=0.164779)
  )
)
2023-12-12 20:27:29.735 INFO: Number of parameters: 8904592
2023-12-12 20:27:29.735 INFO: Optimizer: AcceleratedOptimizer (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 8e-05
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 8e-05
    maximize: False
    name: interactions_decay
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 8e-05
    maximize: False
    name: interactions_no_decay
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 8e-05
    maximize: False
    name: products
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 8e-05
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2023-12-12 20:27:29.735 INFO: Using gradient clipping with tolerance=10.000
2023-12-12 20:27:29.735 INFO: Started training
2023-12-12 20:27:31.733 INFO: Reducer buckets have been rebuilt in this iteration.
2023-12-12 20:27:31.733 INFO: Reducer buckets have been rebuilt in this iteration.
2023-12-12 20:27:31.733 INFO: Reducer buckets have been rebuilt in this iteration.
2023-12-12 20:27:31.733 INFO: Reducer buckets have been rebuilt in this iteration.
2023-12-12 22:26:19.365 INFO: Epoch 108: loss=0.0055, MAE_E_per_atom=10.3 meV, MAE_F=54.4 meV / A, MAE_S_per_atom=0.14103 meV / A^3
2023-12-12 22:26:19.368 INFO: Saving current state to data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-108
2023-12-12 22:26:19.513 INFO: Model weights saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-108/pytorch_model.bin
2023-12-12 22:26:19.874 INFO: Optimizer state saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-108/optimizer.bin
2023-12-12 22:26:19.876 INFO: Random states saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-108/random_states_0.pkl
2023-12-13 02:17:57.299 INFO: Epoch 110: loss=0.0055, MAE_E_per_atom=10.3 meV, MAE_F=54.5 meV / A, MAE_S_per_atom=0.14122 meV / A^3
2023-12-13 02:17:57.322 INFO: Saving current state to data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-110
2023-12-13 02:17:57.408 INFO: Model weights saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-110/pytorch_model.bin
2023-12-13 02:17:57.582 INFO: Optimizer state saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-110/optimizer.bin
2023-12-13 02:17:57.583 INFO: Random states saved in data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-110/random_states_0.pkl
2023-12-13 06:17:36.370 INFO: Epoch 112: loss=0.0055, MAE_E_per_atom=10.2 meV, MAE_F=54.6 meV / A, MAE_S_per_atom=0.14259 meV / A^3
2023-12-13 08:49:22.448 INFO: MACE version: 0.1.0
2023-12-13 08:49:22.448 INFO: Configuration: Namespace(name='MACE_MPtrj_2022.9', seed=42, log_dir='data-train-result-stress-128-inter3/logs', model_dir='data-train-result-stress-128-inter3', checkpoints_dir='data-train-result-stress-128-inter3/checkpoints', results_dir='data-train-result-stress-128-inter3/results', downloads_dir='data-train-result-stress-128-inter3/downloads', default_dtype='float64', log_level='INFO', error_table='PerAtomMAEstress', model='ScaleShiftMACE', r_max=5.0, num_radial_basis=8, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=3, MLP_irreps='16x0e', hidden_irreps='32x0e', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=True, compute_forces=True, train_file='./data-train-preprocessed/train.h5', valid_file='./data-train-preprocessed/valid.h5', valid_fraction=0.1, test_file=None, test_dir=None, num_workers=8, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file='./data-train-preprocessed/statistics.json', E0s=None, energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='stress-l1', forces_weight=1.0, swa_forces_weight=1.0, energy_weight=5.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=500.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=32, valid_batch_size=32, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=110, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=True, restart_lr=8e-05, save_cpu=True, clip_grad=10.0, wandb=False, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-12-13 08:49:22.448 INFO: Using statistics json file
2023-12-13 08:49:22.448 INFO: Using atomic numbers from statistics file
2023-12-13 08:49:22.449 INFO: AtomicNumberTable: (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 89, 90, 91, 92, 93, 94)
2023-12-13 08:49:22.449 INFO: Atomic Energies not in training file, using command line argument E0s
2023-12-13 08:49:22.450 INFO: Atomic energies: [-3.6673775936325184, -1.321978574671279, -3.47815910592578, -4.724966512505185, -7.727941403300326, -8.404543836565129, -7.359429774977432, -7.284436081345614, -4.896162007436489, -0.03005797428312995, -2.7527187727369, -2.8138258116559136, -4.844369939040846, -7.6966307568316115, -6.96321292174237, -4.673811566998673, -2.813984104722163, -0.06233472731112788, -2.6251773081704863, -5.384791381758609, -7.916197568907359, -10.270820955634214, -8.672390387555845, -9.2371580345617, -8.305620224433062, -7.054671703876374, -5.570915377375696, -5.174147851464132, -3.251035550574451, -1.2879654275024013, -3.5321835252059812, -4.711328365973749, -3.9717755452456673, -3.886221455984922, -2.5183143168985502, 6.706842222672468, -2.566057480857263, -4.938993788294903, -10.153603816562159, -11.857062150232505, -12.14164656151253, -8.786094380920531, -8.795434431218645, -7.778351502991773, -6.838726494373795, -4.881216430056056, -2.0605586704343675, -0.6439905162993389, -2.788575343692543, -3.816810475940441, -3.587983770584603, -2.8805917608627976, -1.6360524330360255, 9.796001071919388, -2.7486371263604354, -4.986670776340143, -8.929476698318382, -8.74170685282431, -8.01217127881877, -8.233598378021814, -7.62454389634746, -8.161368139142393, -13.591451290378114, -18.538136714242995, -7.644552511106582, -8.115049752450005, -7.614570319217799, -6.82962645334957, -7.820026786949461, -3.5770491745130024, -7.469205400904766, -12.770648602823787, -14.110986902146283, -9.354405708044254, -11.376459286198285, -9.611613368883013, -7.321263077561875, -5.304305597659051, -2.3873175082519373, 0.24792131307789267, -2.31553585581406, -3.7254481655069127, -3.4301772252097935, -5.065907805804548, -11.017529306980132, -12.244262478240024, -13.846602972246156, -14.952721865054968, -15.303292182007306]
2023-12-13 08:49:22.503 INFO: WeightedEnergyForcesStressLossL1(energy_weight=5.000, forces_weight=1.000, stress_weight=500.000)
2023-12-13 08:49:22.503 INFO: Average number of neighbors: 25.57754135131836
2023-12-13 08:49:22.503 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': True, 'dipoles': False}
2023-12-13 08:49:22.503 INFO: Building model
2023-12-13 08:49:22.504 INFO: Hidden irreps: 128x0e + 128x1o
2023-12-13 08:49:26.459 INFO: Loading states from data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-110
2023-12-13 08:49:26.520 INFO: All model weights loaded successfully
2023-12-13 08:49:26.644 INFO: All optimizer states loaded successfully
2023-12-13 08:49:26.644 INFO: All scheduler states loaded successfully
2023-12-13 08:49:26.646 INFO: All random states loaded successfully
2023-12-13 08:49:26.647 INFO: Loading in 0 custom states
2023-12-13 08:49:26.648 INFO: DistributedDataParallel(
  (module): ScaleShiftMACE(
    (node_embedding): LinearNodeEmbeddingBlock(
      (linear): Linear(89x0e -> 128x0e | 11392 weights)
    )
    (radial_embedding): RadialEmbeddingBlock(
      (bessel_fn): BesselBasis(r_max=4.5, num_basis=8, trainable=False)
      (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
    )
    (spherical_harmonics): SphericalHarmonics()
    (atomic_energies_fn): AtomicEnergiesBlock(energies=[-3.6674, -1.3220, -3.4782, -4.7250, -7.7279, -8.4045, -7.3594, -7.2844, -4.8962, -0.0301, -2.7527, -2.8138, -4.8444, -7.6966, -6.9632, -4.6738, -2.8140, -0.0623, -2.6252, -5.3848, -7.9162, -10.2708, -8.6724, -9.2372, -8.3056, -7.0547, -5.5709, -5.1741, -3.2510, -1.2880, -3.5322, -4.7113, -3.9718, -3.8862, -2.5183, 6.7068, -2.5661, -4.9390, -10.1536, -11.8571, -12.1416, -8.7861, -8.7954, -7.7784, -6.8387, -4.8812, -2.0606, -0.6440, -2.7886, -3.8168, -3.5880, -2.8806, -1.6361, 9.7960, -2.7486, -4.9867, -8.9295, -8.7417, -8.0122, -8.2336, -7.6245, -8.1614, -13.5915, -18.5381, -7.6446, -8.1150, -7.6146, -6.8296, -7.8200, -3.5770, -7.4692, -12.7706, -14.1110, -9.3544, -11.3765, -9.6116, -7.3213, -5.3043, -2.3873, 0.2479, -2.3155, -3.7254, -3.4302, -5.0659, -11.0175, -12.2443, -13.8466, -14.9527, -15.3033])
    (interactions): ModuleList(
      (0): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
        (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 512]
        (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e x 89x0e -> 128x0e+128x1o | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
      (1): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
        (conv_tp): TensorProduct(128x0e+128x1o x 1x0e+1x1o+1x2e+1x3o -> 256x0e+384x1o+384x2e+256x3o | 1280 paths | 1280 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1280]
        (linear): Linear(256x0e+384x1o+384x2e+256x3o -> 128x0e+128x1o+128x2e+128x3o | 163840 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o x 89x0e -> 128x0e+128x1o | 2916352 paths | 2916352 weights)
        (reshape): reshape_irreps()
      )
      (2): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
        (conv_tp): TensorProduct(128x0e+128x1o x 1x0e+1x1o+1x2e+1x3o -> 256x0e+384x1o+384x2e+256x3o | 1280 paths | 1280 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1280]
        (linear): Linear(256x0e+384x1o+384x2e+256x3o -> 128x0e+128x1o+128x2e+128x3o | 163840 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o x 89x0e -> 128x0e | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
    )
    (products): ModuleList(
      (0-1): 2 x EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
            (1): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x6x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
      )
      (2): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e -> 128x0e | 16384 weights)
      )
    )
    (readouts): ModuleList(
      (0-1): 2 x LinearReadoutBlock(
        (linear): Linear(128x0e+128x1o -> 1x0e | 128 weights)
      )
      (2): NonLinearReadoutBlock(
        (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
        (non_linearity): Activation [x] (16x0e -> 16x0e)
        (linear_2): Linear(16x0e -> 1x0e | 16 weights)
      )
    )
    (scale_shift): ScaleShiftBlock(scale=0.804340, shift=0.164779)
  )
)
2023-12-13 08:49:26.652 INFO: Number of parameters: 8904592
2023-12-13 08:49:26.652 INFO: Optimizer: AcceleratedOptimizer (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 8e-05
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 8e-05
    maximize: False
    name: interactions_decay
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 8e-05
    maximize: False
    name: interactions_no_decay
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 8e-05
    maximize: False
    name: products
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 8e-05
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2023-12-13 08:49:26.652 INFO: Using gradient clipping with tolerance=10.000
2023-12-13 08:49:26.652 INFO: Started training
2023-12-13 08:49:26.652 INFO: Training complete
2023-12-13 08:49:26.652 INFO: Computing metrics for training, validation, and test sets
2023-12-13 08:49:26.653 INFO: Loading states from data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-110
2023-12-13 08:49:26.698 INFO: All model weights loaded successfully
2023-12-13 08:49:26.815 INFO: All optimizer states loaded successfully
2023-12-13 08:49:26.815 INFO: All scheduler states loaded successfully
2023-12-13 08:49:26.816 INFO: All random states loaded successfully
2023-12-13 08:49:26.816 INFO: Loading in 0 custom states
2023-12-13 08:49:26.816 INFO: Loaded model from epoch 110
2023-12-13 08:49:26.816 INFO: Evaluating train ...
2023-12-13 09:28:23.857 INFO: Evaluating valid ...
2023-12-13 09:35:53.350 INFO: 
++
||
++
++
2023-12-13 09:35:53.353 INFO: Saving model to data-train-result-stress-128-inter3/checkpoints/MACE_MPtrj_2022.9_run-42.model
2023-12-13 09:35:53.700 INFO: Done
