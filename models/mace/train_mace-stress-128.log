2023-11-06 13:39:18.731 INFO: MACE version: 0.1.0
2023-11-06 13:39:18.732 INFO: Configuration: Namespace(name='MACE_MPtrj_2022.9', seed=42, log_dir='data-train-result-small/logs', model_dir='data-train-result-small', checkpoints_dir='data-train-result-small/checkpoints', results_dir='data-train-result-small/results', downloads_dir='data-train-result-small/downloads', default_dtype='float64', log_level='INFO', error_table='PerAtomMAE', model='ScaleShiftMACE', r_max=5.0, num_radial_basis=8, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='32x0e', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='./data-train-preprocessed/train.h5', valid_file='./data-train-preprocessed/valid.h5', valid_fraction=0.1, test_file=None, test_dir=None, num_workers=8, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file='./data-train-preprocessed/statistics.json', E0s=None, energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='weighted', forces_weight=1.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=32, valid_batch_size=32, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=120, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=True, restart_lr=0.01, save_cpu=False, clip_grad=10.0, wandb=False, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-11-06 13:39:18.732 INFO: Using statistics json file
2023-11-06 13:39:18.732 INFO: Using atomic numbers from statistics file
2023-11-06 13:39:18.732 INFO: AtomicNumberTable: (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 89, 90, 91, 92, 93, 94)
2023-11-06 13:39:18.732 INFO: Atomic Energies not in training file, using command line argument E0s
2023-11-06 13:39:18.733 INFO: Atomic energies: [-3.6673775936325184, -1.321978574671279, -3.47815910592578, -4.724966512505185, -7.727941403300326, -8.404543836565129, -7.359429774977432, -7.284436081345614, -4.896162007436489, -0.03005797428312995, -2.7527187727369, -2.8138258116559136, -4.844369939040846, -7.6966307568316115, -6.96321292174237, -4.673811566998673, -2.813984104722163, -0.06233472731112788, -2.6251773081704863, -5.384791381758609, -7.916197568907359, -10.270820955634214, -8.672390387555845, -9.2371580345617, -8.305620224433062, -7.054671703876374, -5.570915377375696, -5.174147851464132, -3.251035550574451, -1.2879654275024013, -3.5321835252059812, -4.711328365973749, -3.9717755452456673, -3.886221455984922, -2.5183143168985502, 6.706842222672468, -2.566057480857263, -4.938993788294903, -10.153603816562159, -11.857062150232505, -12.14164656151253, -8.786094380920531, -8.795434431218645, -7.778351502991773, -6.838726494373795, -4.881216430056056, -2.0605586704343675, -0.6439905162993389, -2.788575343692543, -3.816810475940441, -3.587983770584603, -2.8805917608627976, -1.6360524330360255, 9.796001071919388, -2.7486371263604354, -4.986670776340143, -8.929476698318382, -8.74170685282431, -8.01217127881877, -8.233598378021814, -7.62454389634746, -8.161368139142393, -13.591451290378114, -18.538136714242995, -7.644552511106582, -8.115049752450005, -7.614570319217799, -6.82962645334957, -7.820026786949461, -3.5770491745130024, -7.469205400904766, -12.770648602823787, -14.110986902146283, -9.354405708044254, -11.376459286198285, -9.611613368883013, -7.321263077561875, -5.304305597659051, -2.3873175082519373, 0.24792131307789267, -2.31553585581406, -3.7254481655069127, -3.4301772252097935, -5.065907805804548, -11.017529306980132, -12.244262478240024, -13.846602972246156, -14.952721865054968, -15.303292182007306]
2023-11-06 13:39:18.790 INFO: >>>>>>>>>>>>>>>> Getting loss function
2023-11-06 13:39:18.790 INFO: >>>>>>>>>>>>>>>> Getting weighted energy forces loss function
2023-11-06 13:39:18.791 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1.000)
2023-11-06 13:39:18.791 INFO: Average number of neighbors: 25.57754135131836
2023-11-06 13:39:18.791 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': False, 'dipoles': False}
2023-11-06 13:39:18.791 INFO: Building model
2023-11-06 13:39:18.791 INFO: Hidden irreps: 128x0e + 128x1o
2023-11-06 13:39:22.008 WARNING: Cannot find checkpoint with tag 'MACE_MPtrj_2022.9_run-42' in 'data-train-result-small/checkpoints'
2023-11-06 13:39:22.010 INFO: DistributedDataParallel(
  (module): ScaleShiftMACE(
    (node_embedding): LinearNodeEmbeddingBlock(
      (linear): Linear(89x0e -> 128x0e | 11392 weights)
    )
    (radial_embedding): RadialEmbeddingBlock(
      (bessel_fn): BesselBasis(r_max=4.5, num_basis=8, trainable=False)
      (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
    )
    (spherical_harmonics): SphericalHarmonics()
    (atomic_energies_fn): AtomicEnergiesBlock(energies=[-3.6674, -1.3220, -3.4782, -4.7250, -7.7279, -8.4045, -7.3594, -7.2844, -4.8962, -0.0301, -2.7527, -2.8138, -4.8444, -7.6966, -6.9632, -4.6738, -2.8140, -0.0623, -2.6252, -5.3848, -7.9162, -10.2708, -8.6724, -9.2372, -8.3056, -7.0547, -5.5709, -5.1741, -3.2510, -1.2880, -3.5322, -4.7113, -3.9718, -3.8862, -2.5183, 6.7068, -2.5661, -4.9390, -10.1536, -11.8571, -12.1416, -8.7861, -8.7954, -7.7784, -6.8387, -4.8812, -2.0606, -0.6440, -2.7886, -3.8168, -3.5880, -2.8806, -1.6361, 9.7960, -2.7486, -4.9867, -8.9295, -8.7417, -8.0122, -8.2336, -7.6245, -8.1614, -13.5915, -18.5381, -7.6446, -8.1150, -7.6146, -6.8296, -7.8200, -3.5770, -7.4692, -12.7706, -14.1110, -9.3544, -11.3765, -9.6116, -7.3213, -5.3043, -2.3873, 0.2479, -2.3155, -3.7254, -3.4302, -5.0659, -11.0175, -12.2443, -13.8466, -14.9527, -15.3033])
    (interactions): ModuleList(
      (0): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
        (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 512]
        (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e x 89x0e -> 128x0e+128x1o | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
      (1): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
        (conv_tp): TensorProduct(128x0e+128x1o x 1x0e+1x1o+1x2e+1x3o -> 256x0e+384x1o+384x2e+256x3o | 1280 paths | 1280 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1280]
        (linear): Linear(256x0e+384x1o+384x2e+256x3o -> 128x0e+128x1o+128x2e+128x3o | 163840 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o x 89x0e -> 128x0e | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
    )
    (products): ModuleList(
      (0): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
            (1): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x6x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
      )
      (1): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e -> 128x0e | 16384 weights)
      )
    )
    (readouts): ModuleList(
      (0): LinearReadoutBlock(
        (linear): Linear(128x0e+128x1o -> 1x0e | 128 weights)
      )
      (1): NonLinearReadoutBlock(
        (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
        (non_linearity): Activation [x] (16x0e -> 16x0e)
        (linear_2): Linear(16x0e -> 1x0e | 16 weights)
      )
    )
    (scale_shift): ScaleShiftBlock(scale=0.804340, shift=0.164779)
  )
)
2023-11-06 13:39:22.014 INFO: Number of parameters: 4688400
2023-11-06 13:39:22.015 INFO: Optimizer: AcceleratedOptimizer (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.01
    maximize: False
    name: interactions_decay
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.01
    maximize: False
    name: interactions_no_decay
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2023-11-06 13:39:22.015 INFO: Using gradient clipping with tolerance=10.000
2023-11-06 13:39:22.015 INFO: Started training
2023-11-06 13:39:23.686 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-06 13:39:23.686 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-06 13:39:23.686 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-06 13:39:23.686 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-06 14:46:47.025 INFO: Epoch 0: loss=0.0046, MAE_E_per_atom=42.5 meV, MAE_F=103.5 meV / A
2023-11-06 14:46:47.027 INFO: Saving current state to data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-0
2023-11-06 14:46:47.083 INFO: Model weights saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-0/pytorch_model.bin
2023-11-06 14:46:47.208 INFO: Optimizer state saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-0/optimizer.bin
2023-11-06 14:46:47.213 INFO: Random states saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-0/random_states_0.pkl
2023-11-06 16:57:24.534 INFO: Epoch 2: loss=0.0038, MAE_E_per_atom=33.7 meV, MAE_F=89.6 meV / A
2023-11-06 16:57:24.554 INFO: Saving current state to data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-2
2023-11-06 16:57:24.607 INFO: Model weights saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-2/pytorch_model.bin
2023-11-06 16:57:24.705 INFO: Optimizer state saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-2/optimizer.bin
2023-11-06 16:57:24.707 INFO: Random states saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-2/random_states_0.pkl
2023-11-06 19:14:38.554 INFO: Epoch 4: loss=0.0036, MAE_E_per_atom=30.8 meV, MAE_F=84.5 meV / A
2023-11-06 19:14:38.570 INFO: Saving current state to data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-4
2023-11-06 19:14:38.610 INFO: Model weights saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-4/pytorch_model.bin
2023-11-06 19:14:38.700 INFO: Optimizer state saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-4/optimizer.bin
2023-11-06 19:14:38.701 INFO: Random states saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-4/random_states_0.pkl
2023-11-06 21:44:13.163 INFO: Epoch 6: loss=0.0035, MAE_E_per_atom=28.9 meV, MAE_F=81.5 meV / A
2023-11-06 21:44:13.181 INFO: Saving current state to data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-6
2023-11-06 21:44:13.236 INFO: Model weights saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-6/pytorch_model.bin
2023-11-06 21:44:13.352 INFO: Optimizer state saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-6/optimizer.bin
2023-11-06 21:44:13.353 INFO: Random states saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-6/random_states_0.pkl
2023-11-07 00:34:02.714 INFO: Epoch 8: loss=0.0033, MAE_E_per_atom=27.7 meV, MAE_F=78.7 meV / A
2023-11-07 00:34:02.731 INFO: Saving current state to data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-8
2023-11-07 00:34:02.786 INFO: Model weights saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-8/pytorch_model.bin
2023-11-07 00:34:02.910 INFO: Optimizer state saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-8/optimizer.bin
2023-11-07 00:34:02.912 INFO: Random states saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-8/random_states_0.pkl
2023-11-07 03:48:25.578 INFO: Epoch 10: loss=0.0034, MAE_E_per_atom=27.8 meV, MAE_F=80.1 meV / A
2023-11-07 07:26:02.992 INFO: Epoch 12: loss=0.0032, MAE_E_per_atom=26.0 meV, MAE_F=76.3 meV / A
2023-11-07 07:26:03.010 INFO: Saving current state to data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-12
2023-11-07 07:26:03.068 INFO: Model weights saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-12/pytorch_model.bin
2023-11-07 07:26:03.199 INFO: Optimizer state saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-12/optimizer.bin
2023-11-07 07:26:03.201 INFO: Random states saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-12/random_states_0.pkl
2023-11-07 11:26:31.251 INFO: Epoch 14: loss=0.0031, MAE_E_per_atom=25.3 meV, MAE_F=75.1 meV / A
2023-11-07 11:26:31.267 INFO: Saving current state to data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-14
2023-11-07 11:26:31.321 INFO: Model weights saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-14/pytorch_model.bin
2023-11-07 11:26:31.417 INFO: Optimizer state saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-14/optimizer.bin
2023-11-07 11:26:31.418 INFO: Random states saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-14/random_states_0.pkl
2023-11-07 15:52:26.687 INFO: Epoch 16: loss=0.0031, MAE_E_per_atom=24.8 meV, MAE_F=74.2 meV / A
2023-11-07 15:52:26.704 INFO: Saving current state to data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-16
2023-11-07 15:52:26.758 INFO: Model weights saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-16/pytorch_model.bin
2023-11-07 15:52:26.852 INFO: Optimizer state saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-16/optimizer.bin
2023-11-07 15:52:26.853 INFO: Random states saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-16/random_states_0.pkl
2023-11-07 20:46:26.768 INFO: Epoch 18: loss=0.0031, MAE_E_per_atom=24.7 meV, MAE_F=74.0 meV / A
2023-11-07 20:46:26.780 INFO: Saving current state to data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-18
2023-11-07 20:46:26.821 INFO: Model weights saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-18/pytorch_model.bin
2023-11-07 20:46:26.915 INFO: Optimizer state saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-18/optimizer.bin
2023-11-07 20:46:26.916 INFO: Random states saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-18/random_states_0.pkl
2023-11-08 02:03:24.234 INFO: Epoch 20: loss=0.0030, MAE_E_per_atom=24.2 meV, MAE_F=73.5 meV / A
2023-11-08 02:03:24.251 INFO: Saving current state to data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-20
2023-11-08 02:03:24.308 INFO: Model weights saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-20/pytorch_model.bin
2023-11-08 02:03:24.434 INFO: Optimizer state saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-20/optimizer.bin
2023-11-08 02:03:24.436 INFO: Random states saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-20/random_states_0.pkl
2023-11-08 07:41:46.583 INFO: Epoch 22: loss=0.0031, MAE_E_per_atom=24.5 meV, MAE_F=74.3 meV / A
2023-11-08 13:47:33.024 INFO: Epoch 24: loss=0.0030, MAE_E_per_atom=23.9 meV, MAE_F=73.5 meV / A
2023-11-08 13:47:33.037 INFO: Saving current state to data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-24
2023-11-08 13:47:33.084 INFO: Model weights saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-24/pytorch_model.bin
2023-11-08 13:47:33.193 INFO: Optimizer state saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-24/optimizer.bin
2023-11-08 13:47:33.194 INFO: Random states saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-24/random_states_0.pkl
2023-11-08 16:36:24.427 INFO: MACE version: 0.1.0
2023-11-08 16:36:24.427 INFO: Configuration: Namespace(name='MACE_MPtrj_2022.9', seed=42, log_dir='data-train-result-small/logs', model_dir='data-train-result-small', checkpoints_dir='data-train-result-small/checkpoints', results_dir='data-train-result-small/results', downloads_dir='data-train-result-small/downloads', default_dtype='float64', log_level='INFO', error_table='PerAtomMAE', model='ScaleShiftMACE', r_max=5.0, num_radial_basis=8, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='32x0e', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='./data-train-preprocessed/train.h5', valid_file='./data-train-preprocessed/valid.h5', valid_fraction=0.1, test_file=None, test_dir=None, num_workers=8, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file='./data-train-preprocessed/statistics.json', E0s=None, energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='weighted', forces_weight=1.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=32, valid_batch_size=32, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=120, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=True, restart_lr=0.01, save_cpu=False, clip_grad=10.0, wandb=False, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-11-08 16:36:24.427 INFO: Using statistics json file
2023-11-08 16:36:24.427 INFO: Using atomic numbers from statistics file
2023-11-08 16:36:24.428 INFO: AtomicNumberTable: (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 89, 90, 91, 92, 93, 94)
2023-11-08 16:36:24.428 INFO: Atomic Energies not in training file, using command line argument E0s
2023-11-08 16:36:24.429 INFO: Atomic energies: [-3.6673775936325184, -1.321978574671279, -3.47815910592578, -4.724966512505185, -7.727941403300326, -8.404543836565129, -7.359429774977432, -7.284436081345614, -4.896162007436489, -0.03005797428312995, -2.7527187727369, -2.8138258116559136, -4.844369939040846, -7.6966307568316115, -6.96321292174237, -4.673811566998673, -2.813984104722163, -0.06233472731112788, -2.6251773081704863, -5.384791381758609, -7.916197568907359, -10.270820955634214, -8.672390387555845, -9.2371580345617, -8.305620224433062, -7.054671703876374, -5.570915377375696, -5.174147851464132, -3.251035550574451, -1.2879654275024013, -3.5321835252059812, -4.711328365973749, -3.9717755452456673, -3.886221455984922, -2.5183143168985502, 6.706842222672468, -2.566057480857263, -4.938993788294903, -10.153603816562159, -11.857062150232505, -12.14164656151253, -8.786094380920531, -8.795434431218645, -7.778351502991773, -6.838726494373795, -4.881216430056056, -2.0605586704343675, -0.6439905162993389, -2.788575343692543, -3.816810475940441, -3.587983770584603, -2.8805917608627976, -1.6360524330360255, 9.796001071919388, -2.7486371263604354, -4.986670776340143, -8.929476698318382, -8.74170685282431, -8.01217127881877, -8.233598378021814, -7.62454389634746, -8.161368139142393, -13.591451290378114, -18.538136714242995, -7.644552511106582, -8.115049752450005, -7.614570319217799, -6.82962645334957, -7.820026786949461, -3.5770491745130024, -7.469205400904766, -12.770648602823787, -14.110986902146283, -9.354405708044254, -11.376459286198285, -9.611613368883013, -7.321263077561875, -5.304305597659051, -2.3873175082519373, 0.24792131307789267, -2.31553585581406, -3.7254481655069127, -3.4301772252097935, -5.065907805804548, -11.017529306980132, -12.244262478240024, -13.846602972246156, -14.952721865054968, -15.303292182007306]
2023-11-08 16:36:24.483 INFO: >>>>>>>>>>>>>>>> Getting loss function
2023-11-08 16:36:24.483 INFO: >>>>>>>>>>>>>>>> Getting weighted energy forces loss function
2023-11-08 16:36:24.483 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1.000)
2023-11-08 16:36:24.483 INFO: Average number of neighbors: 25.57754135131836
2023-11-08 16:36:24.483 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': False, 'dipoles': False}
2023-11-08 16:36:24.483 INFO: Building model
2023-11-08 16:36:24.483 INFO: Hidden irreps: 128x0e + 128x1o
2023-11-08 16:36:27.297 INFO: Loading states from data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-24
2023-11-08 16:36:27.326 INFO: All model weights loaded successfully
2023-11-08 16:36:27.393 INFO: All optimizer states loaded successfully
2023-11-08 16:36:27.393 INFO: All scheduler states loaded successfully
2023-11-08 16:36:27.396 INFO: All random states loaded successfully
2023-11-08 16:36:27.397 INFO: Loading in 0 custom states
2023-11-08 16:36:27.398 INFO: DistributedDataParallel(
  (module): ScaleShiftMACE(
    (node_embedding): LinearNodeEmbeddingBlock(
      (linear): Linear(89x0e -> 128x0e | 11392 weights)
    )
    (radial_embedding): RadialEmbeddingBlock(
      (bessel_fn): BesselBasis(r_max=4.5, num_basis=8, trainable=False)
      (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
    )
    (spherical_harmonics): SphericalHarmonics()
    (atomic_energies_fn): AtomicEnergiesBlock(energies=[-3.6674, -1.3220, -3.4782, -4.7250, -7.7279, -8.4045, -7.3594, -7.2844, -4.8962, -0.0301, -2.7527, -2.8138, -4.8444, -7.6966, -6.9632, -4.6738, -2.8140, -0.0623, -2.6252, -5.3848, -7.9162, -10.2708, -8.6724, -9.2372, -8.3056, -7.0547, -5.5709, -5.1741, -3.2510, -1.2880, -3.5322, -4.7113, -3.9718, -3.8862, -2.5183, 6.7068, -2.5661, -4.9390, -10.1536, -11.8571, -12.1416, -8.7861, -8.7954, -7.7784, -6.8387, -4.8812, -2.0606, -0.6440, -2.7886, -3.8168, -3.5880, -2.8806, -1.6361, 9.7960, -2.7486, -4.9867, -8.9295, -8.7417, -8.0122, -8.2336, -7.6245, -8.1614, -13.5915, -18.5381, -7.6446, -8.1150, -7.6146, -6.8296, -7.8200, -3.5770, -7.4692, -12.7706, -14.1110, -9.3544, -11.3765, -9.6116, -7.3213, -5.3043, -2.3873, 0.2479, -2.3155, -3.7254, -3.4302, -5.0659, -11.0175, -12.2443, -13.8466, -14.9527, -15.3033])
    (interactions): ModuleList(
      (0): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
        (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 512]
        (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e x 89x0e -> 128x0e+128x1o | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
      (1): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
        (conv_tp): TensorProduct(128x0e+128x1o x 1x0e+1x1o+1x2e+1x3o -> 256x0e+384x1o+384x2e+256x3o | 1280 paths | 1280 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1280]
        (linear): Linear(256x0e+384x1o+384x2e+256x3o -> 128x0e+128x1o+128x2e+128x3o | 163840 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o x 89x0e -> 128x0e | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
    )
    (products): ModuleList(
      (0): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
            (1): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x6x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
      )
      (1): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e -> 128x0e | 16384 weights)
      )
    )
    (readouts): ModuleList(
      (0): LinearReadoutBlock(
        (linear): Linear(128x0e+128x1o -> 1x0e | 128 weights)
      )
      (1): NonLinearReadoutBlock(
        (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
        (non_linearity): Activation [x] (16x0e -> 16x0e)
        (linear_2): Linear(16x0e -> 1x0e | 16 weights)
      )
    )
    (scale_shift): ScaleShiftBlock(scale=0.804340, shift=0.164779)
  )
)
2023-11-08 16:36:27.402 INFO: Number of parameters: 4688400
2023-11-08 16:36:27.402 INFO: Optimizer: AcceleratedOptimizer (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.01
    maximize: False
    name: interactions_decay
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.01
    maximize: False
    name: interactions_no_decay
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2023-11-08 16:36:27.402 INFO: Using gradient clipping with tolerance=10.000
2023-11-08 16:36:27.402 INFO: Started training
2023-11-08 16:36:28.981 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-08 16:36:28.981 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-08 16:36:28.981 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-08 18:02:30.851 INFO: Epoch 24: loss=0.0032, MAE_E_per_atom=25.9 meV, MAE_F=77.2 meV / A
2023-11-08 18:02:30.853 INFO: Saving current state to data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-24
2023-11-08 18:02:30.935 INFO: Model weights saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-24/pytorch_model.bin
2023-11-08 18:02:31.106 INFO: Optimizer state saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-24/optimizer.bin
2023-11-08 18:02:31.107 INFO: Random states saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-24/random_states_0.pkl
2023-11-08 20:51:20.263 INFO: Epoch 26: loss=0.0031, MAE_E_per_atom=24.6 meV, MAE_F=74.3 meV / A
2023-11-08 20:51:20.279 INFO: Saving current state to data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-26
2023-11-08 20:51:20.335 INFO: Model weights saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-26/pytorch_model.bin
2023-11-08 20:51:20.435 INFO: Optimizer state saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-26/optimizer.bin
2023-11-08 20:51:20.436 INFO: Random states saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-26/random_states_0.pkl
2023-11-08 23:58:50.032 INFO: Epoch 28: loss=0.0031, MAE_E_per_atom=24.9 meV, MAE_F=74.6 meV / A
2023-11-09 03:46:14.744 INFO: Epoch 30: loss=0.0030, MAE_E_per_atom=23.9 meV, MAE_F=72.5 meV / A
2023-11-09 03:46:14.762 INFO: Saving current state to data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-30
2023-11-09 03:46:14.819 INFO: Model weights saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-30/pytorch_model.bin
2023-11-09 03:46:14.941 INFO: Optimizer state saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-30/optimizer.bin
2023-11-09 03:46:14.943 INFO: Random states saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-30/random_states_0.pkl
2023-11-09 08:20:20.198 INFO: Epoch 32: loss=0.0030, MAE_E_per_atom=24.0 meV, MAE_F=72.4 meV / A
2023-11-09 08:20:20.210 INFO: Saving current state to data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-32
2023-11-09 08:20:20.251 INFO: Model weights saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-32/pytorch_model.bin
2023-11-09 08:20:20.339 INFO: Optimizer state saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-32/optimizer.bin
2023-11-09 08:20:20.340 INFO: Random states saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-32/random_states_0.pkl
2023-11-09 13:51:10.830 INFO: Epoch 34: loss=0.0030, MAE_E_per_atom=23.6 meV, MAE_F=72.4 meV / A
2023-11-09 13:51:10.848 INFO: Saving current state to data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-34
2023-11-09 13:51:10.906 INFO: Model weights saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-34/pytorch_model.bin
2023-11-09 13:51:11.036 INFO: Optimizer state saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-34/optimizer.bin
2023-11-09 13:51:11.038 INFO: Random states saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-34/random_states_0.pkl
2023-11-09 20:13:13.708 INFO: Epoch 36: loss=0.0030, MAE_E_per_atom=23.3 meV, MAE_F=71.8 meV / A
2023-11-09 20:13:13.720 INFO: Saving current state to data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-36
2023-11-09 20:13:13.760 INFO: Model weights saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-36/pytorch_model.bin
2023-11-09 20:13:13.848 INFO: Optimizer state saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-36/optimizer.bin
2023-11-09 20:13:13.850 INFO: Random states saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-36/random_states_0.pkl
2023-11-10 02:42:43.880 INFO: Epoch 38: loss=0.0029, MAE_E_per_atom=23.1 meV, MAE_F=70.9 meV / A
2023-11-10 02:42:43.895 INFO: Saving current state to data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-38
2023-11-10 02:42:43.951 INFO: Model weights saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-38/pytorch_model.bin
2023-11-10 02:42:44.070 INFO: Optimizer state saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-38/optimizer.bin
2023-11-10 02:42:44.071 INFO: Random states saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-38/random_states_0.pkl
2023-11-10 09:28:47.038 INFO: Epoch 40: loss=0.0029, MAE_E_per_atom=23.3 meV, MAE_F=70.4 meV / A
2023-11-10 09:28:47.050 INFO: Saving current state to data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-40
2023-11-10 09:28:47.093 INFO: Model weights saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-40/pytorch_model.bin
2023-11-10 09:28:47.181 INFO: Optimizer state saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-40/optimizer.bin
2023-11-10 09:28:47.182 INFO: Random states saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-40/random_states_0.pkl
2023-11-10 10:52:00.216 INFO: MACE version: 0.1.0
2023-11-10 10:52:00.216 INFO: Configuration: Namespace(name='MACE_MPtrj_2022.9', seed=42, log_dir='data-train-result-small/logs', model_dir='data-train-result-small', checkpoints_dir='data-train-result-small/checkpoints', results_dir='data-train-result-small/results', downloads_dir='data-train-result-small/downloads', default_dtype='float64', log_level='INFO', error_table='PerAtomMAE', model='ScaleShiftMACE', r_max=5.0, num_radial_basis=8, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='32x0e', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='./data-train-preprocessed/train.h5', valid_file='./data-train-preprocessed/valid.h5', valid_fraction=0.1, test_file=None, test_dir=None, num_workers=8, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file='./data-train-preprocessed/statistics.json', E0s=None, energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='weighted', forces_weight=1.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=32, valid_batch_size=32, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=120, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=True, restart_lr=0.001, save_cpu=False, clip_grad=10.0, wandb=False, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-11-10 10:52:00.217 INFO: Using statistics json file
2023-11-10 10:52:00.217 INFO: Using atomic numbers from statistics file
2023-11-10 10:52:00.217 INFO: AtomicNumberTable: (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 89, 90, 91, 92, 93, 94)
2023-11-10 10:52:00.217 INFO: Atomic Energies not in training file, using command line argument E0s
2023-11-10 10:52:00.217 INFO: Atomic energies: [-3.6673775936325184, -1.321978574671279, -3.47815910592578, -4.724966512505185, -7.727941403300326, -8.404543836565129, -7.359429774977432, -7.284436081345614, -4.896162007436489, -0.03005797428312995, -2.7527187727369, -2.8138258116559136, -4.844369939040846, -7.6966307568316115, -6.96321292174237, -4.673811566998673, -2.813984104722163, -0.06233472731112788, -2.6251773081704863, -5.384791381758609, -7.916197568907359, -10.270820955634214, -8.672390387555845, -9.2371580345617, -8.305620224433062, -7.054671703876374, -5.570915377375696, -5.174147851464132, -3.251035550574451, -1.2879654275024013, -3.5321835252059812, -4.711328365973749, -3.9717755452456673, -3.886221455984922, -2.5183143168985502, 6.706842222672468, -2.566057480857263, -4.938993788294903, -10.153603816562159, -11.857062150232505, -12.14164656151253, -8.786094380920531, -8.795434431218645, -7.778351502991773, -6.838726494373795, -4.881216430056056, -2.0605586704343675, -0.6439905162993389, -2.788575343692543, -3.816810475940441, -3.587983770584603, -2.8805917608627976, -1.6360524330360255, 9.796001071919388, -2.7486371263604354, -4.986670776340143, -8.929476698318382, -8.74170685282431, -8.01217127881877, -8.233598378021814, -7.62454389634746, -8.161368139142393, -13.591451290378114, -18.538136714242995, -7.644552511106582, -8.115049752450005, -7.614570319217799, -6.82962645334957, -7.820026786949461, -3.5770491745130024, -7.469205400904766, -12.770648602823787, -14.110986902146283, -9.354405708044254, -11.376459286198285, -9.611613368883013, -7.321263077561875, -5.304305597659051, -2.3873175082519373, 0.24792131307789267, -2.31553585581406, -3.7254481655069127, -3.4301772252097935, -5.065907805804548, -11.017529306980132, -12.244262478240024, -13.846602972246156, -14.952721865054968, -15.303292182007306]
2023-11-10 10:52:00.253 INFO: >>>>>>>>>>>>>>>> Getting loss function
2023-11-10 10:52:00.253 INFO: >>>>>>>>>>>>>>>> Getting weighted energy forces loss function
2023-11-10 10:52:00.253 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1.000)
2023-11-10 10:52:00.253 INFO: Average number of neighbors: 25.57754135131836
2023-11-10 10:52:00.253 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': False, 'dipoles': False}
2023-11-10 10:52:00.253 INFO: Building model
2023-11-10 10:52:00.253 INFO: Hidden irreps: 128x0e + 128x1o
2023-11-10 10:52:02.873 INFO: Loading states from data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-40
2023-11-10 10:52:02.905 INFO: All model weights loaded successfully
2023-11-10 10:52:02.978 INFO: All optimizer states loaded successfully
2023-11-10 10:52:02.978 INFO: All scheduler states loaded successfully
2023-11-10 10:52:02.980 INFO: All random states loaded successfully
2023-11-10 10:52:02.981 INFO: Loading in 0 custom states
2023-11-10 10:52:02.982 INFO: DistributedDataParallel(
  (module): ScaleShiftMACE(
    (node_embedding): LinearNodeEmbeddingBlock(
      (linear): Linear(89x0e -> 128x0e | 11392 weights)
    )
    (radial_embedding): RadialEmbeddingBlock(
      (bessel_fn): BesselBasis(r_max=4.5, num_basis=8, trainable=False)
      (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
    )
    (spherical_harmonics): SphericalHarmonics()
    (atomic_energies_fn): AtomicEnergiesBlock(energies=[-3.6674, -1.3220, -3.4782, -4.7250, -7.7279, -8.4045, -7.3594, -7.2844, -4.8962, -0.0301, -2.7527, -2.8138, -4.8444, -7.6966, -6.9632, -4.6738, -2.8140, -0.0623, -2.6252, -5.3848, -7.9162, -10.2708, -8.6724, -9.2372, -8.3056, -7.0547, -5.5709, -5.1741, -3.2510, -1.2880, -3.5322, -4.7113, -3.9718, -3.8862, -2.5183, 6.7068, -2.5661, -4.9390, -10.1536, -11.8571, -12.1416, -8.7861, -8.7954, -7.7784, -6.8387, -4.8812, -2.0606, -0.6440, -2.7886, -3.8168, -3.5880, -2.8806, -1.6361, 9.7960, -2.7486, -4.9867, -8.9295, -8.7417, -8.0122, -8.2336, -7.6245, -8.1614, -13.5915, -18.5381, -7.6446, -8.1150, -7.6146, -6.8296, -7.8200, -3.5770, -7.4692, -12.7706, -14.1110, -9.3544, -11.3765, -9.6116, -7.3213, -5.3043, -2.3873, 0.2479, -2.3155, -3.7254, -3.4302, -5.0659, -11.0175, -12.2443, -13.8466, -14.9527, -15.3033])
    (interactions): ModuleList(
      (0): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
        (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 512]
        (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e x 89x0e -> 128x0e+128x1o | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
      (1): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
        (conv_tp): TensorProduct(128x0e+128x1o x 1x0e+1x1o+1x2e+1x3o -> 256x0e+384x1o+384x2e+256x3o | 1280 paths | 1280 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1280]
        (linear): Linear(256x0e+384x1o+384x2e+256x3o -> 128x0e+128x1o+128x2e+128x3o | 163840 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o x 89x0e -> 128x0e | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
    )
    (products): ModuleList(
      (0): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
            (1): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x6x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
      )
      (1): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e -> 128x0e | 16384 weights)
      )
    )
    (readouts): ModuleList(
      (0): LinearReadoutBlock(
        (linear): Linear(128x0e+128x1o -> 1x0e | 128 weights)
      )
      (1): NonLinearReadoutBlock(
        (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
        (non_linearity): Activation [x] (16x0e -> 16x0e)
        (linear_2): Linear(16x0e -> 1x0e | 16 weights)
      )
    )
    (scale_shift): ScaleShiftBlock(scale=0.804340, shift=0.164779)
  )
)
2023-11-10 10:52:02.986 INFO: Number of parameters: 4688400
2023-11-10 10:52:02.986 INFO: Optimizer: AcceleratedOptimizer (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    name: interactions_decay
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    name: interactions_no_decay
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    name: products
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2023-11-10 10:52:02.986 INFO: Using gradient clipping with tolerance=10.000
2023-11-10 10:52:02.986 INFO: Started training
2023-11-10 10:52:04.709 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-10 10:52:04.709 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-10 10:52:04.709 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-10 12:16:43.237 INFO: Epoch 40: loss=0.0027, MAE_E_per_atom=19.7 meV, MAE_F=66.6 meV / A
2023-11-10 12:16:43.239 INFO: Saving current state to data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-40
2023-11-10 12:16:43.331 INFO: Model weights saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-40/pytorch_model.bin
2023-11-10 12:16:43.530 INFO: Optimizer state saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-40/optimizer.bin
2023-11-10 12:16:43.532 INFO: Random states saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-40/random_states_0.pkl
2023-11-10 15:05:24.550 INFO: Epoch 42: loss=0.0026, MAE_E_per_atom=19.1 meV, MAE_F=65.6 meV / A
2023-11-10 15:05:24.562 INFO: Saving current state to data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-42
2023-11-10 15:05:24.602 INFO: Model weights saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-42/pytorch_model.bin
2023-11-10 15:05:24.692 INFO: Optimizer state saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-42/optimizer.bin
2023-11-10 15:05:24.693 INFO: Random states saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-42/random_states_0.pkl
2023-11-10 18:14:00.971 INFO: Epoch 44: loss=0.0026, MAE_E_per_atom=18.8 meV, MAE_F=65.2 meV / A
2023-11-10 18:14:00.993 INFO: Saving current state to data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-44
2023-11-10 18:14:01.050 INFO: Model weights saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-44/pytorch_model.bin
2023-11-10 18:14:01.181 INFO: Optimizer state saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-44/optimizer.bin
2023-11-10 18:14:01.182 INFO: Random states saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-44/random_states_0.pkl
2023-11-10 22:00:37.246 INFO: Epoch 46: loss=0.0026, MAE_E_per_atom=18.6 meV, MAE_F=65.1 meV / A
2023-11-10 22:00:37.266 INFO: Saving current state to data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-46
2023-11-10 22:00:37.324 INFO: Model weights saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-46/pytorch_model.bin
2023-11-10 22:00:37.449 INFO: Optimizer state saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-46/optimizer.bin
2023-11-10 22:00:37.451 INFO: Random states saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-46/random_states_0.pkl
2023-11-11 02:31:52.445 INFO: Epoch 48: loss=0.0026, MAE_E_per_atom=18.3 meV, MAE_F=64.2 meV / A
2023-11-11 02:31:52.462 INFO: Saving current state to data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-48
2023-11-11 02:31:52.525 INFO: Model weights saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-48/pytorch_model.bin
2023-11-11 02:31:52.651 INFO: Optimizer state saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-48/optimizer.bin
2023-11-11 02:31:52.653 INFO: Random states saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-48/random_states_0.pkl
2023-11-11 07:44:48.652 INFO: Epoch 50: loss=0.0026, MAE_E_per_atom=18.2 meV, MAE_F=64.1 meV / A
2023-11-11 07:44:48.670 INFO: Saving current state to data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-50
2023-11-11 07:44:48.733 INFO: Model weights saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-50/pytorch_model.bin
2023-11-11 07:44:48.855 INFO: Optimizer state saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-50/optimizer.bin
2023-11-11 07:44:48.857 INFO: Random states saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-50/random_states_0.pkl
2023-11-11 13:35:56.157 INFO: Epoch 52: loss=0.0026, MAE_E_per_atom=18.0 meV, MAE_F=63.8 meV / A
2023-11-11 13:35:56.171 INFO: Saving current state to data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-52
2023-11-11 13:35:56.215 INFO: Model weights saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-52/pytorch_model.bin
2023-11-11 13:35:56.307 INFO: Optimizer state saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-52/optimizer.bin
2023-11-11 13:35:56.308 INFO: Random states saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-52/random_states_0.pkl
2023-11-11 20:12:42.950 INFO: Epoch 54: loss=0.0025, MAE_E_per_atom=17.9 meV, MAE_F=63.1 meV / A
2023-11-11 20:12:42.962 INFO: Saving current state to data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-54
2023-11-11 20:12:43.001 INFO: Model weights saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-54/pytorch_model.bin
2023-11-11 20:12:43.092 INFO: Optimizer state saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-54/optimizer.bin
2023-11-11 20:12:43.093 INFO: Random states saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-54/random_states_0.pkl
2023-11-12 03:30:56.568 INFO: Epoch 56: loss=0.0025, MAE_E_per_atom=17.8 meV, MAE_F=63.0 meV / A
2023-11-12 03:30:56.581 INFO: Saving current state to data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-56
2023-11-12 03:30:56.625 INFO: Model weights saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-56/pytorch_model.bin
2023-11-12 03:30:56.715 INFO: Optimizer state saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-56/optimizer.bin
2023-11-12 03:30:56.716 INFO: Random states saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-56/random_states_0.pkl
2023-11-12 11:32:18.162 INFO: Epoch 58: loss=0.0025, MAE_E_per_atom=17.6 meV, MAE_F=63.0 meV / A
2023-11-12 11:32:18.174 INFO: Saving current state to data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-58
2023-11-12 11:32:18.219 INFO: Model weights saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-58/pytorch_model.bin
2023-11-12 11:32:18.312 INFO: Optimizer state saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-58/optimizer.bin
2023-11-12 11:32:18.313 INFO: Random states saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-58/random_states_0.pkl
2023-11-12 19:50:31.129 INFO: Epoch 60: loss=0.0025, MAE_E_per_atom=17.6 meV, MAE_F=62.5 meV / A
2023-11-12 19:50:31.142 INFO: Saving current state to data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-60
2023-11-12 19:50:31.182 INFO: Model weights saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-60/pytorch_model.bin
2023-11-12 19:50:31.273 INFO: Optimizer state saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-60/optimizer.bin
2023-11-12 19:50:31.274 INFO: Random states saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-60/random_states_0.pkl
2023-11-13 04:58:57.016 INFO: Epoch 62: loss=0.0025, MAE_E_per_atom=17.5 meV, MAE_F=62.3 meV / A
2023-11-13 04:58:57.031 INFO: Saving current state to data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-62
2023-11-13 04:58:57.073 INFO: Model weights saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-62/pytorch_model.bin
2023-11-13 04:58:57.163 INFO: Optimizer state saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-62/optimizer.bin
2023-11-13 04:58:57.164 INFO: Random states saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-62/random_states_0.pkl
2023-11-13 14:54:26.298 INFO: Epoch 64: loss=0.0025, MAE_E_per_atom=17.4 meV, MAE_F=62.2 meV / A
2023-11-13 14:54:26.312 INFO: Saving current state to data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-64
2023-11-13 14:54:26.352 INFO: Model weights saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-64/pytorch_model.bin
2023-11-13 14:54:26.443 INFO: Optimizer state saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-64/optimizer.bin
2023-11-13 14:54:26.444 INFO: Random states saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-64/random_states_0.pkl
2023-11-14 01:22:00.175 INFO: Epoch 66: loss=0.0025, MAE_E_per_atom=17.3 meV, MAE_F=62.0 meV / A
2023-11-14 01:22:00.188 INFO: Saving current state to data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-66
2023-11-14 01:22:00.229 INFO: Model weights saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-66/pytorch_model.bin
2023-11-14 01:22:00.321 INFO: Optimizer state saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-66/optimizer.bin
2023-11-14 01:22:00.322 INFO: Random states saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-66/random_states_0.pkl
2023-11-14 12:15:38.709 INFO: Epoch 68: loss=0.0025, MAE_E_per_atom=17.2 meV, MAE_F=61.9 meV / A
2023-11-14 12:15:38.723 INFO: Saving current state to data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-68
2023-11-14 12:15:38.764 INFO: Model weights saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-68/pytorch_model.bin
2023-11-14 12:15:38.867 INFO: Optimizer state saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-68/optimizer.bin
2023-11-14 12:15:38.868 INFO: Random states saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-68/random_states_0.pkl
2023-11-15 01:31:52.367 INFO: Epoch 70: loss=0.0025, MAE_E_per_atom=17.2 meV, MAE_F=61.8 meV / A
2023-11-15 01:31:52.380 INFO: Saving current state to data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-70
2023-11-15 01:31:52.420 INFO: Model weights saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-70/pytorch_model.bin
2023-11-15 01:31:52.509 INFO: Optimizer state saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-70/optimizer.bin
2023-11-15 01:31:52.510 INFO: Random states saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-70/random_states_0.pkl
2023-11-15 14:19:26.558 INFO: Epoch 72: loss=0.0025, MAE_E_per_atom=17.1 meV, MAE_F=61.4 meV / A
2023-11-15 14:19:26.570 INFO: Saving current state to data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-72
2023-11-15 14:19:26.623 INFO: Model weights saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-72/pytorch_model.bin
2023-11-15 14:19:26.737 INFO: Optimizer state saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-72/optimizer.bin
2023-11-15 14:19:26.738 INFO: Random states saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-72/random_states_0.pkl
2023-11-16 04:50:59.488 INFO: Epoch 74: loss=0.0024, MAE_E_per_atom=16.9 meV, MAE_F=61.4 meV / A
2023-11-16 04:50:59.490 INFO: Saving current state to data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-74
2023-11-16 04:50:59.536 INFO: Model weights saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-74/pytorch_model.bin
2023-11-16 04:50:59.638 INFO: Optimizer state saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-74/optimizer.bin
2023-11-16 04:50:59.639 INFO: Random states saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-74/random_states_0.pkl
2023-11-16 18:42:41.241 INFO: Epoch 76: loss=0.0024, MAE_E_per_atom=16.9 meV, MAE_F=61.2 meV / A
2023-11-16 18:42:41.256 INFO: Saving current state to data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-76
2023-11-16 18:42:41.301 INFO: Model weights saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-76/pytorch_model.bin
2023-11-16 18:42:41.404 INFO: Optimizer state saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-76/optimizer.bin
2023-11-16 18:42:41.406 INFO: Random states saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-76/random_states_0.pkl
2023-11-17 09:26:21.411 INFO: Epoch 78: loss=0.0024, MAE_E_per_atom=16.8 meV, MAE_F=61.0 meV / A
2023-11-17 09:26:21.424 INFO: Saving current state to data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-78
2023-11-17 09:26:21.464 INFO: Model weights saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-78/pytorch_model.bin
2023-11-17 09:26:21.554 INFO: Optimizer state saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-78/optimizer.bin
2023-11-17 09:26:21.555 INFO: Random states saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-78/random_states_0.pkl
2023-11-17 12:50:10.215 INFO: MACE version: 0.1.0
2023-11-17 12:50:10.215 INFO: Configuration: Namespace(name='MACE_MPtrj_2022.9', seed=42, log_dir='data-train-result-small/logs', model_dir='data-train-result-small', checkpoints_dir='data-train-result-small/checkpoints', results_dir='data-train-result-small/results', downloads_dir='data-train-result-small/downloads', default_dtype='float64', log_level='INFO', error_table='PerAtomMAE', model='ScaleShiftMACE', r_max=5.0, num_radial_basis=8, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='32x0e', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='./data-train-preprocessed/train.h5', valid_file='./data-train-preprocessed/valid.h5', valid_fraction=0.1, test_file=None, test_dir=None, num_workers=8, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file='./data-train-preprocessed/statistics.json', E0s=None, energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='weighted', forces_weight=1.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=32, valid_batch_size=32, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=120, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=True, restart_lr=0.002, save_cpu=False, clip_grad=10.0, wandb=False, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-11-17 12:50:10.216 INFO: Using statistics json file
2023-11-17 12:50:10.216 INFO: Using atomic numbers from statistics file
2023-11-17 12:50:10.217 INFO: AtomicNumberTable: (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 89, 90, 91, 92, 93, 94)
2023-11-17 12:50:10.217 INFO: Atomic Energies not in training file, using command line argument E0s
2023-11-17 12:50:10.217 INFO: Atomic energies: [-3.6673775936325184, -1.321978574671279, -3.47815910592578, -4.724966512505185, -7.727941403300326, -8.404543836565129, -7.359429774977432, -7.284436081345614, -4.896162007436489, -0.03005797428312995, -2.7527187727369, -2.8138258116559136, -4.844369939040846, -7.6966307568316115, -6.96321292174237, -4.673811566998673, -2.813984104722163, -0.06233472731112788, -2.6251773081704863, -5.384791381758609, -7.916197568907359, -10.270820955634214, -8.672390387555845, -9.2371580345617, -8.305620224433062, -7.054671703876374, -5.570915377375696, -5.174147851464132, -3.251035550574451, -1.2879654275024013, -3.5321835252059812, -4.711328365973749, -3.9717755452456673, -3.886221455984922, -2.5183143168985502, 6.706842222672468, -2.566057480857263, -4.938993788294903, -10.153603816562159, -11.857062150232505, -12.14164656151253, -8.786094380920531, -8.795434431218645, -7.778351502991773, -6.838726494373795, -4.881216430056056, -2.0605586704343675, -0.6439905162993389, -2.788575343692543, -3.816810475940441, -3.587983770584603, -2.8805917608627976, -1.6360524330360255, 9.796001071919388, -2.7486371263604354, -4.986670776340143, -8.929476698318382, -8.74170685282431, -8.01217127881877, -8.233598378021814, -7.62454389634746, -8.161368139142393, -13.591451290378114, -18.538136714242995, -7.644552511106582, -8.115049752450005, -7.614570319217799, -6.82962645334957, -7.820026786949461, -3.5770491745130024, -7.469205400904766, -12.770648602823787, -14.110986902146283, -9.354405708044254, -11.376459286198285, -9.611613368883013, -7.321263077561875, -5.304305597659051, -2.3873175082519373, 0.24792131307789267, -2.31553585581406, -3.7254481655069127, -3.4301772252097935, -5.065907805804548, -11.017529306980132, -12.244262478240024, -13.846602972246156, -14.952721865054968, -15.303292182007306]
2023-11-17 12:50:10.279 INFO: >>>>>>>>>>>>>>>> Getting loss function
2023-11-17 12:50:10.279 INFO: >>>>>>>>>>>>>>>> Getting weighted energy forces loss function
2023-11-17 12:50:10.280 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1.000)
2023-11-17 12:50:10.280 INFO: Average number of neighbors: 25.57754135131836
2023-11-17 12:50:10.280 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': False, 'dipoles': False}
2023-11-17 12:50:10.280 INFO: Building model
2023-11-17 12:50:10.280 INFO: Hidden irreps: 128x0e + 128x1o
2023-11-17 12:50:13.467 INFO: Loading states from data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-78
2023-11-17 12:50:13.501 INFO: All model weights loaded successfully
2023-11-17 12:50:13.574 INFO: All optimizer states loaded successfully
2023-11-17 12:50:13.574 INFO: All scheduler states loaded successfully
2023-11-17 12:50:13.576 INFO: All random states loaded successfully
2023-11-17 12:50:13.577 INFO: Loading in 0 custom states
2023-11-17 12:50:13.577 INFO: DistributedDataParallel(
  (module): ScaleShiftMACE(
    (node_embedding): LinearNodeEmbeddingBlock(
      (linear): Linear(89x0e -> 128x0e | 11392 weights)
    )
    (radial_embedding): RadialEmbeddingBlock(
      (bessel_fn): BesselBasis(r_max=4.5, num_basis=8, trainable=False)
      (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
    )
    (spherical_harmonics): SphericalHarmonics()
    (atomic_energies_fn): AtomicEnergiesBlock(energies=[-3.6674, -1.3220, -3.4782, -4.7250, -7.7279, -8.4045, -7.3594, -7.2844, -4.8962, -0.0301, -2.7527, -2.8138, -4.8444, -7.6966, -6.9632, -4.6738, -2.8140, -0.0623, -2.6252, -5.3848, -7.9162, -10.2708, -8.6724, -9.2372, -8.3056, -7.0547, -5.5709, -5.1741, -3.2510, -1.2880, -3.5322, -4.7113, -3.9718, -3.8862, -2.5183, 6.7068, -2.5661, -4.9390, -10.1536, -11.8571, -12.1416, -8.7861, -8.7954, -7.7784, -6.8387, -4.8812, -2.0606, -0.6440, -2.7886, -3.8168, -3.5880, -2.8806, -1.6361, 9.7960, -2.7486, -4.9867, -8.9295, -8.7417, -8.0122, -8.2336, -7.6245, -8.1614, -13.5915, -18.5381, -7.6446, -8.1150, -7.6146, -6.8296, -7.8200, -3.5770, -7.4692, -12.7706, -14.1110, -9.3544, -11.3765, -9.6116, -7.3213, -5.3043, -2.3873, 0.2479, -2.3155, -3.7254, -3.4302, -5.0659, -11.0175, -12.2443, -13.8466, -14.9527, -15.3033])
    (interactions): ModuleList(
      (0): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
        (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 512]
        (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e x 89x0e -> 128x0e+128x1o | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
      (1): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
        (conv_tp): TensorProduct(128x0e+128x1o x 1x0e+1x1o+1x2e+1x3o -> 256x0e+384x1o+384x2e+256x3o | 1280 paths | 1280 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1280]
        (linear): Linear(256x0e+384x1o+384x2e+256x3o -> 128x0e+128x1o+128x2e+128x3o | 163840 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o x 89x0e -> 128x0e | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
    )
    (products): ModuleList(
      (0): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
            (1): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x6x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
      )
      (1): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e -> 128x0e | 16384 weights)
      )
    )
    (readouts): ModuleList(
      (0): LinearReadoutBlock(
        (linear): Linear(128x0e+128x1o -> 1x0e | 128 weights)
      )
      (1): NonLinearReadoutBlock(
        (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
        (non_linearity): Activation [x] (16x0e -> 16x0e)
        (linear_2): Linear(16x0e -> 1x0e | 16 weights)
      )
    )
    (scale_shift): ScaleShiftBlock(scale=0.804340, shift=0.164779)
  )
)
2023-11-17 12:50:13.582 INFO: Number of parameters: 4688400
2023-11-17 12:50:13.582 INFO: Optimizer: AcceleratedOptimizer (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.002
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.002
    maximize: False
    name: interactions_decay
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.002
    maximize: False
    name: interactions_no_decay
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.002
    maximize: False
    name: products
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.002
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2023-11-17 12:50:13.582 INFO: Using gradient clipping with tolerance=10.000
2023-11-17 12:50:13.582 INFO: Started training
2023-11-17 12:50:15.367 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-17 12:50:15.367 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-17 12:50:15.367 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-17 12:50:15.368 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-17 13:57:48.640 INFO: Epoch 78: loss=0.0025, MAE_E_per_atom=17.3 meV, MAE_F=61.4 meV / A
2023-11-17 13:57:48.641 INFO: Saving current state to data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-78
2023-11-17 13:57:48.732 INFO: Model weights saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-78/pytorch_model.bin
2023-11-17 13:57:48.934 INFO: Optimizer state saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-78/optimizer.bin
2023-11-17 13:57:48.936 INFO: Random states saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-78/random_states_0.pkl
2023-11-17 16:09:06.141 INFO: Epoch 80: loss=0.0025, MAE_E_per_atom=17.2 meV, MAE_F=61.4 meV / A
2023-11-17 16:09:06.157 INFO: Saving current state to data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-80
2023-11-17 16:09:06.216 INFO: Model weights saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-80/pytorch_model.bin
2023-11-17 16:09:06.350 INFO: Optimizer state saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-80/optimizer.bin
2023-11-17 16:09:06.351 INFO: Random states saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-80/random_states_0.pkl
2023-11-17 18:27:38.586 INFO: Epoch 82: loss=0.0024, MAE_E_per_atom=17.1 meV, MAE_F=61.1 meV / A
2023-11-17 18:27:38.601 INFO: Saving current state to data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-82
2023-11-17 18:27:38.659 INFO: Model weights saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-82/pytorch_model.bin
2023-11-17 18:27:38.786 INFO: Optimizer state saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-82/optimizer.bin
2023-11-17 18:27:38.787 INFO: Random states saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-82/random_states_0.pkl
2023-11-17 21:01:33.391 INFO: Epoch 84: loss=0.0024, MAE_E_per_atom=17.1 meV, MAE_F=61.2 meV / A
2023-11-17 23:57:57.695 INFO: Epoch 86: loss=0.0024, MAE_E_per_atom=17.1 meV, MAE_F=60.9 meV / A
2023-11-17 23:57:57.712 INFO: Saving current state to data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-86
2023-11-17 23:57:57.770 INFO: Model weights saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-86/pytorch_model.bin
2023-11-17 23:57:57.896 INFO: Optimizer state saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-86/optimizer.bin
2023-11-17 23:57:57.897 INFO: Random states saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-86/random_states_0.pkl
2023-11-18 03:18:29.970 INFO: Epoch 88: loss=0.0024, MAE_E_per_atom=17.0 meV, MAE_F=60.7 meV / A
2023-11-18 03:18:29.985 INFO: Saving current state to data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-88
2023-11-18 03:18:30.041 INFO: Model weights saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-88/pytorch_model.bin
2023-11-18 03:18:30.166 INFO: Optimizer state saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-88/optimizer.bin
2023-11-18 03:18:30.167 INFO: Random states saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-88/random_states_0.pkl
2023-11-18 07:04:47.013 INFO: Epoch 90: loss=0.0024, MAE_E_per_atom=16.9 meV, MAE_F=60.8 meV / A
2023-11-18 11:15:52.694 INFO: Epoch 92: loss=0.0024, MAE_E_per_atom=16.9 meV, MAE_F=60.6 meV / A
2023-11-18 11:15:52.706 INFO: Saving current state to data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-92
2023-11-18 11:15:52.750 INFO: Model weights saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-92/pytorch_model.bin
2023-11-18 11:15:52.842 INFO: Optimizer state saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-92/optimizer.bin
2023-11-18 11:15:52.843 INFO: Random states saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-92/random_states_0.pkl
2023-11-18 13:23:07.041 INFO: MACE version: 0.1.0
2023-11-18 13:23:07.042 INFO: Configuration: Namespace(name='MACE_MPtrj_2022.9', seed=42, log_dir='data-train-result-small/logs', model_dir='data-train-result-small', checkpoints_dir='data-train-result-small/checkpoints', results_dir='data-train-result-small/results', downloads_dir='data-train-result-small/downloads', default_dtype='float64', log_level='INFO', error_table='PerAtomMAE', model='ScaleShiftMACE', r_max=5.0, num_radial_basis=8, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='32x0e', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='./data-train-preprocessed/train.h5', valid_file='./data-train-preprocessed/valid.h5', valid_fraction=0.1, test_file=None, test_dir=None, num_workers=8, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file='./data-train-preprocessed/statistics.json', E0s=None, energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='weighted', forces_weight=1.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=32, valid_batch_size=32, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=120, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=True, restart_lr=0.0005, save_cpu=False, clip_grad=10.0, wandb=False, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-11-18 13:23:07.042 INFO: Using statistics json file
2023-11-18 13:23:07.042 INFO: Using atomic numbers from statistics file
2023-11-18 13:23:07.042 INFO: AtomicNumberTable: (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 89, 90, 91, 92, 93, 94)
2023-11-18 13:23:07.042 INFO: Atomic Energies not in training file, using command line argument E0s
2023-11-18 13:23:07.043 INFO: Atomic energies: [-3.6673775936325184, -1.321978574671279, -3.47815910592578, -4.724966512505185, -7.727941403300326, -8.404543836565129, -7.359429774977432, -7.284436081345614, -4.896162007436489, -0.03005797428312995, -2.7527187727369, -2.8138258116559136, -4.844369939040846, -7.6966307568316115, -6.96321292174237, -4.673811566998673, -2.813984104722163, -0.06233472731112788, -2.6251773081704863, -5.384791381758609, -7.916197568907359, -10.270820955634214, -8.672390387555845, -9.2371580345617, -8.305620224433062, -7.054671703876374, -5.570915377375696, -5.174147851464132, -3.251035550574451, -1.2879654275024013, -3.5321835252059812, -4.711328365973749, -3.9717755452456673, -3.886221455984922, -2.5183143168985502, 6.706842222672468, -2.566057480857263, -4.938993788294903, -10.153603816562159, -11.857062150232505, -12.14164656151253, -8.786094380920531, -8.795434431218645, -7.778351502991773, -6.838726494373795, -4.881216430056056, -2.0605586704343675, -0.6439905162993389, -2.788575343692543, -3.816810475940441, -3.587983770584603, -2.8805917608627976, -1.6360524330360255, 9.796001071919388, -2.7486371263604354, -4.986670776340143, -8.929476698318382, -8.74170685282431, -8.01217127881877, -8.233598378021814, -7.62454389634746, -8.161368139142393, -13.591451290378114, -18.538136714242995, -7.644552511106582, -8.115049752450005, -7.614570319217799, -6.82962645334957, -7.820026786949461, -3.5770491745130024, -7.469205400904766, -12.770648602823787, -14.110986902146283, -9.354405708044254, -11.376459286198285, -9.611613368883013, -7.321263077561875, -5.304305597659051, -2.3873175082519373, 0.24792131307789267, -2.31553585581406, -3.7254481655069127, -3.4301772252097935, -5.065907805804548, -11.017529306980132, -12.244262478240024, -13.846602972246156, -14.952721865054968, -15.303292182007306]
2023-11-18 13:23:07.095 INFO: >>>>>>>>>>>>>>>> Getting loss function
2023-11-18 13:23:07.096 INFO: >>>>>>>>>>>>>>>> Getting weighted energy forces loss function
2023-11-18 13:23:07.096 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1.000)
2023-11-18 13:23:07.096 INFO: Average number of neighbors: 25.57754135131836
2023-11-18 13:23:07.096 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': False, 'dipoles': False}
2023-11-18 13:23:07.096 INFO: Building model
2023-11-18 13:23:07.096 INFO: Hidden irreps: 128x0e + 128x1o
2023-11-18 13:23:10.280 INFO: Loading states from data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-92
2023-11-18 13:23:10.312 INFO: All model weights loaded successfully
2023-11-18 13:23:10.382 INFO: All optimizer states loaded successfully
2023-11-18 13:23:10.382 INFO: All scheduler states loaded successfully
2023-11-18 13:23:10.385 INFO: All random states loaded successfully
2023-11-18 13:23:10.386 INFO: Loading in 0 custom states
2023-11-18 13:23:10.386 INFO: DistributedDataParallel(
  (module): ScaleShiftMACE(
    (node_embedding): LinearNodeEmbeddingBlock(
      (linear): Linear(89x0e -> 128x0e | 11392 weights)
    )
    (radial_embedding): RadialEmbeddingBlock(
      (bessel_fn): BesselBasis(r_max=4.5, num_basis=8, trainable=False)
      (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
    )
    (spherical_harmonics): SphericalHarmonics()
    (atomic_energies_fn): AtomicEnergiesBlock(energies=[-3.6674, -1.3220, -3.4782, -4.7250, -7.7279, -8.4045, -7.3594, -7.2844, -4.8962, -0.0301, -2.7527, -2.8138, -4.8444, -7.6966, -6.9632, -4.6738, -2.8140, -0.0623, -2.6252, -5.3848, -7.9162, -10.2708, -8.6724, -9.2372, -8.3056, -7.0547, -5.5709, -5.1741, -3.2510, -1.2880, -3.5322, -4.7113, -3.9718, -3.8862, -2.5183, 6.7068, -2.5661, -4.9390, -10.1536, -11.8571, -12.1416, -8.7861, -8.7954, -7.7784, -6.8387, -4.8812, -2.0606, -0.6440, -2.7886, -3.8168, -3.5880, -2.8806, -1.6361, 9.7960, -2.7486, -4.9867, -8.9295, -8.7417, -8.0122, -8.2336, -7.6245, -8.1614, -13.5915, -18.5381, -7.6446, -8.1150, -7.6146, -6.8296, -7.8200, -3.5770, -7.4692, -12.7706, -14.1110, -9.3544, -11.3765, -9.6116, -7.3213, -5.3043, -2.3873, 0.2479, -2.3155, -3.7254, -3.4302, -5.0659, -11.0175, -12.2443, -13.8466, -14.9527, -15.3033])
    (interactions): ModuleList(
      (0): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
        (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 512]
        (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e x 89x0e -> 128x0e+128x1o | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
      (1): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
        (conv_tp): TensorProduct(128x0e+128x1o x 1x0e+1x1o+1x2e+1x3o -> 256x0e+384x1o+384x2e+256x3o | 1280 paths | 1280 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1280]
        (linear): Linear(256x0e+384x1o+384x2e+256x3o -> 128x0e+128x1o+128x2e+128x3o | 163840 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o x 89x0e -> 128x0e | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
    )
    (products): ModuleList(
      (0): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
            (1): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x6x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
      )
      (1): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e -> 128x0e | 16384 weights)
      )
    )
    (readouts): ModuleList(
      (0): LinearReadoutBlock(
        (linear): Linear(128x0e+128x1o -> 1x0e | 128 weights)
      )
      (1): NonLinearReadoutBlock(
        (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
        (non_linearity): Activation [x] (16x0e -> 16x0e)
        (linear_2): Linear(16x0e -> 1x0e | 16 weights)
      )
    )
    (scale_shift): ScaleShiftBlock(scale=0.804340, shift=0.164779)
  )
)
2023-11-18 13:23:10.391 INFO: Number of parameters: 4688400
2023-11-18 13:23:10.391 INFO: Optimizer: AcceleratedOptimizer (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: interactions_decay
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: interactions_no_decay
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: products
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2023-11-18 13:23:10.391 INFO: Using gradient clipping with tolerance=10.000
2023-11-18 13:23:10.391 INFO: Started training
2023-11-18 13:23:12.254 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-18 13:23:12.254 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-18 13:23:12.255 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-18 13:23:12.255 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-18 14:30:32.983 INFO: Epoch 92: loss=0.0024, MAE_E_per_atom=15.9 meV, MAE_F=59.5 meV / A
2023-11-18 14:30:32.985 INFO: Saving current state to data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-92
2023-11-18 14:30:33.072 INFO: Model weights saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-92/pytorch_model.bin
2023-11-18 14:30:33.264 INFO: Optimizer state saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-92/optimizer.bin
2023-11-18 14:30:33.266 INFO: Random states saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-92/random_states_0.pkl
2023-11-18 16:41:19.050 INFO: Epoch 94: loss=0.0023, MAE_E_per_atom=15.8 meV, MAE_F=59.3 meV / A
2023-11-18 16:41:19.062 INFO: Saving current state to data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-94
2023-11-18 16:41:19.107 INFO: Model weights saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-94/pytorch_model.bin
2023-11-18 16:41:19.225 INFO: Optimizer state saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-94/optimizer.bin
2023-11-18 16:41:19.226 INFO: Random states saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-94/random_states_0.pkl
2023-11-18 18:59:56.595 INFO: Epoch 96: loss=0.0023, MAE_E_per_atom=15.7 meV, MAE_F=59.2 meV / A
2023-11-18 18:59:56.610 INFO: Saving current state to data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-96
2023-11-18 18:59:56.672 INFO: Model weights saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-96/pytorch_model.bin
2023-11-18 18:59:56.807 INFO: Optimizer state saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-96/optimizer.bin
2023-11-18 18:59:56.808 INFO: Random states saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-96/random_states_0.pkl
2023-11-18 21:33:38.956 INFO: Epoch 98: loss=0.0023, MAE_E_per_atom=15.6 meV, MAE_F=59.2 meV / A
2023-11-19 00:30:22.625 INFO: Epoch 100: loss=0.0023, MAE_E_per_atom=15.6 meV, MAE_F=59.0 meV / A
2023-11-19 00:30:22.636 INFO: Saving current state to data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-100
2023-11-19 00:30:22.677 INFO: Model weights saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-100/pytorch_model.bin
2023-11-19 00:30:22.770 INFO: Optimizer state saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-100/optimizer.bin
2023-11-19 00:30:22.771 INFO: Random states saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-100/random_states_0.pkl
2023-11-19 03:52:17.121 INFO: Epoch 102: loss=0.0023, MAE_E_per_atom=15.6 meV, MAE_F=58.9 meV / A
2023-11-19 03:52:17.136 INFO: Saving current state to data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-102
2023-11-19 03:52:17.193 INFO: Model weights saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-102/pytorch_model.bin
2023-11-19 03:52:17.317 INFO: Optimizer state saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-102/optimizer.bin
2023-11-19 03:52:17.319 INFO: Random states saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-102/random_states_0.pkl
2023-11-19 07:36:57.855 INFO: Epoch 104: loss=0.0023, MAE_E_per_atom=15.5 meV, MAE_F=58.9 meV / A
2023-11-19 11:44:44.895 INFO: Epoch 106: loss=0.0023, MAE_E_per_atom=15.5 meV, MAE_F=58.7 meV / A
2023-11-19 11:44:44.907 INFO: Saving current state to data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-106
2023-11-19 11:44:44.949 INFO: Model weights saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-106/pytorch_model.bin
2023-11-19 11:44:45.042 INFO: Optimizer state saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-106/optimizer.bin
2023-11-19 11:44:45.043 INFO: Random states saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-106/random_states_0.pkl
2023-11-19 16:15:51.251 INFO: Epoch 108: loss=0.0023, MAE_E_per_atom=15.4 meV, MAE_F=58.7 meV / A
2023-11-19 21:19:00.734 INFO: Epoch 110: loss=0.0023, MAE_E_per_atom=15.4 meV, MAE_F=58.6 meV / A
2023-11-19 21:19:00.745 INFO: Saving current state to data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-110
2023-11-19 21:19:00.785 INFO: Model weights saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-110/pytorch_model.bin
2023-11-19 21:19:00.873 INFO: Optimizer state saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-110/optimizer.bin
2023-11-19 21:19:00.874 INFO: Random states saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-110/random_states_0.pkl
2023-11-19 22:11:16.561 INFO: MACE version: 0.1.0
2023-11-19 22:11:16.561 INFO: Configuration: Namespace(name='MACE_MPtrj_2022.9', seed=42, log_dir='data-train-result-small/logs', model_dir='data-train-result-small', checkpoints_dir='data-train-result-small/checkpoints', results_dir='data-train-result-small/results', downloads_dir='data-train-result-small/downloads', default_dtype='float64', log_level='INFO', error_table='PerAtomMAE', model='ScaleShiftMACE', r_max=5.0, num_radial_basis=8, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='32x0e', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='./data-train-preprocessed/train.h5', valid_file='./data-train-preprocessed/valid.h5', valid_fraction=0.1, test_file=None, test_dir=None, num_workers=8, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file='./data-train-preprocessed/statistics.json', E0s=None, energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='weighted', forces_weight=1.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=32, valid_batch_size=32, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=120, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=True, restart_lr=0.0002, save_cpu=True, clip_grad=10.0, wandb=False, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-11-19 22:11:16.561 INFO: Using statistics json file
2023-11-19 22:11:16.561 INFO: Using atomic numbers from statistics file
2023-11-19 22:11:16.562 INFO: AtomicNumberTable: (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 89, 90, 91, 92, 93, 94)
2023-11-19 22:11:16.562 INFO: Atomic Energies not in training file, using command line argument E0s
2023-11-19 22:11:16.562 INFO: Atomic energies: [-3.6673775936325184, -1.321978574671279, -3.47815910592578, -4.724966512505185, -7.727941403300326, -8.404543836565129, -7.359429774977432, -7.284436081345614, -4.896162007436489, -0.03005797428312995, -2.7527187727369, -2.8138258116559136, -4.844369939040846, -7.6966307568316115, -6.96321292174237, -4.673811566998673, -2.813984104722163, -0.06233472731112788, -2.6251773081704863, -5.384791381758609, -7.916197568907359, -10.270820955634214, -8.672390387555845, -9.2371580345617, -8.305620224433062, -7.054671703876374, -5.570915377375696, -5.174147851464132, -3.251035550574451, -1.2879654275024013, -3.5321835252059812, -4.711328365973749, -3.9717755452456673, -3.886221455984922, -2.5183143168985502, 6.706842222672468, -2.566057480857263, -4.938993788294903, -10.153603816562159, -11.857062150232505, -12.14164656151253, -8.786094380920531, -8.795434431218645, -7.778351502991773, -6.838726494373795, -4.881216430056056, -2.0605586704343675, -0.6439905162993389, -2.788575343692543, -3.816810475940441, -3.587983770584603, -2.8805917608627976, -1.6360524330360255, 9.796001071919388, -2.7486371263604354, -4.986670776340143, -8.929476698318382, -8.74170685282431, -8.01217127881877, -8.233598378021814, -7.62454389634746, -8.161368139142393, -13.591451290378114, -18.538136714242995, -7.644552511106582, -8.115049752450005, -7.614570319217799, -6.82962645334957, -7.820026786949461, -3.5770491745130024, -7.469205400904766, -12.770648602823787, -14.110986902146283, -9.354405708044254, -11.376459286198285, -9.611613368883013, -7.321263077561875, -5.304305597659051, -2.3873175082519373, 0.24792131307789267, -2.31553585581406, -3.7254481655069127, -3.4301772252097935, -5.065907805804548, -11.017529306980132, -12.244262478240024, -13.846602972246156, -14.952721865054968, -15.303292182007306]
2023-11-19 22:11:16.624 INFO: >>>>>>>>>>>>>>>> Getting loss function
2023-11-19 22:11:16.624 INFO: >>>>>>>>>>>>>>>> Getting weighted energy forces loss function
2023-11-19 22:11:16.624 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1.000)
2023-11-19 22:11:16.625 INFO: Average number of neighbors: 25.57754135131836
2023-11-19 22:11:16.625 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': False, 'dipoles': False}
2023-11-19 22:11:16.625 INFO: Building model
2023-11-19 22:11:16.625 INFO: Hidden irreps: 128x0e + 128x1o
2023-11-19 22:11:19.894 INFO: Loading states from data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-110
2023-11-19 22:11:19.929 INFO: All model weights loaded successfully
2023-11-19 22:11:19.997 INFO: All optimizer states loaded successfully
2023-11-19 22:11:19.998 INFO: All scheduler states loaded successfully
2023-11-19 22:11:20.002 INFO: All random states loaded successfully
2023-11-19 22:11:20.003 INFO: Loading in 0 custom states
2023-11-19 22:11:20.004 INFO: DistributedDataParallel(
  (module): ScaleShiftMACE(
    (node_embedding): LinearNodeEmbeddingBlock(
      (linear): Linear(89x0e -> 128x0e | 11392 weights)
    )
    (radial_embedding): RadialEmbeddingBlock(
      (bessel_fn): BesselBasis(r_max=4.5, num_basis=8, trainable=False)
      (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
    )
    (spherical_harmonics): SphericalHarmonics()
    (atomic_energies_fn): AtomicEnergiesBlock(energies=[-3.6674, -1.3220, -3.4782, -4.7250, -7.7279, -8.4045, -7.3594, -7.2844, -4.8962, -0.0301, -2.7527, -2.8138, -4.8444, -7.6966, -6.9632, -4.6738, -2.8140, -0.0623, -2.6252, -5.3848, -7.9162, -10.2708, -8.6724, -9.2372, -8.3056, -7.0547, -5.5709, -5.1741, -3.2510, -1.2880, -3.5322, -4.7113, -3.9718, -3.8862, -2.5183, 6.7068, -2.5661, -4.9390, -10.1536, -11.8571, -12.1416, -8.7861, -8.7954, -7.7784, -6.8387, -4.8812, -2.0606, -0.6440, -2.7886, -3.8168, -3.5880, -2.8806, -1.6361, 9.7960, -2.7486, -4.9867, -8.9295, -8.7417, -8.0122, -8.2336, -7.6245, -8.1614, -13.5915, -18.5381, -7.6446, -8.1150, -7.6146, -6.8296, -7.8200, -3.5770, -7.4692, -12.7706, -14.1110, -9.3544, -11.3765, -9.6116, -7.3213, -5.3043, -2.3873, 0.2479, -2.3155, -3.7254, -3.4302, -5.0659, -11.0175, -12.2443, -13.8466, -14.9527, -15.3033])
    (interactions): ModuleList(
      (0): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
        (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 512]
        (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e x 89x0e -> 128x0e+128x1o | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
      (1): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
        (conv_tp): TensorProduct(128x0e+128x1o x 1x0e+1x1o+1x2e+1x3o -> 256x0e+384x1o+384x2e+256x3o | 1280 paths | 1280 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1280]
        (linear): Linear(256x0e+384x1o+384x2e+256x3o -> 128x0e+128x1o+128x2e+128x3o | 163840 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o x 89x0e -> 128x0e | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
    )
    (products): ModuleList(
      (0): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
            (1): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x6x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
      )
      (1): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e -> 128x0e | 16384 weights)
      )
    )
    (readouts): ModuleList(
      (0): LinearReadoutBlock(
        (linear): Linear(128x0e+128x1o -> 1x0e | 128 weights)
      )
      (1): NonLinearReadoutBlock(
        (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
        (non_linearity): Activation [x] (16x0e -> 16x0e)
        (linear_2): Linear(16x0e -> 1x0e | 16 weights)
      )
    )
    (scale_shift): ScaleShiftBlock(scale=0.804340, shift=0.164779)
  )
)
2023-11-19 22:11:20.008 INFO: Number of parameters: 4688400
2023-11-19 22:11:20.009 INFO: Optimizer: AcceleratedOptimizer (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    name: interactions_decay
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    name: interactions_no_decay
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    name: products
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2023-11-19 22:11:20.009 INFO: Using gradient clipping with tolerance=10.000
2023-11-19 22:11:20.009 INFO: Started training
2023-11-19 22:11:21.814 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-19 22:11:21.815 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-19 22:11:21.815 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-19 22:11:21.816 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-19 22:13:00.118 INFO: MACE version: 0.1.0
2023-11-19 22:13:00.118 INFO: Configuration: Namespace(name='MACE_MPtrj_2022.9', seed=42, log_dir='data-train-result-small/logs', model_dir='data-train-result-small', checkpoints_dir='data-train-result-small/checkpoints', results_dir='data-train-result-small/results', downloads_dir='data-train-result-small/downloads', default_dtype='float64', log_level='INFO', error_table='PerAtomMAE', model='ScaleShiftMACE', r_max=5.0, num_radial_basis=8, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='32x0e', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=False, compute_forces=True, train_file='./data-train-preprocessed/train.h5', valid_file='./data-train-preprocessed/valid.h5', valid_fraction=0.1, test_file=None, test_dir=None, num_workers=8, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file='./data-train-preprocessed/statistics.json', E0s=None, energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='weighted', forces_weight=1.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=32, valid_batch_size=32, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=114, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=True, restart_lr=0.0002, save_cpu=True, clip_grad=10.0, wandb=False, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-11-19 22:13:00.119 INFO: Using statistics json file
2023-11-19 22:13:00.119 INFO: Using atomic numbers from statistics file
2023-11-19 22:13:00.119 INFO: AtomicNumberTable: (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 89, 90, 91, 92, 93, 94)
2023-11-19 22:13:00.119 INFO: Atomic Energies not in training file, using command line argument E0s
2023-11-19 22:13:00.120 INFO: Atomic energies: [-3.6673775936325184, -1.321978574671279, -3.47815910592578, -4.724966512505185, -7.727941403300326, -8.404543836565129, -7.359429774977432, -7.284436081345614, -4.896162007436489, -0.03005797428312995, -2.7527187727369, -2.8138258116559136, -4.844369939040846, -7.6966307568316115, -6.96321292174237, -4.673811566998673, -2.813984104722163, -0.06233472731112788, -2.6251773081704863, -5.384791381758609, -7.916197568907359, -10.270820955634214, -8.672390387555845, -9.2371580345617, -8.305620224433062, -7.054671703876374, -5.570915377375696, -5.174147851464132, -3.251035550574451, -1.2879654275024013, -3.5321835252059812, -4.711328365973749, -3.9717755452456673, -3.886221455984922, -2.5183143168985502, 6.706842222672468, -2.566057480857263, -4.938993788294903, -10.153603816562159, -11.857062150232505, -12.14164656151253, -8.786094380920531, -8.795434431218645, -7.778351502991773, -6.838726494373795, -4.881216430056056, -2.0605586704343675, -0.6439905162993389, -2.788575343692543, -3.816810475940441, -3.587983770584603, -2.8805917608627976, -1.6360524330360255, 9.796001071919388, -2.7486371263604354, -4.986670776340143, -8.929476698318382, -8.74170685282431, -8.01217127881877, -8.233598378021814, -7.62454389634746, -8.161368139142393, -13.591451290378114, -18.538136714242995, -7.644552511106582, -8.115049752450005, -7.614570319217799, -6.82962645334957, -7.820026786949461, -3.5770491745130024, -7.469205400904766, -12.770648602823787, -14.110986902146283, -9.354405708044254, -11.376459286198285, -9.611613368883013, -7.321263077561875, -5.304305597659051, -2.3873175082519373, 0.24792131307789267, -2.31553585581406, -3.7254481655069127, -3.4301772252097935, -5.065907805804548, -11.017529306980132, -12.244262478240024, -13.846602972246156, -14.952721865054968, -15.303292182007306]
2023-11-19 22:13:00.184 INFO: >>>>>>>>>>>>>>>> Getting loss function
2023-11-19 22:13:00.184 INFO: >>>>>>>>>>>>>>>> Getting weighted energy forces loss function
2023-11-19 22:13:00.184 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1.000)
2023-11-19 22:13:00.184 INFO: Average number of neighbors: 25.57754135131836
2023-11-19 22:13:00.184 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': False, 'dipoles': False}
2023-11-19 22:13:00.184 INFO: Building model
2023-11-19 22:13:00.185 INFO: Hidden irreps: 128x0e + 128x1o
2023-11-19 22:13:03.440 INFO: Loading states from data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-110
2023-11-19 22:13:03.474 INFO: All model weights loaded successfully
2023-11-19 22:13:03.546 INFO: All optimizer states loaded successfully
2023-11-19 22:13:03.546 INFO: All scheduler states loaded successfully
2023-11-19 22:13:03.550 INFO: All random states loaded successfully
2023-11-19 22:13:03.551 INFO: Loading in 0 custom states
2023-11-19 22:13:03.552 INFO: DistributedDataParallel(
  (module): ScaleShiftMACE(
    (node_embedding): LinearNodeEmbeddingBlock(
      (linear): Linear(89x0e -> 128x0e | 11392 weights)
    )
    (radial_embedding): RadialEmbeddingBlock(
      (bessel_fn): BesselBasis(r_max=4.5, num_basis=8, trainable=False)
      (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
    )
    (spherical_harmonics): SphericalHarmonics()
    (atomic_energies_fn): AtomicEnergiesBlock(energies=[-3.6674, -1.3220, -3.4782, -4.7250, -7.7279, -8.4045, -7.3594, -7.2844, -4.8962, -0.0301, -2.7527, -2.8138, -4.8444, -7.6966, -6.9632, -4.6738, -2.8140, -0.0623, -2.6252, -5.3848, -7.9162, -10.2708, -8.6724, -9.2372, -8.3056, -7.0547, -5.5709, -5.1741, -3.2510, -1.2880, -3.5322, -4.7113, -3.9718, -3.8862, -2.5183, 6.7068, -2.5661, -4.9390, -10.1536, -11.8571, -12.1416, -8.7861, -8.7954, -7.7784, -6.8387, -4.8812, -2.0606, -0.6440, -2.7886, -3.8168, -3.5880, -2.8806, -1.6361, 9.7960, -2.7486, -4.9867, -8.9295, -8.7417, -8.0122, -8.2336, -7.6245, -8.1614, -13.5915, -18.5381, -7.6446, -8.1150, -7.6146, -6.8296, -7.8200, -3.5770, -7.4692, -12.7706, -14.1110, -9.3544, -11.3765, -9.6116, -7.3213, -5.3043, -2.3873, 0.2479, -2.3155, -3.7254, -3.4302, -5.0659, -11.0175, -12.2443, -13.8466, -14.9527, -15.3033])
    (interactions): ModuleList(
      (0): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
        (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 512]
        (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e x 89x0e -> 128x0e+128x1o | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
      (1): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
        (conv_tp): TensorProduct(128x0e+128x1o x 1x0e+1x1o+1x2e+1x3o -> 256x0e+384x1o+384x2e+256x3o | 1280 paths | 1280 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1280]
        (linear): Linear(256x0e+384x1o+384x2e+256x3o -> 128x0e+128x1o+128x2e+128x3o | 163840 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o x 89x0e -> 128x0e | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
    )
    (products): ModuleList(
      (0): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
            (1): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x6x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
      )
      (1): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e -> 128x0e | 16384 weights)
      )
    )
    (readouts): ModuleList(
      (0): LinearReadoutBlock(
        (linear): Linear(128x0e+128x1o -> 1x0e | 128 weights)
      )
      (1): NonLinearReadoutBlock(
        (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
        (non_linearity): Activation [x] (16x0e -> 16x0e)
        (linear_2): Linear(16x0e -> 1x0e | 16 weights)
      )
    )
    (scale_shift): ScaleShiftBlock(scale=0.804340, shift=0.164779)
  )
)
2023-11-19 22:13:03.556 INFO: Number of parameters: 4688400
2023-11-19 22:13:03.556 INFO: Optimizer: AcceleratedOptimizer (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    name: interactions_decay
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    name: interactions_no_decay
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    name: products
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2023-11-19 22:13:03.557 INFO: Using gradient clipping with tolerance=10.000
2023-11-19 22:13:03.557 INFO: Started training
2023-11-19 22:13:05.395 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-19 22:13:05.395 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-19 22:13:05.395 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-19 22:13:05.395 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-19 23:20:15.606 INFO: Epoch 110: loss=0.0023, MAE_E_per_atom=15.1 meV, MAE_F=58.3 meV / A
2023-11-19 23:20:15.608 INFO: Saving current state to data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-110
2023-11-19 23:20:15.701 INFO: Model weights saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-110/pytorch_model.bin
2023-11-19 23:20:15.893 INFO: Optimizer state saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-110/optimizer.bin
2023-11-19 23:20:15.895 INFO: Random states saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-110/random_states_0.pkl
2023-11-20 01:30:52.423 INFO: Epoch 112: loss=0.0023, MAE_E_per_atom=15.1 meV, MAE_F=58.2 meV / A
2023-11-20 01:30:52.438 INFO: Saving current state to data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-112
2023-11-20 01:30:52.494 INFO: Model weights saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-112/pytorch_model.bin
2023-11-20 01:30:52.618 INFO: Optimizer state saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-112/optimizer.bin
2023-11-20 01:30:52.619 INFO: Random states saved in data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-112/random_states_0.pkl
2023-11-20 02:35:09.482 INFO: Training complete
2023-11-20 02:35:09.483 INFO: Computing metrics for training, validation, and test sets
2023-11-20 02:35:09.483 INFO: Loading states from data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-112
2023-11-20 02:35:09.510 INFO: All model weights loaded successfully
2023-11-20 02:35:09.563 INFO: All optimizer states loaded successfully
2023-11-20 02:35:09.563 INFO: All scheduler states loaded successfully
2023-11-20 02:35:09.564 INFO: All random states loaded successfully
2023-11-20 02:35:09.564 INFO: Loading in 0 custom states
2023-11-20 02:35:09.564 INFO: Loaded model from epoch 112
2023-11-20 02:35:09.564 INFO: Evaluating train ...
2023-11-20 03:06:06.960 INFO: Evaluating valid ...
2023-11-20 03:12:53.693 INFO: 
+-------------+--------------------+-----------------+------------------+
| config_type | MAE E / meV / atom | MAE F / meV / A | relative F MAE % |
+-------------+--------------------+-----------------+------------------+
|    train    |        14.3        |       56.1      |      35.50       |
|    valid    |        15.1        |       58.2      |      37.77       |
+-------------+--------------------+-----------------+------------------+
2023-11-20 03:12:53.694 INFO: Saving model to data-train-result-small/checkpoints/MACE_MPtrj_2022.9_run-42.model
2023-11-20 03:12:53.902 INFO: Done
2023-11-22 15:45:49.417 INFO: MACE version: 0.1.0
2023-11-22 15:45:49.417 INFO: Configuration: Namespace(name='MACE_MPtrj_2022.9', seed=42, log_dir='data-train-result-stress-128/logs', model_dir='data-train-result-stress-128', checkpoints_dir='data-train-result-stress-128/checkpoints', results_dir='data-train-result-stress-128/results', downloads_dir='data-train-result-stress-128/downloads', default_dtype='float64', log_level='INFO', error_table='PerAtomMAEstress', model='ScaleShiftMACE', r_max=5.0, num_radial_basis=8, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='32x0e', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=True, compute_forces=True, train_file='./data-train-preprocessed/train.h5', valid_file='./data-train-preprocessed/valid.h5', valid_fraction=0.1, test_file=None, test_dir=None, num_workers=8, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file='./data-train-preprocessed/statistics.json', E0s=None, energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='stress-l1', forces_weight=1.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=10.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=32, valid_batch_size=32, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=140, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=True, restart_lr=0.0005, save_cpu=True, clip_grad=10.0, wandb=False, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-11-22 15:45:49.417 INFO: Using statistics json file
2023-11-22 15:45:49.417 INFO: Using atomic numbers from statistics file
2023-11-22 15:45:49.418 INFO: AtomicNumberTable: (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 89, 90, 91, 92, 93, 94)
2023-11-22 15:45:49.418 INFO: Atomic Energies not in training file, using command line argument E0s
2023-11-22 15:45:49.419 INFO: Atomic energies: [-3.6673775936325184, -1.321978574671279, -3.47815910592578, -4.724966512505185, -7.727941403300326, -8.404543836565129, -7.359429774977432, -7.284436081345614, -4.896162007436489, -0.03005797428312995, -2.7527187727369, -2.8138258116559136, -4.844369939040846, -7.6966307568316115, -6.96321292174237, -4.673811566998673, -2.813984104722163, -0.06233472731112788, -2.6251773081704863, -5.384791381758609, -7.916197568907359, -10.270820955634214, -8.672390387555845, -9.2371580345617, -8.305620224433062, -7.054671703876374, -5.570915377375696, -5.174147851464132, -3.251035550574451, -1.2879654275024013, -3.5321835252059812, -4.711328365973749, -3.9717755452456673, -3.886221455984922, -2.5183143168985502, 6.706842222672468, -2.566057480857263, -4.938993788294903, -10.153603816562159, -11.857062150232505, -12.14164656151253, -8.786094380920531, -8.795434431218645, -7.778351502991773, -6.838726494373795, -4.881216430056056, -2.0605586704343675, -0.6439905162993389, -2.788575343692543, -3.816810475940441, -3.587983770584603, -2.8805917608627976, -1.6360524330360255, 9.796001071919388, -2.7486371263604354, -4.986670776340143, -8.929476698318382, -8.74170685282431, -8.01217127881877, -8.233598378021814, -7.62454389634746, -8.161368139142393, -13.591451290378114, -18.538136714242995, -7.644552511106582, -8.115049752450005, -7.614570319217799, -6.82962645334957, -7.820026786949461, -3.5770491745130024, -7.469205400904766, -12.770648602823787, -14.110986902146283, -9.354405708044254, -11.376459286198285, -9.611613368883013, -7.321263077561875, -5.304305597659051, -2.3873175082519373, 0.24792131307789267, -2.31553585581406, -3.7254481655069127, -3.4301772252097935, -5.065907805804548, -11.017529306980132, -12.244262478240024, -13.846602972246156, -14.952721865054968, -15.303292182007306]
2023-11-22 15:45:49.480 INFO: WeightedEnergyForcesStressLossL1(energy_weight=1.000, forces_weight=1.000, stress_weight=10.000)
2023-11-22 15:45:49.480 INFO: Average number of neighbors: 25.57754135131836
2023-11-22 15:45:49.481 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': True, 'dipoles': False}
2023-11-22 15:45:49.481 INFO: Building model
2023-11-22 15:45:49.481 INFO: Hidden irreps: 128x0e + 128x1o
2023-11-22 15:45:52.282 INFO: Loading states from data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-112
2023-11-22 15:45:52.315 INFO: All model weights loaded successfully
2023-11-22 15:45:52.385 INFO: All optimizer states loaded successfully
2023-11-22 15:45:52.386 INFO: All scheduler states loaded successfully
2023-11-22 15:45:52.388 INFO: All random states loaded successfully
2023-11-22 15:45:52.389 INFO: Loading in 0 custom states
2023-11-22 15:45:52.390 INFO: DistributedDataParallel(
  (module): ScaleShiftMACE(
    (node_embedding): LinearNodeEmbeddingBlock(
      (linear): Linear(89x0e -> 128x0e | 11392 weights)
    )
    (radial_embedding): RadialEmbeddingBlock(
      (bessel_fn): BesselBasis(r_max=4.5, num_basis=8, trainable=False)
      (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
    )
    (spherical_harmonics): SphericalHarmonics()
    (atomic_energies_fn): AtomicEnergiesBlock(energies=[-3.6674, -1.3220, -3.4782, -4.7250, -7.7279, -8.4045, -7.3594, -7.2844, -4.8962, -0.0301, -2.7527, -2.8138, -4.8444, -7.6966, -6.9632, -4.6738, -2.8140, -0.0623, -2.6252, -5.3848, -7.9162, -10.2708, -8.6724, -9.2372, -8.3056, -7.0547, -5.5709, -5.1741, -3.2510, -1.2880, -3.5322, -4.7113, -3.9718, -3.8862, -2.5183, 6.7068, -2.5661, -4.9390, -10.1536, -11.8571, -12.1416, -8.7861, -8.7954, -7.7784, -6.8387, -4.8812, -2.0606, -0.6440, -2.7886, -3.8168, -3.5880, -2.8806, -1.6361, 9.7960, -2.7486, -4.9867, -8.9295, -8.7417, -8.0122, -8.2336, -7.6245, -8.1614, -13.5915, -18.5381, -7.6446, -8.1150, -7.6146, -6.8296, -7.8200, -3.5770, -7.4692, -12.7706, -14.1110, -9.3544, -11.3765, -9.6116, -7.3213, -5.3043, -2.3873, 0.2479, -2.3155, -3.7254, -3.4302, -5.0659, -11.0175, -12.2443, -13.8466, -14.9527, -15.3033])
    (interactions): ModuleList(
      (0): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
        (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 512]
        (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e x 89x0e -> 128x0e+128x1o | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
      (1): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
        (conv_tp): TensorProduct(128x0e+128x1o x 1x0e+1x1o+1x2e+1x3o -> 256x0e+384x1o+384x2e+256x3o | 1280 paths | 1280 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1280]
        (linear): Linear(256x0e+384x1o+384x2e+256x3o -> 128x0e+128x1o+128x2e+128x3o | 163840 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o x 89x0e -> 128x0e | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
    )
    (products): ModuleList(
      (0): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
            (1): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x6x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
      )
      (1): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e -> 128x0e | 16384 weights)
      )
    )
    (readouts): ModuleList(
      (0): LinearReadoutBlock(
        (linear): Linear(128x0e+128x1o -> 1x0e | 128 weights)
      )
      (1): NonLinearReadoutBlock(
        (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
        (non_linearity): Activation [x] (16x0e -> 16x0e)
        (linear_2): Linear(16x0e -> 1x0e | 16 weights)
      )
    )
    (scale_shift): ScaleShiftBlock(scale=0.804340, shift=0.164779)
  )
)
2023-11-22 15:45:52.394 INFO: Number of parameters: 4688400
2023-11-22 15:45:52.394 INFO: Optimizer: AcceleratedOptimizer (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: interactions_decay
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: interactions_no_decay
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: products
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2023-11-22 15:45:52.394 INFO: Using gradient clipping with tolerance=10.000
2023-11-22 15:45:52.394 INFO: Started training
2023-11-22 15:45:54.045 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-22 15:45:54.045 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-22 15:45:54.045 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-22 17:13:48.321 INFO: Epoch 112: loss=0.0024, MAE_E_per_atom=15.5 meV, MAE_F=58.9 meV / A, MAE_S_per_atom=0.3 meV / A^3
2023-11-22 17:13:48.324 INFO: Saving current state to data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-112
2023-11-22 17:13:48.416 INFO: Model weights saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-112/pytorch_model.bin
2023-11-22 17:13:48.597 INFO: Optimizer state saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-112/optimizer.bin
2023-11-22 17:13:48.600 INFO: Random states saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-112/random_states_0.pkl
2023-11-22 17:34:53.975 INFO: MACE version: 0.1.0
2023-11-22 17:34:53.975 INFO: Configuration: Namespace(name='MACE_MPtrj_2022.9', seed=42, log_dir='data-train-result-stress-128/logs', model_dir='data-train-result-stress-128', checkpoints_dir='data-train-result-stress-128/checkpoints', results_dir='data-train-result-stress-128/results', downloads_dir='data-train-result-stress-128/downloads', default_dtype='float64', log_level='INFO', error_table='PerAtomMAEstress', model='ScaleShiftMACE', r_max=5.0, num_radial_basis=8, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='32x0e', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=True, compute_forces=True, train_file='./data-train-preprocessed/train.h5', valid_file='./data-train-preprocessed/valid.h5', valid_fraction=0.1, test_file=None, test_dir=None, num_workers=8, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file='./data-train-preprocessed/statistics.json', E0s=None, energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='stress-l1', forces_weight=1.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=50.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=32, valid_batch_size=32, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=140, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=True, restart_lr=0.0005, save_cpu=True, clip_grad=10.0, wandb=False, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-11-22 17:34:53.975 INFO: Using statistics json file
2023-11-22 17:34:53.975 INFO: Using atomic numbers from statistics file
2023-11-22 17:34:53.976 INFO: AtomicNumberTable: (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 89, 90, 91, 92, 93, 94)
2023-11-22 17:34:53.976 INFO: Atomic Energies not in training file, using command line argument E0s
2023-11-22 17:34:53.977 INFO: Atomic energies: [-3.6673775936325184, -1.321978574671279, -3.47815910592578, -4.724966512505185, -7.727941403300326, -8.404543836565129, -7.359429774977432, -7.284436081345614, -4.896162007436489, -0.03005797428312995, -2.7527187727369, -2.8138258116559136, -4.844369939040846, -7.6966307568316115, -6.96321292174237, -4.673811566998673, -2.813984104722163, -0.06233472731112788, -2.6251773081704863, -5.384791381758609, -7.916197568907359, -10.270820955634214, -8.672390387555845, -9.2371580345617, -8.305620224433062, -7.054671703876374, -5.570915377375696, -5.174147851464132, -3.251035550574451, -1.2879654275024013, -3.5321835252059812, -4.711328365973749, -3.9717755452456673, -3.886221455984922, -2.5183143168985502, 6.706842222672468, -2.566057480857263, -4.938993788294903, -10.153603816562159, -11.857062150232505, -12.14164656151253, -8.786094380920531, -8.795434431218645, -7.778351502991773, -6.838726494373795, -4.881216430056056, -2.0605586704343675, -0.6439905162993389, -2.788575343692543, -3.816810475940441, -3.587983770584603, -2.8805917608627976, -1.6360524330360255, 9.796001071919388, -2.7486371263604354, -4.986670776340143, -8.929476698318382, -8.74170685282431, -8.01217127881877, -8.233598378021814, -7.62454389634746, -8.161368139142393, -13.591451290378114, -18.538136714242995, -7.644552511106582, -8.115049752450005, -7.614570319217799, -6.82962645334957, -7.820026786949461, -3.5770491745130024, -7.469205400904766, -12.770648602823787, -14.110986902146283, -9.354405708044254, -11.376459286198285, -9.611613368883013, -7.321263077561875, -5.304305597659051, -2.3873175082519373, 0.24792131307789267, -2.31553585581406, -3.7254481655069127, -3.4301772252097935, -5.065907805804548, -11.017529306980132, -12.244262478240024, -13.846602972246156, -14.952721865054968, -15.303292182007306]
2023-11-22 17:34:54.050 INFO: WeightedEnergyForcesStressLossL1(energy_weight=1.000, forces_weight=1.000, stress_weight=50.000)
2023-11-22 17:34:54.051 INFO: Average number of neighbors: 25.57754135131836
2023-11-22 17:34:54.051 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': True, 'dipoles': False}
2023-11-22 17:34:54.051 INFO: Building model
2023-11-22 17:34:54.051 INFO: Hidden irreps: 128x0e + 128x1o
2023-11-22 17:34:57.246 INFO: Loading states from data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-112
2023-11-22 17:34:57.279 INFO: All model weights loaded successfully
2023-11-22 17:34:57.349 INFO: All optimizer states loaded successfully
2023-11-22 17:34:57.350 INFO: All scheduler states loaded successfully
2023-11-22 17:34:57.352 INFO: All random states loaded successfully
2023-11-22 17:34:57.353 INFO: Loading in 0 custom states
2023-11-22 17:34:57.354 INFO: DistributedDataParallel(
  (module): ScaleShiftMACE(
    (node_embedding): LinearNodeEmbeddingBlock(
      (linear): Linear(89x0e -> 128x0e | 11392 weights)
    )
    (radial_embedding): RadialEmbeddingBlock(
      (bessel_fn): BesselBasis(r_max=4.5, num_basis=8, trainable=False)
      (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
    )
    (spherical_harmonics): SphericalHarmonics()
    (atomic_energies_fn): AtomicEnergiesBlock(energies=[-3.6674, -1.3220, -3.4782, -4.7250, -7.7279, -8.4045, -7.3594, -7.2844, -4.8962, -0.0301, -2.7527, -2.8138, -4.8444, -7.6966, -6.9632, -4.6738, -2.8140, -0.0623, -2.6252, -5.3848, -7.9162, -10.2708, -8.6724, -9.2372, -8.3056, -7.0547, -5.5709, -5.1741, -3.2510, -1.2880, -3.5322, -4.7113, -3.9718, -3.8862, -2.5183, 6.7068, -2.5661, -4.9390, -10.1536, -11.8571, -12.1416, -8.7861, -8.7954, -7.7784, -6.8387, -4.8812, -2.0606, -0.6440, -2.7886, -3.8168, -3.5880, -2.8806, -1.6361, 9.7960, -2.7486, -4.9867, -8.9295, -8.7417, -8.0122, -8.2336, -7.6245, -8.1614, -13.5915, -18.5381, -7.6446, -8.1150, -7.6146, -6.8296, -7.8200, -3.5770, -7.4692, -12.7706, -14.1110, -9.3544, -11.3765, -9.6116, -7.3213, -5.3043, -2.3873, 0.2479, -2.3155, -3.7254, -3.4302, -5.0659, -11.0175, -12.2443, -13.8466, -14.9527, -15.3033])
    (interactions): ModuleList(
      (0): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
        (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 512]
        (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e x 89x0e -> 128x0e+128x1o | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
      (1): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
        (conv_tp): TensorProduct(128x0e+128x1o x 1x0e+1x1o+1x2e+1x3o -> 256x0e+384x1o+384x2e+256x3o | 1280 paths | 1280 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1280]
        (linear): Linear(256x0e+384x1o+384x2e+256x3o -> 128x0e+128x1o+128x2e+128x3o | 163840 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o x 89x0e -> 128x0e | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
    )
    (products): ModuleList(
      (0): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
            (1): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x6x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
      )
      (1): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e -> 128x0e | 16384 weights)
      )
    )
    (readouts): ModuleList(
      (0): LinearReadoutBlock(
        (linear): Linear(128x0e+128x1o -> 1x0e | 128 weights)
      )
      (1): NonLinearReadoutBlock(
        (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
        (non_linearity): Activation [x] (16x0e -> 16x0e)
        (linear_2): Linear(16x0e -> 1x0e | 16 weights)
      )
    )
    (scale_shift): ScaleShiftBlock(scale=0.804340, shift=0.164779)
  )
)
2023-11-22 17:34:57.362 INFO: Number of parameters: 4688400
2023-11-22 17:34:57.363 INFO: Optimizer: AcceleratedOptimizer (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: interactions_decay
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: interactions_no_decay
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: products
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2023-11-22 17:34:57.363 INFO: Using gradient clipping with tolerance=10.000
2023-11-22 17:34:57.363 INFO: Started training
2023-11-22 17:34:59.188 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-22 17:34:59.188 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-22 17:34:59.188 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-22 17:34:59.188 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-22 18:44:20.709 INFO: Epoch 112: loss=0.0027, MAE_E_per_atom=15.9 meV, MAE_F=59.2 meV / A, MAE_S_per_atom=0.2 meV / A^3
2023-11-22 18:44:20.712 INFO: Saving current state to data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-112
2023-11-22 18:44:20.800 INFO: Model weights saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-112/pytorch_model.bin
2023-11-22 18:44:20.988 INFO: Optimizer state saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-112/optimizer.bin
2023-11-22 18:44:20.990 INFO: Random states saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-112/random_states_0.pkl
2023-11-22 20:58:06.991 INFO: Epoch 114: loss=0.0027, MAE_E_per_atom=15.7 meV, MAE_F=59.2 meV / A, MAE_S_per_atom=0.2 meV / A^3
2023-11-22 20:58:07.006 INFO: Saving current state to data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-114
2023-11-22 20:58:07.068 INFO: Model weights saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-114/pytorch_model.bin
2023-11-22 20:58:07.199 INFO: Optimizer state saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-114/optimizer.bin
2023-11-22 20:58:07.201 INFO: Random states saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-114/random_states_0.pkl
2023-11-22 23:20:37.139 INFO: Epoch 116: loss=0.0027, MAE_E_per_atom=15.7 meV, MAE_F=59.2 meV / A, MAE_S_per_atom=0.2 meV / A^3
2023-11-22 23:20:37.153 INFO: Saving current state to data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-116
2023-11-22 23:20:37.204 INFO: Model weights saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-116/pytorch_model.bin
2023-11-22 23:20:37.327 INFO: Optimizer state saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-116/optimizer.bin
2023-11-22 23:20:37.329 INFO: Random states saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-116/random_states_0.pkl
2023-11-23 01:58:35.834 INFO: Epoch 118: loss=0.0027, MAE_E_per_atom=15.7 meV, MAE_F=59.0 meV / A, MAE_S_per_atom=0.2 meV / A^3
2023-11-23 01:58:35.849 INFO: Saving current state to data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-118
2023-11-23 01:58:35.908 INFO: Model weights saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-118/pytorch_model.bin
2023-11-23 01:58:36.034 INFO: Optimizer state saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-118/optimizer.bin
2023-11-23 01:58:36.036 INFO: Random states saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-118/random_states_0.pkl
2023-11-23 05:00:19.618 INFO: Epoch 120: loss=0.0027, MAE_E_per_atom=15.6 meV, MAE_F=59.0 meV / A, MAE_S_per_atom=0.2 meV / A^3
2023-11-23 05:00:19.630 INFO: Saving current state to data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-120
2023-11-23 05:00:19.673 INFO: Model weights saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-120/pytorch_model.bin
2023-11-23 05:00:19.765 INFO: Optimizer state saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-120/optimizer.bin
2023-11-23 05:00:19.766 INFO: Random states saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-120/random_states_0.pkl
2023-11-23 08:16:39.030 INFO: MACE version: 0.1.0
2023-11-23 08:16:39.030 INFO: Configuration: Namespace(name='MACE_MPtrj_2022.9', seed=42, log_dir='data-train-result-stress-128/logs', model_dir='data-train-result-stress-128', checkpoints_dir='data-train-result-stress-128/checkpoints', results_dir='data-train-result-stress-128/results', downloads_dir='data-train-result-stress-128/downloads', default_dtype='float64', log_level='INFO', error_table='PerAtomMAEstress', model='ScaleShiftMACE', r_max=5.0, num_radial_basis=8, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='32x0e', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=True, compute_forces=True, train_file='./data-train-preprocessed/train.h5', valid_file='./data-train-preprocessed/valid.h5', valid_fraction=0.1, test_file=None, test_dir=None, num_workers=8, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file='./data-train-preprocessed/statistics.json', E0s=None, energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='stress-l1', forces_weight=1.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=100.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=32, valid_batch_size=32, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=140, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=True, restart_lr=0.0005, save_cpu=True, clip_grad=10.0, wandb=False, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-11-23 08:16:39.030 INFO: Using statistics json file
2023-11-23 08:16:39.030 INFO: Using atomic numbers from statistics file
2023-11-23 08:16:39.031 INFO: AtomicNumberTable: (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 89, 90, 91, 92, 93, 94)
2023-11-23 08:16:39.031 INFO: Atomic Energies not in training file, using command line argument E0s
2023-11-23 08:16:39.031 INFO: Atomic energies: [-3.6673775936325184, -1.321978574671279, -3.47815910592578, -4.724966512505185, -7.727941403300326, -8.404543836565129, -7.359429774977432, -7.284436081345614, -4.896162007436489, -0.03005797428312995, -2.7527187727369, -2.8138258116559136, -4.844369939040846, -7.6966307568316115, -6.96321292174237, -4.673811566998673, -2.813984104722163, -0.06233472731112788, -2.6251773081704863, -5.384791381758609, -7.916197568907359, -10.270820955634214, -8.672390387555845, -9.2371580345617, -8.305620224433062, -7.054671703876374, -5.570915377375696, -5.174147851464132, -3.251035550574451, -1.2879654275024013, -3.5321835252059812, -4.711328365973749, -3.9717755452456673, -3.886221455984922, -2.5183143168985502, 6.706842222672468, -2.566057480857263, -4.938993788294903, -10.153603816562159, -11.857062150232505, -12.14164656151253, -8.786094380920531, -8.795434431218645, -7.778351502991773, -6.838726494373795, -4.881216430056056, -2.0605586704343675, -0.6439905162993389, -2.788575343692543, -3.816810475940441, -3.587983770584603, -2.8805917608627976, -1.6360524330360255, 9.796001071919388, -2.7486371263604354, -4.986670776340143, -8.929476698318382, -8.74170685282431, -8.01217127881877, -8.233598378021814, -7.62454389634746, -8.161368139142393, -13.591451290378114, -18.538136714242995, -7.644552511106582, -8.115049752450005, -7.614570319217799, -6.82962645334957, -7.820026786949461, -3.5770491745130024, -7.469205400904766, -12.770648602823787, -14.110986902146283, -9.354405708044254, -11.376459286198285, -9.611613368883013, -7.321263077561875, -5.304305597659051, -2.3873175082519373, 0.24792131307789267, -2.31553585581406, -3.7254481655069127, -3.4301772252097935, -5.065907805804548, -11.017529306980132, -12.244262478240024, -13.846602972246156, -14.952721865054968, -15.303292182007306]
2023-11-23 08:16:39.088 INFO: WeightedEnergyForcesStressLossL1(energy_weight=1.000, forces_weight=1.000, stress_weight=100.000)
2023-11-23 08:16:39.089 INFO: Average number of neighbors: 25.57754135131836
2023-11-23 08:16:39.089 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': True, 'dipoles': False}
2023-11-23 08:16:39.089 INFO: Building model
2023-11-23 08:16:39.089 INFO: Hidden irreps: 128x0e + 128x1o
2023-11-23 08:16:42.243 INFO: Loading states from data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-120
2023-11-23 08:16:42.273 INFO: All model weights loaded successfully
2023-11-23 08:16:42.340 INFO: All optimizer states loaded successfully
2023-11-23 08:16:42.340 INFO: All scheduler states loaded successfully
2023-11-23 08:16:42.343 INFO: All random states loaded successfully
2023-11-23 08:16:42.344 INFO: Loading in 0 custom states
2023-11-23 08:16:42.344 INFO: DistributedDataParallel(
  (module): ScaleShiftMACE(
    (node_embedding): LinearNodeEmbeddingBlock(
      (linear): Linear(89x0e -> 128x0e | 11392 weights)
    )
    (radial_embedding): RadialEmbeddingBlock(
      (bessel_fn): BesselBasis(r_max=4.5, num_basis=8, trainable=False)
      (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
    )
    (spherical_harmonics): SphericalHarmonics()
    (atomic_energies_fn): AtomicEnergiesBlock(energies=[-3.6674, -1.3220, -3.4782, -4.7250, -7.7279, -8.4045, -7.3594, -7.2844, -4.8962, -0.0301, -2.7527, -2.8138, -4.8444, -7.6966, -6.9632, -4.6738, -2.8140, -0.0623, -2.6252, -5.3848, -7.9162, -10.2708, -8.6724, -9.2372, -8.3056, -7.0547, -5.5709, -5.1741, -3.2510, -1.2880, -3.5322, -4.7113, -3.9718, -3.8862, -2.5183, 6.7068, -2.5661, -4.9390, -10.1536, -11.8571, -12.1416, -8.7861, -8.7954, -7.7784, -6.8387, -4.8812, -2.0606, -0.6440, -2.7886, -3.8168, -3.5880, -2.8806, -1.6361, 9.7960, -2.7486, -4.9867, -8.9295, -8.7417, -8.0122, -8.2336, -7.6245, -8.1614, -13.5915, -18.5381, -7.6446, -8.1150, -7.6146, -6.8296, -7.8200, -3.5770, -7.4692, -12.7706, -14.1110, -9.3544, -11.3765, -9.6116, -7.3213, -5.3043, -2.3873, 0.2479, -2.3155, -3.7254, -3.4302, -5.0659, -11.0175, -12.2443, -13.8466, -14.9527, -15.3033])
    (interactions): ModuleList(
      (0): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
        (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 512]
        (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e x 89x0e -> 128x0e+128x1o | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
      (1): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
        (conv_tp): TensorProduct(128x0e+128x1o x 1x0e+1x1o+1x2e+1x3o -> 256x0e+384x1o+384x2e+256x3o | 1280 paths | 1280 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1280]
        (linear): Linear(256x0e+384x1o+384x2e+256x3o -> 128x0e+128x1o+128x2e+128x3o | 163840 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o x 89x0e -> 128x0e | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
    )
    (products): ModuleList(
      (0): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
            (1): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x6x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
      )
      (1): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e -> 128x0e | 16384 weights)
      )
    )
    (readouts): ModuleList(
      (0): LinearReadoutBlock(
        (linear): Linear(128x0e+128x1o -> 1x0e | 128 weights)
      )
      (1): NonLinearReadoutBlock(
        (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
        (non_linearity): Activation [x] (16x0e -> 16x0e)
        (linear_2): Linear(16x0e -> 1x0e | 16 weights)
      )
    )
    (scale_shift): ScaleShiftBlock(scale=0.804340, shift=0.164779)
  )
)
2023-11-23 08:16:42.349 INFO: Number of parameters: 4688400
2023-11-23 08:16:42.349 INFO: Optimizer: AcceleratedOptimizer (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: interactions_decay
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: interactions_no_decay
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: products
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2023-11-23 08:16:42.349 INFO: Using gradient clipping with tolerance=10.000
2023-11-23 08:16:42.349 INFO: Started training
2023-11-23 08:16:44.211 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-23 08:16:44.212 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-23 08:16:44.212 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-23 08:16:44.212 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-23 09:26:01.453 INFO: Epoch 120: loss=0.0030, MAE_E_per_atom=16.0 meV, MAE_F=59.4 meV / A, MAE_S_per_atom=0.2 meV / A^3
2023-11-23 09:26:01.455 INFO: Saving current state to data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-120
2023-11-23 09:26:01.524 INFO: Model weights saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-120/pytorch_model.bin
2023-11-23 09:26:01.716 INFO: Optimizer state saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-120/optimizer.bin
2023-11-23 09:26:01.720 INFO: Random states saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-120/random_states_0.pkl
2023-11-23 10:30:01.965 INFO: MACE version: 0.1.0
2023-11-23 10:30:01.966 INFO: Configuration: Namespace(name='MACE_MPtrj_2022.9', seed=42, log_dir='data-train-result-stress-128/logs', model_dir='data-train-result-stress-128', checkpoints_dir='data-train-result-stress-128/checkpoints', results_dir='data-train-result-stress-128/results', downloads_dir='data-train-result-stress-128/downloads', default_dtype='float64', log_level='INFO', error_table='PerAtomMAEstress', model='ScaleShiftMACE', r_max=5.0, num_radial_basis=8, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='32x0e', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=True, compute_forces=True, train_file='./data-train-preprocessed/train.h5', valid_file='./data-train-preprocessed/valid.h5', valid_fraction=0.1, test_file=None, test_dir=None, num_workers=8, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file='./data-train-preprocessed/statistics.json', E0s=None, energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='stress-l1', forces_weight=1.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=100.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=32, valid_batch_size=32, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=140, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=True, restart_lr=0.0005, save_cpu=True, clip_grad=10.0, wandb=False, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-11-23 10:30:01.966 INFO: Using statistics json file
2023-11-23 10:30:01.966 INFO: Using atomic numbers from statistics file
2023-11-23 10:30:01.967 INFO: AtomicNumberTable: (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 89, 90, 91, 92, 93, 94)
2023-11-23 10:30:01.967 INFO: Atomic Energies not in training file, using command line argument E0s
2023-11-23 10:30:01.967 INFO: Atomic energies: [-3.6673775936325184, -1.321978574671279, -3.47815910592578, -4.724966512505185, -7.727941403300326, -8.404543836565129, -7.359429774977432, -7.284436081345614, -4.896162007436489, -0.03005797428312995, -2.7527187727369, -2.8138258116559136, -4.844369939040846, -7.6966307568316115, -6.96321292174237, -4.673811566998673, -2.813984104722163, -0.06233472731112788, -2.6251773081704863, -5.384791381758609, -7.916197568907359, -10.270820955634214, -8.672390387555845, -9.2371580345617, -8.305620224433062, -7.054671703876374, -5.570915377375696, -5.174147851464132, -3.251035550574451, -1.2879654275024013, -3.5321835252059812, -4.711328365973749, -3.9717755452456673, -3.886221455984922, -2.5183143168985502, 6.706842222672468, -2.566057480857263, -4.938993788294903, -10.153603816562159, -11.857062150232505, -12.14164656151253, -8.786094380920531, -8.795434431218645, -7.778351502991773, -6.838726494373795, -4.881216430056056, -2.0605586704343675, -0.6439905162993389, -2.788575343692543, -3.816810475940441, -3.587983770584603, -2.8805917608627976, -1.6360524330360255, 9.796001071919388, -2.7486371263604354, -4.986670776340143, -8.929476698318382, -8.74170685282431, -8.01217127881877, -8.233598378021814, -7.62454389634746, -8.161368139142393, -13.591451290378114, -18.538136714242995, -7.644552511106582, -8.115049752450005, -7.614570319217799, -6.82962645334957, -7.820026786949461, -3.5770491745130024, -7.469205400904766, -12.770648602823787, -14.110986902146283, -9.354405708044254, -11.376459286198285, -9.611613368883013, -7.321263077561875, -5.304305597659051, -2.3873175082519373, 0.24792131307789267, -2.31553585581406, -3.7254481655069127, -3.4301772252097935, -5.065907805804548, -11.017529306980132, -12.244262478240024, -13.846602972246156, -14.952721865054968, -15.303292182007306]
2023-11-23 10:30:02.033 INFO: WeightedEnergyForcesStressLossL1(energy_weight=1.000, forces_weight=1.000, stress_weight=100.000)
2023-11-23 10:30:02.033 INFO: Average number of neighbors: 25.57754135131836
2023-11-23 10:30:02.033 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': True, 'dipoles': False}
2023-11-23 10:30:02.033 INFO: Building model
2023-11-23 10:30:02.033 INFO: Hidden irreps: 128x0e + 128x1o
2023-11-23 10:30:05.578 INFO: Loading states from data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-120
2023-11-23 10:30:05.611 INFO: All model weights loaded successfully
2023-11-23 10:30:05.680 INFO: All optimizer states loaded successfully
2023-11-23 10:30:05.680 INFO: All scheduler states loaded successfully
2023-11-23 10:30:05.683 INFO: All random states loaded successfully
2023-11-23 10:30:05.684 INFO: Loading in 0 custom states
2023-11-23 10:30:05.684 INFO: DistributedDataParallel(
  (module): ScaleShiftMACE(
    (node_embedding): LinearNodeEmbeddingBlock(
      (linear): Linear(89x0e -> 128x0e | 11392 weights)
    )
    (radial_embedding): RadialEmbeddingBlock(
      (bessel_fn): BesselBasis(r_max=4.5, num_basis=8, trainable=False)
      (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
    )
    (spherical_harmonics): SphericalHarmonics()
    (atomic_energies_fn): AtomicEnergiesBlock(energies=[-3.6674, -1.3220, -3.4782, -4.7250, -7.7279, -8.4045, -7.3594, -7.2844, -4.8962, -0.0301, -2.7527, -2.8138, -4.8444, -7.6966, -6.9632, -4.6738, -2.8140, -0.0623, -2.6252, -5.3848, -7.9162, -10.2708, -8.6724, -9.2372, -8.3056, -7.0547, -5.5709, -5.1741, -3.2510, -1.2880, -3.5322, -4.7113, -3.9718, -3.8862, -2.5183, 6.7068, -2.5661, -4.9390, -10.1536, -11.8571, -12.1416, -8.7861, -8.7954, -7.7784, -6.8387, -4.8812, -2.0606, -0.6440, -2.7886, -3.8168, -3.5880, -2.8806, -1.6361, 9.7960, -2.7486, -4.9867, -8.9295, -8.7417, -8.0122, -8.2336, -7.6245, -8.1614, -13.5915, -18.5381, -7.6446, -8.1150, -7.6146, -6.8296, -7.8200, -3.5770, -7.4692, -12.7706, -14.1110, -9.3544, -11.3765, -9.6116, -7.3213, -5.3043, -2.3873, 0.2479, -2.3155, -3.7254, -3.4302, -5.0659, -11.0175, -12.2443, -13.8466, -14.9527, -15.3033])
    (interactions): ModuleList(
      (0): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
        (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 512]
        (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e x 89x0e -> 128x0e+128x1o | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
      (1): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
        (conv_tp): TensorProduct(128x0e+128x1o x 1x0e+1x1o+1x2e+1x3o -> 256x0e+384x1o+384x2e+256x3o | 1280 paths | 1280 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1280]
        (linear): Linear(256x0e+384x1o+384x2e+256x3o -> 128x0e+128x1o+128x2e+128x3o | 163840 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o x 89x0e -> 128x0e | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
    )
    (products): ModuleList(
      (0): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
            (1): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x6x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
      )
      (1): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e -> 128x0e | 16384 weights)
      )
    )
    (readouts): ModuleList(
      (0): LinearReadoutBlock(
        (linear): Linear(128x0e+128x1o -> 1x0e | 128 weights)
      )
      (1): NonLinearReadoutBlock(
        (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
        (non_linearity): Activation [x] (16x0e -> 16x0e)
        (linear_2): Linear(16x0e -> 1x0e | 16 weights)
      )
    )
    (scale_shift): ScaleShiftBlock(scale=0.804340, shift=0.164779)
  )
)
2023-11-23 10:30:05.689 INFO: Number of parameters: 4688400
2023-11-23 10:30:05.689 INFO: Optimizer: AcceleratedOptimizer (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: interactions_decay
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: interactions_no_decay
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: products
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2023-11-23 10:30:05.689 INFO: Using gradient clipping with tolerance=10.000
2023-11-23 10:30:05.689 INFO: Started training
2023-11-23 10:30:07.921 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-23 10:30:07.921 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-23 10:30:07.921 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-23 11:59:07.478 INFO: Epoch 120: loss=0.0030, MAE_E_per_atom=16.2 meV, MAE_F=59.7 meV / A, MAE_S_per_atom=0.2 meV / A^3
2023-11-23 11:59:07.481 INFO: Saving current state to data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-120
2023-11-23 11:59:07.569 INFO: Model weights saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-120/pytorch_model.bin
2023-11-23 11:59:07.784 INFO: Optimizer state saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-120/optimizer.bin
2023-11-23 11:59:07.789 INFO: Random states saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-120/random_states_0.pkl
2023-11-23 14:59:41.816 INFO: Epoch 122: loss=0.0030, MAE_E_per_atom=16.2 meV, MAE_F=59.7 meV / A, MAE_S_per_atom=0.2 meV / A^3
2023-11-23 14:59:41.835 INFO: Saving current state to data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-122
2023-11-23 14:59:41.896 INFO: Model weights saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-122/pytorch_model.bin
2023-11-23 14:59:42.027 INFO: Optimizer state saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-122/optimizer.bin
2023-11-23 14:59:42.029 INFO: Random states saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-122/random_states_0.pkl
2023-11-23 16:09:59.006 INFO: MACE version: 0.1.0
2023-11-23 16:09:59.006 INFO: Configuration: Namespace(name='MACE_MPtrj_2022.9', seed=42, log_dir='data-train-result-stress-128/logs', model_dir='data-train-result-stress-128', checkpoints_dir='data-train-result-stress-128/checkpoints', results_dir='data-train-result-stress-128/results', downloads_dir='data-train-result-stress-128/downloads', default_dtype='float64', log_level='INFO', error_table='PerAtomMAEstress', model='ScaleShiftMACE', r_max=5.0, num_radial_basis=8, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='32x0e', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=True, compute_forces=True, train_file='./data-train-preprocessed/train.h5', valid_file='./data-train-preprocessed/valid.h5', valid_fraction=0.1, test_file=None, test_dir=None, num_workers=8, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file='./data-train-preprocessed/statistics.json', E0s=None, energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='stress-l1', forces_weight=1.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=100.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=32, valid_batch_size=32, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=140, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=True, restart_lr=0.0005, save_cpu=True, clip_grad=10.0, wandb=False, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-11-23 16:09:59.007 INFO: Using statistics json file
2023-11-23 16:09:59.007 INFO: Using atomic numbers from statistics file
2023-11-23 16:09:59.007 INFO: AtomicNumberTable: (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 89, 90, 91, 92, 93, 94)
2023-11-23 16:09:59.007 INFO: Atomic Energies not in training file, using command line argument E0s
2023-11-23 16:09:59.008 INFO: Atomic energies: [-3.6673775936325184, -1.321978574671279, -3.47815910592578, -4.724966512505185, -7.727941403300326, -8.404543836565129, -7.359429774977432, -7.284436081345614, -4.896162007436489, -0.03005797428312995, -2.7527187727369, -2.8138258116559136, -4.844369939040846, -7.6966307568316115, -6.96321292174237, -4.673811566998673, -2.813984104722163, -0.06233472731112788, -2.6251773081704863, -5.384791381758609, -7.916197568907359, -10.270820955634214, -8.672390387555845, -9.2371580345617, -8.305620224433062, -7.054671703876374, -5.570915377375696, -5.174147851464132, -3.251035550574451, -1.2879654275024013, -3.5321835252059812, -4.711328365973749, -3.9717755452456673, -3.886221455984922, -2.5183143168985502, 6.706842222672468, -2.566057480857263, -4.938993788294903, -10.153603816562159, -11.857062150232505, -12.14164656151253, -8.786094380920531, -8.795434431218645, -7.778351502991773, -6.838726494373795, -4.881216430056056, -2.0605586704343675, -0.6439905162993389, -2.788575343692543, -3.816810475940441, -3.587983770584603, -2.8805917608627976, -1.6360524330360255, 9.796001071919388, -2.7486371263604354, -4.986670776340143, -8.929476698318382, -8.74170685282431, -8.01217127881877, -8.233598378021814, -7.62454389634746, -8.161368139142393, -13.591451290378114, -18.538136714242995, -7.644552511106582, -8.115049752450005, -7.614570319217799, -6.82962645334957, -7.820026786949461, -3.5770491745130024, -7.469205400904766, -12.770648602823787, -14.110986902146283, -9.354405708044254, -11.376459286198285, -9.611613368883013, -7.321263077561875, -5.304305597659051, -2.3873175082519373, 0.24792131307789267, -2.31553585581406, -3.7254481655069127, -3.4301772252097935, -5.065907805804548, -11.017529306980132, -12.244262478240024, -13.846602972246156, -14.952721865054968, -15.303292182007306]
2023-11-23 16:09:59.063 INFO: WeightedEnergyForcesStressLossL1(energy_weight=1.000, forces_weight=1.000, stress_weight=100.000)
2023-11-23 16:09:59.064 INFO: Average number of neighbors: 25.57754135131836
2023-11-23 16:09:59.064 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': True, 'dipoles': False}
2023-11-23 16:09:59.064 INFO: Building model
2023-11-23 16:09:59.064 INFO: Hidden irreps: 128x0e + 128x1o
2023-11-23 16:10:01.855 INFO: Loading states from data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-122
2023-11-23 16:10:01.886 INFO: All model weights loaded successfully
2023-11-23 16:10:01.952 INFO: All optimizer states loaded successfully
2023-11-23 16:10:01.952 INFO: All scheduler states loaded successfully
2023-11-23 16:10:01.955 INFO: All random states loaded successfully
2023-11-23 16:10:01.955 INFO: Loading in 0 custom states
2023-11-23 16:10:01.956 INFO: DistributedDataParallel(
  (module): ScaleShiftMACE(
    (node_embedding): LinearNodeEmbeddingBlock(
      (linear): Linear(89x0e -> 128x0e | 11392 weights)
    )
    (radial_embedding): RadialEmbeddingBlock(
      (bessel_fn): BesselBasis(r_max=4.5, num_basis=8, trainable=False)
      (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
    )
    (spherical_harmonics): SphericalHarmonics()
    (atomic_energies_fn): AtomicEnergiesBlock(energies=[-3.6674, -1.3220, -3.4782, -4.7250, -7.7279, -8.4045, -7.3594, -7.2844, -4.8962, -0.0301, -2.7527, -2.8138, -4.8444, -7.6966, -6.9632, -4.6738, -2.8140, -0.0623, -2.6252, -5.3848, -7.9162, -10.2708, -8.6724, -9.2372, -8.3056, -7.0547, -5.5709, -5.1741, -3.2510, -1.2880, -3.5322, -4.7113, -3.9718, -3.8862, -2.5183, 6.7068, -2.5661, -4.9390, -10.1536, -11.8571, -12.1416, -8.7861, -8.7954, -7.7784, -6.8387, -4.8812, -2.0606, -0.6440, -2.7886, -3.8168, -3.5880, -2.8806, -1.6361, 9.7960, -2.7486, -4.9867, -8.9295, -8.7417, -8.0122, -8.2336, -7.6245, -8.1614, -13.5915, -18.5381, -7.6446, -8.1150, -7.6146, -6.8296, -7.8200, -3.5770, -7.4692, -12.7706, -14.1110, -9.3544, -11.3765, -9.6116, -7.3213, -5.3043, -2.3873, 0.2479, -2.3155, -3.7254, -3.4302, -5.0659, -11.0175, -12.2443, -13.8466, -14.9527, -15.3033])
    (interactions): ModuleList(
      (0): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
        (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 512]
        (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e x 89x0e -> 128x0e+128x1o | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
      (1): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
        (conv_tp): TensorProduct(128x0e+128x1o x 1x0e+1x1o+1x2e+1x3o -> 256x0e+384x1o+384x2e+256x3o | 1280 paths | 1280 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1280]
        (linear): Linear(256x0e+384x1o+384x2e+256x3o -> 128x0e+128x1o+128x2e+128x3o | 163840 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o x 89x0e -> 128x0e | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
    )
    (products): ModuleList(
      (0): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
            (1): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x6x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
      )
      (1): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e -> 128x0e | 16384 weights)
      )
    )
    (readouts): ModuleList(
      (0): LinearReadoutBlock(
        (linear): Linear(128x0e+128x1o -> 1x0e | 128 weights)
      )
      (1): NonLinearReadoutBlock(
        (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
        (non_linearity): Activation [x] (16x0e -> 16x0e)
        (linear_2): Linear(16x0e -> 1x0e | 16 weights)
      )
    )
    (scale_shift): ScaleShiftBlock(scale=0.804340, shift=0.164779)
  )
)
2023-11-23 16:10:01.960 INFO: Number of parameters: 4688400
2023-11-23 16:10:01.960 INFO: Optimizer: AcceleratedOptimizer (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: interactions_decay
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: interactions_no_decay
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: products
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2023-11-23 16:10:01.960 INFO: Using gradient clipping with tolerance=10.000
2023-11-23 16:10:01.961 INFO: Started training
2023-11-23 16:10:03.594 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-23 16:10:03.594 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-23 16:10:03.595 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-23 17:15:26.086 INFO: MACE version: 0.1.0
2023-11-23 17:15:26.087 INFO: Configuration: Namespace(name='MACE_MPtrj_2022.9', seed=42, log_dir='data-train-result-stress-128/logs', model_dir='data-train-result-stress-128', checkpoints_dir='data-train-result-stress-128/checkpoints', results_dir='data-train-result-stress-128/results', downloads_dir='data-train-result-stress-128/downloads', default_dtype='float64', log_level='INFO', error_table='PerAtomMAEstress', model='ScaleShiftMACE', r_max=5.0, num_radial_basis=8, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='32x0e', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=True, compute_forces=True, train_file='./data-train-preprocessed/train.h5', valid_file='./data-train-preprocessed/valid.h5', valid_fraction=0.1, test_file=None, test_dir=None, num_workers=8, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file='./data-train-preprocessed/statistics.json', E0s=None, energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='stress-l1', forces_weight=1.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=100.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=32, valid_batch_size=32, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=140, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=True, restart_lr=0.0005, save_cpu=True, clip_grad=10.0, wandb=False, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-11-23 17:15:26.087 INFO: Using statistics json file
2023-11-23 17:15:26.087 INFO: Using atomic numbers from statistics file
2023-11-23 17:15:26.087 INFO: AtomicNumberTable: (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 89, 90, 91, 92, 93, 94)
2023-11-23 17:15:26.087 INFO: Atomic Energies not in training file, using command line argument E0s
2023-11-23 17:15:26.088 INFO: Atomic energies: [-3.6673775936325184, -1.321978574671279, -3.47815910592578, -4.724966512505185, -7.727941403300326, -8.404543836565129, -7.359429774977432, -7.284436081345614, -4.896162007436489, -0.03005797428312995, -2.7527187727369, -2.8138258116559136, -4.844369939040846, -7.6966307568316115, -6.96321292174237, -4.673811566998673, -2.813984104722163, -0.06233472731112788, -2.6251773081704863, -5.384791381758609, -7.916197568907359, -10.270820955634214, -8.672390387555845, -9.2371580345617, -8.305620224433062, -7.054671703876374, -5.570915377375696, -5.174147851464132, -3.251035550574451, -1.2879654275024013, -3.5321835252059812, -4.711328365973749, -3.9717755452456673, -3.886221455984922, -2.5183143168985502, 6.706842222672468, -2.566057480857263, -4.938993788294903, -10.153603816562159, -11.857062150232505, -12.14164656151253, -8.786094380920531, -8.795434431218645, -7.778351502991773, -6.838726494373795, -4.881216430056056, -2.0605586704343675, -0.6439905162993389, -2.788575343692543, -3.816810475940441, -3.587983770584603, -2.8805917608627976, -1.6360524330360255, 9.796001071919388, -2.7486371263604354, -4.986670776340143, -8.929476698318382, -8.74170685282431, -8.01217127881877, -8.233598378021814, -7.62454389634746, -8.161368139142393, -13.591451290378114, -18.538136714242995, -7.644552511106582, -8.115049752450005, -7.614570319217799, -6.82962645334957, -7.820026786949461, -3.5770491745130024, -7.469205400904766, -12.770648602823787, -14.110986902146283, -9.354405708044254, -11.376459286198285, -9.611613368883013, -7.321263077561875, -5.304305597659051, -2.3873175082519373, 0.24792131307789267, -2.31553585581406, -3.7254481655069127, -3.4301772252097935, -5.065907805804548, -11.017529306980132, -12.244262478240024, -13.846602972246156, -14.952721865054968, -15.303292182007306]
2023-11-23 17:15:26.134 INFO: WeightedEnergyForcesStressLossL1(energy_weight=1.000, forces_weight=1.000, stress_weight=100.000)
2023-11-23 17:15:26.134 INFO: Average number of neighbors: 25.57754135131836
2023-11-23 17:15:26.134 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': True, 'dipoles': False}
2023-11-23 17:15:26.134 INFO: Building model
2023-11-23 17:15:26.134 INFO: Hidden irreps: 128x0e + 128x1o
2023-11-23 17:15:29.307 INFO: Loading states from data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-122
2023-11-23 17:15:29.339 INFO: All model weights loaded successfully
2023-11-23 17:15:29.410 INFO: All optimizer states loaded successfully
2023-11-23 17:15:29.410 INFO: All scheduler states loaded successfully
2023-11-23 17:15:29.413 INFO: All random states loaded successfully
2023-11-23 17:15:29.413 INFO: Loading in 0 custom states
2023-11-23 17:15:29.414 INFO: DistributedDataParallel(
  (module): ScaleShiftMACE(
    (node_embedding): LinearNodeEmbeddingBlock(
      (linear): Linear(89x0e -> 128x0e | 11392 weights)
    )
    (radial_embedding): RadialEmbeddingBlock(
      (bessel_fn): BesselBasis(r_max=4.5, num_basis=8, trainable=False)
      (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
    )
    (spherical_harmonics): SphericalHarmonics()
    (atomic_energies_fn): AtomicEnergiesBlock(energies=[-3.6674, -1.3220, -3.4782, -4.7250, -7.7279, -8.4045, -7.3594, -7.2844, -4.8962, -0.0301, -2.7527, -2.8138, -4.8444, -7.6966, -6.9632, -4.6738, -2.8140, -0.0623, -2.6252, -5.3848, -7.9162, -10.2708, -8.6724, -9.2372, -8.3056, -7.0547, -5.5709, -5.1741, -3.2510, -1.2880, -3.5322, -4.7113, -3.9718, -3.8862, -2.5183, 6.7068, -2.5661, -4.9390, -10.1536, -11.8571, -12.1416, -8.7861, -8.7954, -7.7784, -6.8387, -4.8812, -2.0606, -0.6440, -2.7886, -3.8168, -3.5880, -2.8806, -1.6361, 9.7960, -2.7486, -4.9867, -8.9295, -8.7417, -8.0122, -8.2336, -7.6245, -8.1614, -13.5915, -18.5381, -7.6446, -8.1150, -7.6146, -6.8296, -7.8200, -3.5770, -7.4692, -12.7706, -14.1110, -9.3544, -11.3765, -9.6116, -7.3213, -5.3043, -2.3873, 0.2479, -2.3155, -3.7254, -3.4302, -5.0659, -11.0175, -12.2443, -13.8466, -14.9527, -15.3033])
    (interactions): ModuleList(
      (0): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
        (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 512]
        (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e x 89x0e -> 128x0e+128x1o | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
      (1): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
        (conv_tp): TensorProduct(128x0e+128x1o x 1x0e+1x1o+1x2e+1x3o -> 256x0e+384x1o+384x2e+256x3o | 1280 paths | 1280 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1280]
        (linear): Linear(256x0e+384x1o+384x2e+256x3o -> 128x0e+128x1o+128x2e+128x3o | 163840 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o x 89x0e -> 128x0e | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
    )
    (products): ModuleList(
      (0): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
            (1): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x6x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
      )
      (1): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e -> 128x0e | 16384 weights)
      )
    )
    (readouts): ModuleList(
      (0): LinearReadoutBlock(
        (linear): Linear(128x0e+128x1o -> 1x0e | 128 weights)
      )
      (1): NonLinearReadoutBlock(
        (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
        (non_linearity): Activation [x] (16x0e -> 16x0e)
        (linear_2): Linear(16x0e -> 1x0e | 16 weights)
      )
    )
    (scale_shift): ScaleShiftBlock(scale=0.804340, shift=0.164779)
  )
)
2023-11-23 17:15:29.418 INFO: Number of parameters: 4688400
2023-11-23 17:15:29.418 INFO: Optimizer: AcceleratedOptimizer (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: interactions_decay
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: interactions_no_decay
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: products
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2023-11-23 17:15:29.418 INFO: Using gradient clipping with tolerance=10.000
2023-11-23 17:15:29.418 INFO: Started training
2023-11-23 17:15:31.353 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-23 17:15:31.353 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-23 17:15:31.353 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-23 17:15:31.353 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-23 18:24:30.259 INFO: Epoch 122: loss=0.0030, MAE_E_per_atom=16.0 meV, MAE_F=59.5 meV / A, MAE_S_per_atom=0.2 meV / A^3
2023-11-23 18:24:30.261 INFO: Saving current state to data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-122
2023-11-23 18:24:30.335 INFO: Model weights saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-122/pytorch_model.bin
2023-11-23 18:24:30.536 INFO: Optimizer state saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-122/optimizer.bin
2023-11-23 18:24:30.540 INFO: Random states saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-122/random_states_0.pkl
2023-11-23 20:37:58.080 INFO: Epoch 124: loss=0.0029, MAE_E_per_atom=16.0 meV, MAE_F=59.4 meV / A, MAE_S_per_atom=0.2 meV / A^3
2023-11-23 20:37:58.093 INFO: Saving current state to data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-124
2023-11-23 20:37:58.142 INFO: Model weights saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-124/pytorch_model.bin
2023-11-23 20:37:58.261 INFO: Optimizer state saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-124/optimizer.bin
2023-11-23 20:37:58.262 INFO: Random states saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-124/random_states_0.pkl
2023-11-23 23:00:05.531 INFO: Epoch 126: loss=0.0029, MAE_E_per_atom=15.9 meV, MAE_F=59.5 meV / A, MAE_S_per_atom=0.2 meV / A^3
2023-11-23 23:00:05.544 INFO: Saving current state to data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-126
2023-11-23 23:00:05.591 INFO: Model weights saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-126/pytorch_model.bin
2023-11-23 23:00:05.706 INFO: Optimizer state saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-126/optimizer.bin
2023-11-23 23:00:05.708 INFO: Random states saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-126/random_states_0.pkl
2023-11-24 01:37:58.252 INFO: Epoch 128: loss=0.0029, MAE_E_per_atom=15.9 meV, MAE_F=59.3 meV / A, MAE_S_per_atom=0.2 meV / A^3
2023-11-24 04:39:15.544 INFO: Epoch 130: loss=0.0029, MAE_E_per_atom=15.9 meV, MAE_F=59.4 meV / A, MAE_S_per_atom=0.2 meV / A^3
2023-11-24 04:39:15.556 INFO: Saving current state to data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-130
2023-11-24 04:39:15.603 INFO: Model weights saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-130/pytorch_model.bin
2023-11-24 04:39:15.718 INFO: Optimizer state saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-130/optimizer.bin
2023-11-24 04:39:15.719 INFO: Random states saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-130/random_states_0.pkl
2023-11-24 08:07:47.012 INFO: Epoch 132: loss=0.0029, MAE_E_per_atom=15.9 meV, MAE_F=59.3 meV / A, MAE_S_per_atom=0.2 meV / A^3
2023-11-24 08:41:42.997 INFO: MACE version: 0.1.0
2023-11-24 08:41:42.997 INFO: Configuration: Namespace(name='MACE_MPtrj_2022.9', seed=42, log_dir='data-train-result-stress-128/logs', model_dir='data-train-result-stress-128', checkpoints_dir='data-train-result-stress-128/checkpoints', results_dir='data-train-result-stress-128/results', downloads_dir='data-train-result-stress-128/downloads', default_dtype='float64', log_level='INFO', error_table='PerAtomMAEstress', model='ScaleShiftMACE', r_max=5.0, num_radial_basis=8, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='32x0e', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=True, compute_forces=True, train_file='./data-train-preprocessed/train.h5', valid_file='./data-train-preprocessed/valid.h5', valid_fraction=0.1, test_file=None, test_dir=None, num_workers=8, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file='./data-train-preprocessed/statistics.json', E0s=None, energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='stress-l1', forces_weight=1.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=400.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=32, valid_batch_size=32, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=140, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=True, restart_lr=0.0005, save_cpu=True, clip_grad=10.0, wandb=False, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-11-24 08:41:42.997 INFO: Using statistics json file
2023-11-24 08:41:42.997 INFO: Using atomic numbers from statistics file
2023-11-24 08:41:42.998 INFO: AtomicNumberTable: (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 89, 90, 91, 92, 93, 94)
2023-11-24 08:41:42.998 INFO: Atomic Energies not in training file, using command line argument E0s
2023-11-24 08:41:42.999 INFO: Atomic energies: [-3.6673775936325184, -1.321978574671279, -3.47815910592578, -4.724966512505185, -7.727941403300326, -8.404543836565129, -7.359429774977432, -7.284436081345614, -4.896162007436489, -0.03005797428312995, -2.7527187727369, -2.8138258116559136, -4.844369939040846, -7.6966307568316115, -6.96321292174237, -4.673811566998673, -2.813984104722163, -0.06233472731112788, -2.6251773081704863, -5.384791381758609, -7.916197568907359, -10.270820955634214, -8.672390387555845, -9.2371580345617, -8.305620224433062, -7.054671703876374, -5.570915377375696, -5.174147851464132, -3.251035550574451, -1.2879654275024013, -3.5321835252059812, -4.711328365973749, -3.9717755452456673, -3.886221455984922, -2.5183143168985502, 6.706842222672468, -2.566057480857263, -4.938993788294903, -10.153603816562159, -11.857062150232505, -12.14164656151253, -8.786094380920531, -8.795434431218645, -7.778351502991773, -6.838726494373795, -4.881216430056056, -2.0605586704343675, -0.6439905162993389, -2.788575343692543, -3.816810475940441, -3.587983770584603, -2.8805917608627976, -1.6360524330360255, 9.796001071919388, -2.7486371263604354, -4.986670776340143, -8.929476698318382, -8.74170685282431, -8.01217127881877, -8.233598378021814, -7.62454389634746, -8.161368139142393, -13.591451290378114, -18.538136714242995, -7.644552511106582, -8.115049752450005, -7.614570319217799, -6.82962645334957, -7.820026786949461, -3.5770491745130024, -7.469205400904766, -12.770648602823787, -14.110986902146283, -9.354405708044254, -11.376459286198285, -9.611613368883013, -7.321263077561875, -5.304305597659051, -2.3873175082519373, 0.24792131307789267, -2.31553585581406, -3.7254481655069127, -3.4301772252097935, -5.065907805804548, -11.017529306980132, -12.244262478240024, -13.846602972246156, -14.952721865054968, -15.303292182007306]
2023-11-24 08:41:43.058 INFO: WeightedEnergyForcesStressLossL1(energy_weight=1.000, forces_weight=1.000, stress_weight=400.000)
2023-11-24 08:41:43.059 INFO: Average number of neighbors: 25.57754135131836
2023-11-24 08:41:43.059 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': True, 'dipoles': False}
2023-11-24 08:41:43.059 INFO: Building model
2023-11-24 08:41:43.059 INFO: Hidden irreps: 128x0e + 128x1o
2023-11-24 08:41:46.292 INFO: Loading states from data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-130
2023-11-24 08:41:46.325 INFO: All model weights loaded successfully
2023-11-24 08:41:46.395 INFO: All optimizer states loaded successfully
2023-11-24 08:41:46.395 INFO: All scheduler states loaded successfully
2023-11-24 08:41:46.400 INFO: All random states loaded successfully
2023-11-24 08:41:46.400 INFO: Loading in 0 custom states
2023-11-24 08:41:46.401 INFO: DistributedDataParallel(
  (module): ScaleShiftMACE(
    (node_embedding): LinearNodeEmbeddingBlock(
      (linear): Linear(89x0e -> 128x0e | 11392 weights)
    )
    (radial_embedding): RadialEmbeddingBlock(
      (bessel_fn): BesselBasis(r_max=4.5, num_basis=8, trainable=False)
      (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
    )
    (spherical_harmonics): SphericalHarmonics()
    (atomic_energies_fn): AtomicEnergiesBlock(energies=[-3.6674, -1.3220, -3.4782, -4.7250, -7.7279, -8.4045, -7.3594, -7.2844, -4.8962, -0.0301, -2.7527, -2.8138, -4.8444, -7.6966, -6.9632, -4.6738, -2.8140, -0.0623, -2.6252, -5.3848, -7.9162, -10.2708, -8.6724, -9.2372, -8.3056, -7.0547, -5.5709, -5.1741, -3.2510, -1.2880, -3.5322, -4.7113, -3.9718, -3.8862, -2.5183, 6.7068, -2.5661, -4.9390, -10.1536, -11.8571, -12.1416, -8.7861, -8.7954, -7.7784, -6.8387, -4.8812, -2.0606, -0.6440, -2.7886, -3.8168, -3.5880, -2.8806, -1.6361, 9.7960, -2.7486, -4.9867, -8.9295, -8.7417, -8.0122, -8.2336, -7.6245, -8.1614, -13.5915, -18.5381, -7.6446, -8.1150, -7.6146, -6.8296, -7.8200, -3.5770, -7.4692, -12.7706, -14.1110, -9.3544, -11.3765, -9.6116, -7.3213, -5.3043, -2.3873, 0.2479, -2.3155, -3.7254, -3.4302, -5.0659, -11.0175, -12.2443, -13.8466, -14.9527, -15.3033])
    (interactions): ModuleList(
      (0): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
        (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 512]
        (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e x 89x0e -> 128x0e+128x1o | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
      (1): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
        (conv_tp): TensorProduct(128x0e+128x1o x 1x0e+1x1o+1x2e+1x3o -> 256x0e+384x1o+384x2e+256x3o | 1280 paths | 1280 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1280]
        (linear): Linear(256x0e+384x1o+384x2e+256x3o -> 128x0e+128x1o+128x2e+128x3o | 163840 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o x 89x0e -> 128x0e | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
    )
    (products): ModuleList(
      (0): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
            (1): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x6x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
      )
      (1): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e -> 128x0e | 16384 weights)
      )
    )
    (readouts): ModuleList(
      (0): LinearReadoutBlock(
        (linear): Linear(128x0e+128x1o -> 1x0e | 128 weights)
      )
      (1): NonLinearReadoutBlock(
        (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
        (non_linearity): Activation [x] (16x0e -> 16x0e)
        (linear_2): Linear(16x0e -> 1x0e | 16 weights)
      )
    )
    (scale_shift): ScaleShiftBlock(scale=0.804340, shift=0.164779)
  )
)
2023-11-24 08:41:46.406 INFO: Number of parameters: 4688400
2023-11-24 08:41:46.406 INFO: Optimizer: AcceleratedOptimizer (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: interactions_decay
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: interactions_no_decay
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: products
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2023-11-24 08:41:46.406 INFO: Using gradient clipping with tolerance=10.000
2023-11-24 08:41:46.406 INFO: Started training
2023-11-24 08:41:48.150 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-24 08:41:48.150 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-24 08:41:48.151 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-24 08:41:48.151 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-24 09:50:35.926 INFO: Epoch 130: loss=0.0047, MAE_E_per_atom=17.5 meV, MAE_F=61.1 meV / A, MAE_S_per_atom=0.2 meV / A^3
2023-11-24 09:50:35.928 INFO: Saving current state to data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-130
2023-11-24 09:50:35.995 INFO: Model weights saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-130/pytorch_model.bin
2023-11-24 09:50:36.188 INFO: Optimizer state saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-130/optimizer.bin
2023-11-24 09:50:36.190 INFO: Random states saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-130/random_states_0.pkl
2023-11-24 12:03:41.608 INFO: Epoch 132: loss=0.0046, MAE_E_per_atom=17.6 meV, MAE_F=61.4 meV / A, MAE_S_per_atom=0.2 meV / A^3
2023-11-24 12:03:41.621 INFO: Saving current state to data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-132
2023-11-24 12:03:41.676 INFO: Model weights saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-132/pytorch_model.bin
2023-11-24 12:03:41.806 INFO: Optimizer state saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-132/optimizer.bin
2023-11-24 12:03:41.807 INFO: Random states saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-132/random_states_0.pkl
2023-11-24 14:25:17.553 INFO: Epoch 134: loss=0.0045, MAE_E_per_atom=17.7 meV, MAE_F=61.6 meV / A, MAE_S_per_atom=0.2 meV / A^3
2023-11-24 14:25:17.570 INFO: Saving current state to data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-134
2023-11-24 14:25:17.630 INFO: Model weights saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-134/pytorch_model.bin
2023-11-24 14:25:17.750 INFO: Optimizer state saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-134/optimizer.bin
2023-11-24 14:25:17.752 INFO: Random states saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-134/random_states_0.pkl
2023-11-24 17:04:03.083 INFO: Epoch 136: loss=0.0045, MAE_E_per_atom=17.6 meV, MAE_F=61.8 meV / A, MAE_S_per_atom=0.2 meV / A^3
2023-11-24 17:04:03.097 INFO: Saving current state to data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-136
2023-11-24 17:04:03.145 INFO: Model weights saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-136/pytorch_model.bin
2023-11-24 17:04:03.247 INFO: Optimizer state saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-136/optimizer.bin
2023-11-24 17:04:03.249 INFO: Random states saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-136/random_states_0.pkl
2023-11-24 20:02:37.081 INFO: Epoch 138: loss=0.0045, MAE_E_per_atom=17.6 meV, MAE_F=62.0 meV / A, MAE_S_per_atom=0.2 meV / A^3
2023-11-24 21:37:23.534 INFO: Training complete
2023-11-24 21:37:23.535 INFO: Computing metrics for training, validation, and test sets
2023-11-24 21:37:23.535 INFO: Loading states from data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-136
2023-11-24 21:37:23.566 INFO: All model weights loaded successfully
2023-11-24 21:37:23.629 INFO: All optimizer states loaded successfully
2023-11-24 21:37:23.629 INFO: All scheduler states loaded successfully
2023-11-24 21:37:23.630 INFO: All random states loaded successfully
2023-11-24 21:37:23.630 INFO: Loading in 0 custom states
2023-11-24 21:37:23.630 INFO: Loaded model from epoch 136
2023-11-24 21:37:23.631 INFO: Evaluating train ...
2023-11-24 22:29:16.922 INFO: Evaluating valid ...
2023-11-24 22:40:16.401 INFO: 
++
||
++
++
2023-11-24 22:40:16.403 INFO: Saving model to data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42.model
2023-11-24 22:40:16.604 INFO: Done
2023-11-25 08:24:56.620 INFO: MACE version: 0.1.0
2023-11-25 08:24:56.620 INFO: Configuration: Namespace(name='MACE_MPtrj_2022.9', seed=42, log_dir='data-train-result-stress-128/logs', model_dir='data-train-result-stress-128', checkpoints_dir='data-train-result-stress-128/checkpoints', results_dir='data-train-result-stress-128/results', downloads_dir='data-train-result-stress-128/downloads', default_dtype='float64', log_level='INFO', error_table='PerAtomMAEstress', model='ScaleShiftMACE', r_max=5.0, num_radial_basis=8, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='32x0e', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=True, compute_forces=True, train_file='./data-train-preprocessed/train.h5', valid_file='./data-train-preprocessed/valid.h5', valid_fraction=0.1, test_file=None, test_dir=None, num_workers=8, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file='./data-train-preprocessed/statistics.json', E0s=None, energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='stress-l1', forces_weight=1.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=500.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=32, valid_batch_size=32, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=160, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=True, restart_lr=0.0005, save_cpu=True, clip_grad=10.0, wandb=False, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-11-25 08:24:56.621 INFO: Using statistics json file
2023-11-25 08:24:56.621 INFO: Using atomic numbers from statistics file
2023-11-25 08:24:56.621 INFO: AtomicNumberTable: (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 89, 90, 91, 92, 93, 94)
2023-11-25 08:24:56.621 INFO: Atomic Energies not in training file, using command line argument E0s
2023-11-25 08:24:56.622 INFO: Atomic energies: [-3.6673775936325184, -1.321978574671279, -3.47815910592578, -4.724966512505185, -7.727941403300326, -8.404543836565129, -7.359429774977432, -7.284436081345614, -4.896162007436489, -0.03005797428312995, -2.7527187727369, -2.8138258116559136, -4.844369939040846, -7.6966307568316115, -6.96321292174237, -4.673811566998673, -2.813984104722163, -0.06233472731112788, -2.6251773081704863, -5.384791381758609, -7.916197568907359, -10.270820955634214, -8.672390387555845, -9.2371580345617, -8.305620224433062, -7.054671703876374, -5.570915377375696, -5.174147851464132, -3.251035550574451, -1.2879654275024013, -3.5321835252059812, -4.711328365973749, -3.9717755452456673, -3.886221455984922, -2.5183143168985502, 6.706842222672468, -2.566057480857263, -4.938993788294903, -10.153603816562159, -11.857062150232505, -12.14164656151253, -8.786094380920531, -8.795434431218645, -7.778351502991773, -6.838726494373795, -4.881216430056056, -2.0605586704343675, -0.6439905162993389, -2.788575343692543, -3.816810475940441, -3.587983770584603, -2.8805917608627976, -1.6360524330360255, 9.796001071919388, -2.7486371263604354, -4.986670776340143, -8.929476698318382, -8.74170685282431, -8.01217127881877, -8.233598378021814, -7.62454389634746, -8.161368139142393, -13.591451290378114, -18.538136714242995, -7.644552511106582, -8.115049752450005, -7.614570319217799, -6.82962645334957, -7.820026786949461, -3.5770491745130024, -7.469205400904766, -12.770648602823787, -14.110986902146283, -9.354405708044254, -11.376459286198285, -9.611613368883013, -7.321263077561875, -5.304305597659051, -2.3873175082519373, 0.24792131307789267, -2.31553585581406, -3.7254481655069127, -3.4301772252097935, -5.065907805804548, -11.017529306980132, -12.244262478240024, -13.846602972246156, -14.952721865054968, -15.303292182007306]
2023-11-25 08:24:56.697 INFO: WeightedEnergyForcesStressLossL1(energy_weight=1.000, forces_weight=1.000, stress_weight=500.000)
2023-11-25 08:24:56.698 INFO: Average number of neighbors: 25.57754135131836
2023-11-25 08:24:56.698 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': True, 'dipoles': False}
2023-11-25 08:24:56.698 INFO: Building model
2023-11-25 08:24:56.698 INFO: Hidden irreps: 128x0e + 128x1o
2023-11-25 08:24:59.930 INFO: Loading states from data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-136
2023-11-25 08:24:59.967 INFO: All model weights loaded successfully
2023-11-25 08:25:00.039 INFO: All optimizer states loaded successfully
2023-11-25 08:25:00.039 INFO: All scheduler states loaded successfully
2023-11-25 08:25:00.046 INFO: All random states loaded successfully
2023-11-25 08:25:00.047 INFO: Loading in 0 custom states
2023-11-25 08:25:00.048 INFO: DistributedDataParallel(
  (module): ScaleShiftMACE(
    (node_embedding): LinearNodeEmbeddingBlock(
      (linear): Linear(89x0e -> 128x0e | 11392 weights)
    )
    (radial_embedding): RadialEmbeddingBlock(
      (bessel_fn): BesselBasis(r_max=4.5, num_basis=8, trainable=False)
      (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
    )
    (spherical_harmonics): SphericalHarmonics()
    (atomic_energies_fn): AtomicEnergiesBlock(energies=[-3.6674, -1.3220, -3.4782, -4.7250, -7.7279, -8.4045, -7.3594, -7.2844, -4.8962, -0.0301, -2.7527, -2.8138, -4.8444, -7.6966, -6.9632, -4.6738, -2.8140, -0.0623, -2.6252, -5.3848, -7.9162, -10.2708, -8.6724, -9.2372, -8.3056, -7.0547, -5.5709, -5.1741, -3.2510, -1.2880, -3.5322, -4.7113, -3.9718, -3.8862, -2.5183, 6.7068, -2.5661, -4.9390, -10.1536, -11.8571, -12.1416, -8.7861, -8.7954, -7.7784, -6.8387, -4.8812, -2.0606, -0.6440, -2.7886, -3.8168, -3.5880, -2.8806, -1.6361, 9.7960, -2.7486, -4.9867, -8.9295, -8.7417, -8.0122, -8.2336, -7.6245, -8.1614, -13.5915, -18.5381, -7.6446, -8.1150, -7.6146, -6.8296, -7.8200, -3.5770, -7.4692, -12.7706, -14.1110, -9.3544, -11.3765, -9.6116, -7.3213, -5.3043, -2.3873, 0.2479, -2.3155, -3.7254, -3.4302, -5.0659, -11.0175, -12.2443, -13.8466, -14.9527, -15.3033])
    (interactions): ModuleList(
      (0): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
        (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 512]
        (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e x 89x0e -> 128x0e+128x1o | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
      (1): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
        (conv_tp): TensorProduct(128x0e+128x1o x 1x0e+1x1o+1x2e+1x3o -> 256x0e+384x1o+384x2e+256x3o | 1280 paths | 1280 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1280]
        (linear): Linear(256x0e+384x1o+384x2e+256x3o -> 128x0e+128x1o+128x2e+128x3o | 163840 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o x 89x0e -> 128x0e | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
    )
    (products): ModuleList(
      (0): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
            (1): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x6x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
      )
      (1): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e -> 128x0e | 16384 weights)
      )
    )
    (readouts): ModuleList(
      (0): LinearReadoutBlock(
        (linear): Linear(128x0e+128x1o -> 1x0e | 128 weights)
      )
      (1): NonLinearReadoutBlock(
        (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
        (non_linearity): Activation [x] (16x0e -> 16x0e)
        (linear_2): Linear(16x0e -> 1x0e | 16 weights)
      )
    )
    (scale_shift): ScaleShiftBlock(scale=0.804340, shift=0.164779)
  )
)
2023-11-25 08:25:00.053 INFO: Number of parameters: 4688400
2023-11-25 08:25:00.053 INFO: Optimizer: AcceleratedOptimizer (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: interactions_decay
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: interactions_no_decay
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: products
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2023-11-25 08:25:00.053 INFO: Using gradient clipping with tolerance=10.000
2023-11-25 08:25:00.053 INFO: Started training
2023-11-25 08:25:01.846 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-25 08:25:01.849 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-25 08:25:01.849 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-25 08:25:01.849 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-25 09:34:09.092 INFO: Epoch 136: loss=0.0051, MAE_E_per_atom=18.0 meV, MAE_F=62.1 meV / A, MAE_S_per_atom=0.2 meV / A^3
2023-11-25 09:34:09.095 INFO: Saving current state to data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-136
2023-11-25 09:34:09.160 INFO: Model weights saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-136/pytorch_model.bin
2023-11-25 09:34:09.369 INFO: Optimizer state saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-136/optimizer.bin
2023-11-25 09:34:09.373 INFO: Random states saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-136/random_states_0.pkl
2023-11-25 11:47:38.602 INFO: Epoch 138: loss=0.0050, MAE_E_per_atom=18.1 meV, MAE_F=62.2 meV / A, MAE_S_per_atom=0.2 meV / A^3
2023-11-25 11:47:38.613 INFO: Saving current state to data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-138
2023-11-25 11:47:38.654 INFO: Model weights saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-138/pytorch_model.bin
2023-11-25 11:47:38.741 INFO: Optimizer state saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-138/optimizer.bin
2023-11-25 11:47:38.742 INFO: Random states saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-138/random_states_0.pkl
2023-11-25 14:29:07.438 INFO: Epoch 140: loss=0.0049, MAE_E_per_atom=18.2 meV, MAE_F=62.1 meV / A, MAE_S_per_atom=0.2 meV / A^3
2023-11-25 14:29:07.449 INFO: Saving current state to data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-140
2023-11-25 14:29:07.498 INFO: Model weights saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-140/pytorch_model.bin
2023-11-25 14:29:07.601 INFO: Optimizer state saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-140/optimizer.bin
2023-11-25 14:29:07.602 INFO: Random states saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-140/random_states_0.pkl
2023-11-25 14:54:56.950 INFO: MACE version: 0.1.0
2023-11-25 14:54:56.951 INFO: Configuration: Namespace(name='MACE_MPtrj_2022.9', seed=42, log_dir='data-train-result-stress-128/logs', model_dir='data-train-result-stress-128', checkpoints_dir='data-train-result-stress-128/checkpoints', results_dir='data-train-result-stress-128/results', downloads_dir='data-train-result-stress-128/downloads', default_dtype='float64', log_level='INFO', error_table='PerAtomMAEstress', model='ScaleShiftMACE', r_max=5.0, num_radial_basis=8, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='32x0e', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=True, compute_forces=True, train_file='./data-train-preprocessed/train.h5', valid_file='./data-train-preprocessed/valid.h5', valid_fraction=0.1, test_file=None, test_dir=None, num_workers=8, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file='./data-train-preprocessed/statistics.json', E0s=None, energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='stress-l1', forces_weight=1.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=500.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=32, valid_batch_size=32, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=160, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=True, restart_lr=0.0005, save_cpu=True, clip_grad=10.0, wandb=False, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-11-25 14:54:56.952 INFO: Using statistics json file
2023-11-25 14:54:56.952 INFO: Using atomic numbers from statistics file
2023-11-25 14:54:56.953 INFO: AtomicNumberTable: (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 89, 90, 91, 92, 93, 94)
2023-11-25 14:54:56.953 INFO: Atomic Energies not in training file, using command line argument E0s
2023-11-25 14:54:56.954 INFO: Atomic energies: [-3.6673775936325184, -1.321978574671279, -3.47815910592578, -4.724966512505185, -7.727941403300326, -8.404543836565129, -7.359429774977432, -7.284436081345614, -4.896162007436489, -0.03005797428312995, -2.7527187727369, -2.8138258116559136, -4.844369939040846, -7.6966307568316115, -6.96321292174237, -4.673811566998673, -2.813984104722163, -0.06233472731112788, -2.6251773081704863, -5.384791381758609, -7.916197568907359, -10.270820955634214, -8.672390387555845, -9.2371580345617, -8.305620224433062, -7.054671703876374, -5.570915377375696, -5.174147851464132, -3.251035550574451, -1.2879654275024013, -3.5321835252059812, -4.711328365973749, -3.9717755452456673, -3.886221455984922, -2.5183143168985502, 6.706842222672468, -2.566057480857263, -4.938993788294903, -10.153603816562159, -11.857062150232505, -12.14164656151253, -8.786094380920531, -8.795434431218645, -7.778351502991773, -6.838726494373795, -4.881216430056056, -2.0605586704343675, -0.6439905162993389, -2.788575343692543, -3.816810475940441, -3.587983770584603, -2.8805917608627976, -1.6360524330360255, 9.796001071919388, -2.7486371263604354, -4.986670776340143, -8.929476698318382, -8.74170685282431, -8.01217127881877, -8.233598378021814, -7.62454389634746, -8.161368139142393, -13.591451290378114, -18.538136714242995, -7.644552511106582, -8.115049752450005, -7.614570319217799, -6.82962645334957, -7.820026786949461, -3.5770491745130024, -7.469205400904766, -12.770648602823787, -14.110986902146283, -9.354405708044254, -11.376459286198285, -9.611613368883013, -7.321263077561875, -5.304305597659051, -2.3873175082519373, 0.24792131307789267, -2.31553585581406, -3.7254481655069127, -3.4301772252097935, -5.065907805804548, -11.017529306980132, -12.244262478240024, -13.846602972246156, -14.952721865054968, -15.303292182007306]
2023-11-25 14:54:57.054 INFO: WeightedEnergyForcesStressLossL1(energy_weight=1.000, forces_weight=1.000, stress_weight=500.000)
2023-11-25 14:54:57.068 INFO: Average number of neighbors: 25.57754135131836
2023-11-25 14:54:57.069 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': True, 'dipoles': False}
2023-11-25 14:54:57.069 INFO: Building model
2023-11-25 14:54:57.069 INFO: Hidden irreps: 128x0e + 128x1o
2023-11-25 14:55:01.574 INFO: Loading states from data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-140
2023-11-25 14:55:01.656 INFO: All model weights loaded successfully
2023-11-25 14:55:01.734 INFO: All optimizer states loaded successfully
2023-11-25 14:55:01.735 INFO: All scheduler states loaded successfully
2023-11-25 14:55:01.738 INFO: All random states loaded successfully
2023-11-25 14:55:01.739 INFO: Loading in 0 custom states
2023-11-25 14:55:01.740 INFO: DistributedDataParallel(
  (module): ScaleShiftMACE(
    (node_embedding): LinearNodeEmbeddingBlock(
      (linear): Linear(89x0e -> 128x0e | 11392 weights)
    )
    (radial_embedding): RadialEmbeddingBlock(
      (bessel_fn): BesselBasis(r_max=4.5, num_basis=8, trainable=False)
      (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
    )
    (spherical_harmonics): SphericalHarmonics()
    (atomic_energies_fn): AtomicEnergiesBlock(energies=[-3.6674, -1.3220, -3.4782, -4.7250, -7.7279, -8.4045, -7.3594, -7.2844, -4.8962, -0.0301, -2.7527, -2.8138, -4.8444, -7.6966, -6.9632, -4.6738, -2.8140, -0.0623, -2.6252, -5.3848, -7.9162, -10.2708, -8.6724, -9.2372, -8.3056, -7.0547, -5.5709, -5.1741, -3.2510, -1.2880, -3.5322, -4.7113, -3.9718, -3.8862, -2.5183, 6.7068, -2.5661, -4.9390, -10.1536, -11.8571, -12.1416, -8.7861, -8.7954, -7.7784, -6.8387, -4.8812, -2.0606, -0.6440, -2.7886, -3.8168, -3.5880, -2.8806, -1.6361, 9.7960, -2.7486, -4.9867, -8.9295, -8.7417, -8.0122, -8.2336, -7.6245, -8.1614, -13.5915, -18.5381, -7.6446, -8.1150, -7.6146, -6.8296, -7.8200, -3.5770, -7.4692, -12.7706, -14.1110, -9.3544, -11.3765, -9.6116, -7.3213, -5.3043, -2.3873, 0.2479, -2.3155, -3.7254, -3.4302, -5.0659, -11.0175, -12.2443, -13.8466, -14.9527, -15.3033])
    (interactions): ModuleList(
      (0): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
        (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 512]
        (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e x 89x0e -> 128x0e+128x1o | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
      (1): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
        (conv_tp): TensorProduct(128x0e+128x1o x 1x0e+1x1o+1x2e+1x3o -> 256x0e+384x1o+384x2e+256x3o | 1280 paths | 1280 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1280]
        (linear): Linear(256x0e+384x1o+384x2e+256x3o -> 128x0e+128x1o+128x2e+128x3o | 163840 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o x 89x0e -> 128x0e | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
    )
    (products): ModuleList(
      (0): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
            (1): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x6x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
      )
      (1): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e -> 128x0e | 16384 weights)
      )
    )
    (readouts): ModuleList(
      (0): LinearReadoutBlock(
        (linear): Linear(128x0e+128x1o -> 1x0e | 128 weights)
      )
      (1): NonLinearReadoutBlock(
        (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
        (non_linearity): Activation [x] (16x0e -> 16x0e)
        (linear_2): Linear(16x0e -> 1x0e | 16 weights)
      )
    )
    (scale_shift): ScaleShiftBlock(scale=0.804340, shift=0.164779)
  )
)
2023-11-25 14:55:01.745 INFO: Number of parameters: 4688400
2023-11-25 14:55:01.745 INFO: Optimizer: AcceleratedOptimizer (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: interactions_decay
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: interactions_no_decay
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: products
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2023-11-25 14:55:01.746 INFO: Using gradient clipping with tolerance=10.000
2023-11-25 14:55:01.746 INFO: Started training
2023-11-25 14:55:04.715 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-25 14:55:04.729 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-25 14:55:04.729 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-25 14:55:04.741 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-25 16:07:52.515 INFO: Epoch 140: loss=0.0050, MAE_E_per_atom=18.2 meV, MAE_F=62.2 meV / A, MAE_S_per_atom=0.157 meV / A^3
2023-11-25 16:07:52.520 INFO: Saving current state to data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-140
2023-11-25 16:07:52.676 INFO: Model weights saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-140/pytorch_model.bin
2023-11-25 16:07:52.971 INFO: Optimizer state saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-140/optimizer.bin
2023-11-25 16:07:52.981 INFO: Random states saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-140/random_states_0.pkl
2023-11-25 18:34:39.402 INFO: Epoch 142: loss=0.0049, MAE_E_per_atom=18.1 meV, MAE_F=62.3 meV / A, MAE_S_per_atom=0.154 meV / A^3
2023-11-25 18:34:39.409 INFO: Saving current state to data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-142
2023-11-25 18:34:39.465 INFO: Model weights saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-142/pytorch_model.bin
2023-11-25 18:34:39.577 INFO: Optimizer state saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-142/optimizer.bin
2023-11-25 18:34:39.579 INFO: Random states saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-142/random_states_0.pkl
2023-11-25 21:01:11.985 INFO: Epoch 144: loss=0.0049, MAE_E_per_atom=18.1 meV, MAE_F=62.5 meV / A, MAE_S_per_atom=0.154 meV / A^3
2023-11-25 21:01:12.002 INFO: Saving current state to data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-144
2023-11-25 21:01:12.045 INFO: Model weights saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-144/pytorch_model.bin
2023-11-25 21:01:12.139 INFO: Optimizer state saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-144/optimizer.bin
2023-11-25 21:01:12.140 INFO: Random states saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-144/random_states_0.pkl
2023-11-25 23:39:10.448 INFO: Epoch 146: loss=0.0049, MAE_E_per_atom=18.1 meV, MAE_F=62.5 meV / A, MAE_S_per_atom=0.153 meV / A^3
2023-11-26 02:41:27.354 INFO: Epoch 148: loss=0.0049, MAE_E_per_atom=18.1 meV, MAE_F=62.7 meV / A, MAE_S_per_atom=0.154 meV / A^3
2023-11-26 06:08:28.011 INFO: Epoch 150: loss=0.0049, MAE_E_per_atom=18.1 meV, MAE_F=61.7 meV / A, MAE_S_per_atom=0.152 meV / A^3
2023-11-26 06:08:28.028 INFO: Saving current state to data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-150
2023-11-26 06:08:28.083 INFO: Model weights saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-150/pytorch_model.bin
2023-11-26 06:08:28.213 INFO: Optimizer state saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-150/optimizer.bin
2023-11-26 06:08:28.215 INFO: Random states saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-150/random_states_0.pkl
2023-11-26 10:01:03.296 INFO: Epoch 152: loss=0.0049, MAE_E_per_atom=18.0 meV, MAE_F=61.7 meV / A, MAE_S_per_atom=0.151 meV / A^3
2023-11-26 10:01:03.311 INFO: Saving current state to data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-152
2023-11-26 10:01:03.371 INFO: Model weights saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-152/pytorch_model.bin
2023-11-26 10:01:03.504 INFO: Optimizer state saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-152/optimizer.bin
2023-11-26 10:01:03.505 INFO: Random states saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-152/random_states_0.pkl
2023-11-26 10:20:44.514 INFO: MACE version: 0.1.0
2023-11-26 10:20:44.515 INFO: Configuration: Namespace(name='MACE_MPtrj_2022.9', seed=42, log_dir='data-train-result-stress-128/logs', model_dir='data-train-result-stress-128', checkpoints_dir='data-train-result-stress-128/checkpoints', results_dir='data-train-result-stress-128/results', downloads_dir='data-train-result-stress-128/downloads', default_dtype='float64', log_level='INFO', error_table='PerAtomMAEstress', model='ScaleShiftMACE', r_max=5.0, num_radial_basis=8, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='32x0e', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=True, compute_forces=True, train_file='./data-train-preprocessed/train.h5', valid_file='./data-train-preprocessed/valid.h5', valid_fraction=0.1, test_file=None, test_dir=None, num_workers=8, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file='./data-train-preprocessed/statistics.json', E0s=None, energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='stress-l1', forces_weight=1.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=500.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=32, valid_batch_size=32, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=160, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=True, restart_lr=0.0002, save_cpu=True, clip_grad=10.0, wandb=False, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-11-26 10:20:44.515 INFO: Using statistics json file
2023-11-26 10:20:44.515 INFO: Using atomic numbers from statistics file
2023-11-26 10:20:44.516 INFO: AtomicNumberTable: (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 89, 90, 91, 92, 93, 94)
2023-11-26 10:20:44.516 INFO: Atomic Energies not in training file, using command line argument E0s
2023-11-26 10:20:44.516 INFO: Atomic energies: [-3.6673775936325184, -1.321978574671279, -3.47815910592578, -4.724966512505185, -7.727941403300326, -8.404543836565129, -7.359429774977432, -7.284436081345614, -4.896162007436489, -0.03005797428312995, -2.7527187727369, -2.8138258116559136, -4.844369939040846, -7.6966307568316115, -6.96321292174237, -4.673811566998673, -2.813984104722163, -0.06233472731112788, -2.6251773081704863, -5.384791381758609, -7.916197568907359, -10.270820955634214, -8.672390387555845, -9.2371580345617, -8.305620224433062, -7.054671703876374, -5.570915377375696, -5.174147851464132, -3.251035550574451, -1.2879654275024013, -3.5321835252059812, -4.711328365973749, -3.9717755452456673, -3.886221455984922, -2.5183143168985502, 6.706842222672468, -2.566057480857263, -4.938993788294903, -10.153603816562159, -11.857062150232505, -12.14164656151253, -8.786094380920531, -8.795434431218645, -7.778351502991773, -6.838726494373795, -4.881216430056056, -2.0605586704343675, -0.6439905162993389, -2.788575343692543, -3.816810475940441, -3.587983770584603, -2.8805917608627976, -1.6360524330360255, 9.796001071919388, -2.7486371263604354, -4.986670776340143, -8.929476698318382, -8.74170685282431, -8.01217127881877, -8.233598378021814, -7.62454389634746, -8.161368139142393, -13.591451290378114, -18.538136714242995, -7.644552511106582, -8.115049752450005, -7.614570319217799, -6.82962645334957, -7.820026786949461, -3.5770491745130024, -7.469205400904766, -12.770648602823787, -14.110986902146283, -9.354405708044254, -11.376459286198285, -9.611613368883013, -7.321263077561875, -5.304305597659051, -2.3873175082519373, 0.24792131307789267, -2.31553585581406, -3.7254481655069127, -3.4301772252097935, -5.065907805804548, -11.017529306980132, -12.244262478240024, -13.846602972246156, -14.952721865054968, -15.303292182007306]
2023-11-26 10:20:44.589 INFO: WeightedEnergyForcesStressLossL1(energy_weight=1.000, forces_weight=1.000, stress_weight=500.000)
2023-11-26 10:20:44.590 INFO: Average number of neighbors: 25.57754135131836
2023-11-26 10:20:44.590 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': True, 'dipoles': False}
2023-11-26 10:20:44.590 INFO: Building model
2023-11-26 10:20:44.590 INFO: Hidden irreps: 128x0e + 128x1o
2023-11-26 10:20:47.815 INFO: Loading states from data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-152
2023-11-26 10:20:47.850 INFO: All model weights loaded successfully
2023-11-26 10:20:47.923 INFO: All optimizer states loaded successfully
2023-11-26 10:20:47.924 INFO: All scheduler states loaded successfully
2023-11-26 10:20:47.932 INFO: All random states loaded successfully
2023-11-26 10:20:47.932 INFO: Loading in 0 custom states
2023-11-26 10:20:47.933 INFO: DistributedDataParallel(
  (module): ScaleShiftMACE(
    (node_embedding): LinearNodeEmbeddingBlock(
      (linear): Linear(89x0e -> 128x0e | 11392 weights)
    )
    (radial_embedding): RadialEmbeddingBlock(
      (bessel_fn): BesselBasis(r_max=4.5, num_basis=8, trainable=False)
      (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
    )
    (spherical_harmonics): SphericalHarmonics()
    (atomic_energies_fn): AtomicEnergiesBlock(energies=[-3.6674, -1.3220, -3.4782, -4.7250, -7.7279, -8.4045, -7.3594, -7.2844, -4.8962, -0.0301, -2.7527, -2.8138, -4.8444, -7.6966, -6.9632, -4.6738, -2.8140, -0.0623, -2.6252, -5.3848, -7.9162, -10.2708, -8.6724, -9.2372, -8.3056, -7.0547, -5.5709, -5.1741, -3.2510, -1.2880, -3.5322, -4.7113, -3.9718, -3.8862, -2.5183, 6.7068, -2.5661, -4.9390, -10.1536, -11.8571, -12.1416, -8.7861, -8.7954, -7.7784, -6.8387, -4.8812, -2.0606, -0.6440, -2.7886, -3.8168, -3.5880, -2.8806, -1.6361, 9.7960, -2.7486, -4.9867, -8.9295, -8.7417, -8.0122, -8.2336, -7.6245, -8.1614, -13.5915, -18.5381, -7.6446, -8.1150, -7.6146, -6.8296, -7.8200, -3.5770, -7.4692, -12.7706, -14.1110, -9.3544, -11.3765, -9.6116, -7.3213, -5.3043, -2.3873, 0.2479, -2.3155, -3.7254, -3.4302, -5.0659, -11.0175, -12.2443, -13.8466, -14.9527, -15.3033])
    (interactions): ModuleList(
      (0): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
        (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 512]
        (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e x 89x0e -> 128x0e+128x1o | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
      (1): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
        (conv_tp): TensorProduct(128x0e+128x1o x 1x0e+1x1o+1x2e+1x3o -> 256x0e+384x1o+384x2e+256x3o | 1280 paths | 1280 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1280]
        (linear): Linear(256x0e+384x1o+384x2e+256x3o -> 128x0e+128x1o+128x2e+128x3o | 163840 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o x 89x0e -> 128x0e | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
    )
    (products): ModuleList(
      (0): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
            (1): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x6x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
      )
      (1): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e -> 128x0e | 16384 weights)
      )
    )
    (readouts): ModuleList(
      (0): LinearReadoutBlock(
        (linear): Linear(128x0e+128x1o -> 1x0e | 128 weights)
      )
      (1): NonLinearReadoutBlock(
        (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
        (non_linearity): Activation [x] (16x0e -> 16x0e)
        (linear_2): Linear(16x0e -> 1x0e | 16 weights)
      )
    )
    (scale_shift): ScaleShiftBlock(scale=0.804340, shift=0.164779)
  )
)
2023-11-26 10:20:47.938 INFO: Number of parameters: 4688400
2023-11-26 10:20:47.938 INFO: Optimizer: AcceleratedOptimizer (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    name: interactions_decay
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    name: interactions_no_decay
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    name: products
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2023-11-26 10:20:47.939 INFO: Using gradient clipping with tolerance=10.000
2023-11-26 10:20:47.939 INFO: Started training
2023-11-26 10:20:49.834 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-26 10:20:49.834 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-26 10:20:49.834 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-26 10:20:49.834 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-26 11:29:34.086 INFO: Epoch 152: loss=0.0048, MAE_E_per_atom=17.7 meV, MAE_F=61.4 meV / A, MAE_S_per_atom=0.148 meV / A^3
2023-11-26 11:29:34.088 INFO: Saving current state to data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-152
2023-11-26 11:29:34.160 INFO: Model weights saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-152/pytorch_model.bin
2023-11-26 11:29:34.308 INFO: Optimizer state saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-152/optimizer.bin
2023-11-26 11:29:34.312 INFO: Random states saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-152/random_states_0.pkl
2023-11-26 13:43:04.676 INFO: Epoch 154: loss=0.0048, MAE_E_per_atom=17.7 meV, MAE_F=61.5 meV / A, MAE_S_per_atom=0.146 meV / A^3
2023-11-26 13:43:04.689 INFO: Saving current state to data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-154
2023-11-26 13:43:04.733 INFO: Model weights saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-154/pytorch_model.bin
2023-11-26 13:43:04.821 INFO: Optimizer state saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-154/optimizer.bin
2023-11-26 13:43:04.822 INFO: Random states saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-154/random_states_0.pkl
2023-11-26 16:06:19.202 INFO: Epoch 156: loss=0.0048, MAE_E_per_atom=17.6 meV, MAE_F=61.8 meV / A, MAE_S_per_atom=0.147 meV / A^3
2023-11-26 18:42:56.939 INFO: Epoch 158: loss=0.0048, MAE_E_per_atom=17.6 meV, MAE_F=62.5 meV / A, MAE_S_per_atom=0.146 meV / A^3
2023-11-26 18:58:09.406 INFO: MACE version: 0.1.0
2023-11-26 18:58:09.407 INFO: Configuration: Namespace(name='MACE_MPtrj_2022.9', seed=42, log_dir='data-train-result-stress-128/logs', model_dir='data-train-result-stress-128', checkpoints_dir='data-train-result-stress-128/checkpoints', results_dir='data-train-result-stress-128/results', downloads_dir='data-train-result-stress-128/downloads', default_dtype='float64', log_level='INFO', error_table='PerAtomMAEstress', model='ScaleShiftMACE', r_max=5.0, num_radial_basis=8, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='32x0e', num_channels=128, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=True, compute_forces=True, train_file='./data-train-preprocessed/train.h5', valid_file='./data-train-preprocessed/valid.h5', valid_fraction=0.1, test_file=None, test_dir=None, num_workers=8, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file='./data-train-preprocessed/statistics.json', E0s=None, energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='stress-l1', forces_weight=1.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=500.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=32, valid_batch_size=32, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=160, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=True, restart_lr=5e-05, save_cpu=True, clip_grad=10.0, wandb=False, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-11-26 18:58:09.407 INFO: Using statistics json file
2023-11-26 18:58:09.407 INFO: Using atomic numbers from statistics file
2023-11-26 18:58:09.407 INFO: AtomicNumberTable: (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 89, 90, 91, 92, 93, 94)
2023-11-26 18:58:09.407 INFO: Atomic Energies not in training file, using command line argument E0s
2023-11-26 18:58:09.408 INFO: Atomic energies: [-3.6673775936325184, -1.321978574671279, -3.47815910592578, -4.724966512505185, -7.727941403300326, -8.404543836565129, -7.359429774977432, -7.284436081345614, -4.896162007436489, -0.03005797428312995, -2.7527187727369, -2.8138258116559136, -4.844369939040846, -7.6966307568316115, -6.96321292174237, -4.673811566998673, -2.813984104722163, -0.06233472731112788, -2.6251773081704863, -5.384791381758609, -7.916197568907359, -10.270820955634214, -8.672390387555845, -9.2371580345617, -8.305620224433062, -7.054671703876374, -5.570915377375696, -5.174147851464132, -3.251035550574451, -1.2879654275024013, -3.5321835252059812, -4.711328365973749, -3.9717755452456673, -3.886221455984922, -2.5183143168985502, 6.706842222672468, -2.566057480857263, -4.938993788294903, -10.153603816562159, -11.857062150232505, -12.14164656151253, -8.786094380920531, -8.795434431218645, -7.778351502991773, -6.838726494373795, -4.881216430056056, -2.0605586704343675, -0.6439905162993389, -2.788575343692543, -3.816810475940441, -3.587983770584603, -2.8805917608627976, -1.6360524330360255, 9.796001071919388, -2.7486371263604354, -4.986670776340143, -8.929476698318382, -8.74170685282431, -8.01217127881877, -8.233598378021814, -7.62454389634746, -8.161368139142393, -13.591451290378114, -18.538136714242995, -7.644552511106582, -8.115049752450005, -7.614570319217799, -6.82962645334957, -7.820026786949461, -3.5770491745130024, -7.469205400904766, -12.770648602823787, -14.110986902146283, -9.354405708044254, -11.376459286198285, -9.611613368883013, -7.321263077561875, -5.304305597659051, -2.3873175082519373, 0.24792131307789267, -2.31553585581406, -3.7254481655069127, -3.4301772252097935, -5.065907805804548, -11.017529306980132, -12.244262478240024, -13.846602972246156, -14.952721865054968, -15.303292182007306]
2023-11-26 18:58:09.452 INFO: WeightedEnergyForcesStressLossL1(energy_weight=1.000, forces_weight=1.000, stress_weight=500.000)
2023-11-26 18:58:09.452 INFO: Average number of neighbors: 25.57754135131836
2023-11-26 18:58:09.452 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': True, 'dipoles': False}
2023-11-26 18:58:09.452 INFO: Building model
2023-11-26 18:58:09.452 INFO: Hidden irreps: 128x0e + 128x1o
2023-11-26 18:58:12.461 INFO: Loading states from data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-154
2023-11-26 18:58:12.493 INFO: All model weights loaded successfully
2023-11-26 18:58:12.569 INFO: All optimizer states loaded successfully
2023-11-26 18:58:12.569 INFO: All scheduler states loaded successfully
2023-11-26 18:58:12.572 INFO: All random states loaded successfully
2023-11-26 18:58:12.572 INFO: Loading in 0 custom states
2023-11-26 18:58:12.573 INFO: DistributedDataParallel(
  (module): ScaleShiftMACE(
    (node_embedding): LinearNodeEmbeddingBlock(
      (linear): Linear(89x0e -> 128x0e | 11392 weights)
    )
    (radial_embedding): RadialEmbeddingBlock(
      (bessel_fn): BesselBasis(r_max=4.5, num_basis=8, trainable=False)
      (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
    )
    (spherical_harmonics): SphericalHarmonics()
    (atomic_energies_fn): AtomicEnergiesBlock(energies=[-3.6674, -1.3220, -3.4782, -4.7250, -7.7279, -8.4045, -7.3594, -7.2844, -4.8962, -0.0301, -2.7527, -2.8138, -4.8444, -7.6966, -6.9632, -4.6738, -2.8140, -0.0623, -2.6252, -5.3848, -7.9162, -10.2708, -8.6724, -9.2372, -8.3056, -7.0547, -5.5709, -5.1741, -3.2510, -1.2880, -3.5322, -4.7113, -3.9718, -3.8862, -2.5183, 6.7068, -2.5661, -4.9390, -10.1536, -11.8571, -12.1416, -8.7861, -8.7954, -7.7784, -6.8387, -4.8812, -2.0606, -0.6440, -2.7886, -3.8168, -3.5880, -2.8806, -1.6361, 9.7960, -2.7486, -4.9867, -8.9295, -8.7417, -8.0122, -8.2336, -7.6245, -8.1614, -13.5915, -18.5381, -7.6446, -8.1150, -7.6146, -6.8296, -7.8200, -3.5770, -7.4692, -12.7706, -14.1110, -9.3544, -11.3765, -9.6116, -7.3213, -5.3043, -2.3873, 0.2479, -2.3155, -3.7254, -3.4302, -5.0659, -11.0175, -12.2443, -13.8466, -14.9527, -15.3033])
    (interactions): ModuleList(
      (0): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e -> 128x0e | 16384 weights)
        (conv_tp): TensorProduct(128x0e x 1x0e+1x1o+1x2e+1x3o -> 128x0e+128x1o+128x2e+128x3o | 512 paths | 512 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 512]
        (linear): Linear(128x0e+128x1o+128x2e+128x3o -> 128x0e+128x1o+128x2e+128x3o | 65536 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e x 89x0e -> 128x0e+128x1o | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
      (1): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
        (conv_tp): TensorProduct(128x0e+128x1o x 1x0e+1x1o+1x2e+1x3o -> 256x0e+384x1o+384x2e+256x3o | 1280 paths | 1280 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1280]
        (linear): Linear(256x0e+384x1o+384x2e+256x3o -> 128x0e+128x1o+128x2e+128x3o | 163840 weights)
        (skip_tp): FullyConnectedTensorProduct(128x0e+128x1o x 89x0e -> 128x0e | 1458176 paths | 1458176 weights)
        (reshape): reshape_irreps()
      )
    )
    (products): ModuleList(
      (0): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
            (1): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x6x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e+128x1o -> 128x0e+128x1o | 32768 weights)
      )
      (1): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x128 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x128 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(128x0e -> 128x0e | 16384 weights)
      )
    )
    (readouts): ModuleList(
      (0): LinearReadoutBlock(
        (linear): Linear(128x0e+128x1o -> 1x0e | 128 weights)
      )
      (1): NonLinearReadoutBlock(
        (linear_1): Linear(128x0e -> 16x0e | 2048 weights)
        (non_linearity): Activation [x] (16x0e -> 16x0e)
        (linear_2): Linear(16x0e -> 1x0e | 16 weights)
      )
    )
    (scale_shift): ScaleShiftBlock(scale=0.804340, shift=0.164779)
  )
)
2023-11-26 18:58:12.577 INFO: Number of parameters: 4688400
2023-11-26 18:58:12.577 INFO: Optimizer: AcceleratedOptimizer (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 5e-05
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 5e-05
    maximize: False
    name: interactions_decay
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 5e-05
    maximize: False
    name: interactions_no_decay
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 5e-05
    maximize: False
    name: products
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 5e-05
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2023-11-26 18:58:12.577 INFO: Using gradient clipping with tolerance=10.000
2023-11-26 18:58:12.577 INFO: Started training
2023-11-26 18:58:14.395 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-26 18:58:14.395 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-26 18:58:14.396 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-26 18:58:14.396 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-26 20:07:06.657 INFO: Epoch 154: loss=0.0047, MAE_E_per_atom=17.5 meV, MAE_F=61.4 meV / A, MAE_S_per_atom=0.145 meV / A^3
2023-11-26 20:07:06.659 INFO: Saving current state to data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-154
2023-11-26 20:07:06.732 INFO: Model weights saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-154/pytorch_model.bin
2023-11-26 20:07:06.968 INFO: Optimizer state saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-154/optimizer.bin
2023-11-26 20:07:06.972 INFO: Random states saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-154/random_states_0.pkl
2023-11-26 22:20:48.810 INFO: Epoch 156: loss=0.0047, MAE_E_per_atom=17.5 meV, MAE_F=61.4 meV / A, MAE_S_per_atom=0.145 meV / A^3
2023-11-26 22:20:48.827 INFO: Saving current state to data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-156
2023-11-26 22:20:48.889 INFO: Model weights saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-156/pytorch_model.bin
2023-11-26 22:20:49.018 INFO: Optimizer state saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-156/optimizer.bin
2023-11-26 22:20:49.019 INFO: Random states saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-156/random_states_0.pkl
2023-11-27 00:43:28.668 INFO: Epoch 158: loss=0.0047, MAE_E_per_atom=17.5 meV, MAE_F=61.6 meV / A, MAE_S_per_atom=0.145 meV / A^3
2023-11-27 00:43:28.681 INFO: Saving current state to data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-158
2023-11-27 00:43:28.727 INFO: Model weights saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-158/pytorch_model.bin
2023-11-27 00:43:28.837 INFO: Optimizer state saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-158/optimizer.bin
2023-11-27 00:43:28.838 INFO: Random states saved in data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-158/random_states_0.pkl
2023-11-27 01:56:45.775 INFO: Training complete
2023-11-27 01:56:45.776 INFO: Computing metrics for training, validation, and test sets
2023-11-27 01:56:45.776 INFO: Loading states from data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-158
2023-11-27 01:56:45.805 INFO: All model weights loaded successfully
2023-11-27 01:56:45.870 INFO: All optimizer states loaded successfully
2023-11-27 01:56:45.870 INFO: All scheduler states loaded successfully
2023-11-27 01:56:45.871 INFO: All random states loaded successfully
2023-11-27 01:56:45.871 INFO: Loading in 0 custom states
2023-11-27 01:56:45.871 INFO: Loaded model from epoch 158
2023-11-27 01:56:45.871 INFO: Evaluating train ...
2023-11-27 02:35:45.701 INFO: Evaluating valid ...
2023-11-27 02:44:17.969 INFO: 
++
||
++
++
2023-11-27 02:44:17.971 INFO: Saving model to data-train-result-stress-128/checkpoints/MACE_MPtrj_2022.9_run-42.model
2023-11-27 02:44:18.176 INFO: Done
