2023-09-11 09:11:36.122 INFO: MACE version: 0.1.0
2023-09-11 09:11:36.122 INFO: Configuration: Namespace(name='MACE_MPtrj_2022.9', seed=42, log_dir='data-train-result/logs', model_dir='data-train-result', checkpoints_dir='data-train-result/checkpoints', results_dir='data-train-result/results', downloads_dir='data-train-result/downloads', default_dtype='float64', log_level='INFO', error_table='PerAtomMAE', model='ScaleShiftMACE', r_max=5.0, num_radial_basis=8, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='32x0e', num_channels=256, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=True, compute_forces=True, train_file='./data-train-preprocessed/train.h5', valid_file='./data-train-preprocessed/valid.h5', valid_fraction=0.1, test_file=None, test_dir=None, num_workers=8, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file='./data-train-preprocessed/statistics.json', E0s=None, energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='weighted', forces_weight=1.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=0.5, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=32, valid_batch_size=32, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=100, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=False, save_cpu=False, clip_grad=10.0, wandb=False, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-09-11 09:11:36.123 INFO: Using statistics json file
2023-09-11 09:11:36.123 INFO: Using atomic numbers from statistics file
2023-09-11 09:11:36.123 INFO: AtomicNumberTable: (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 89, 90, 91, 92, 93, 94)
2023-09-11 09:11:36.123 INFO: Atomic Energies not in training file, using command line argument E0s
2023-09-11 09:11:36.124 INFO: Atomic energies: [-3.6673775936325184, -1.321978574671279, -3.47815910592578, -4.724966512505185, -7.727941403300326, -8.404543836565129, -7.359429774977432, -7.284436081345614, -4.896162007436489, -0.03005797428312995, -2.7527187727369, -2.8138258116559136, -4.844369939040846, -7.6966307568316115, -6.96321292174237, -4.673811566998673, -2.813984104722163, -0.06233472731112788, -2.6251773081704863, -5.384791381758609, -7.916197568907359, -10.270820955634214, -8.672390387555845, -9.2371580345617, -8.305620224433062, -7.054671703876374, -5.570915377375696, -5.174147851464132, -3.251035550574451, -1.2879654275024013, -3.5321835252059812, -4.711328365973749, -3.9717755452456673, -3.886221455984922, -2.5183143168985502, 6.706842222672468, -2.566057480857263, -4.938993788294903, -10.153603816562159, -11.857062150232505, -12.14164656151253, -8.786094380920531, -8.795434431218645, -7.778351502991773, -6.838726494373795, -4.881216430056056, -2.0605586704343675, -0.6439905162993389, -2.788575343692543, -3.816810475940441, -3.587983770584603, -2.8805917608627976, -1.6360524330360255, 9.796001071919388, -2.7486371263604354, -4.986670776340143, -8.929476698318382, -8.74170685282431, -8.01217127881877, -8.233598378021814, -7.62454389634746, -8.161368139142393, -13.591451290378114, -18.538136714242995, -7.644552511106582, -8.115049752450005, -7.614570319217799, -6.82962645334957, -7.820026786949461, -3.5770491745130024, -7.469205400904766, -12.770648602823787, -14.110986902146283, -9.354405708044254, -11.376459286198285, -9.611613368883013, -7.321263077561875, -5.304305597659051, -2.3873175082519373, 0.24792131307789267, -2.31553585581406, -3.7254481655069127, -3.4301772252097935, -5.065907805804548, -11.017529306980132, -12.244262478240024, -13.846602972246156, -14.952721865054968, -15.303292182007306]
2023-09-11 09:11:36.168 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1.000)
2023-09-11 09:11:36.168 INFO: Average number of neighbors: 25.57754135131836
2023-09-11 09:11:36.168 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': True, 'dipoles': False}
2023-09-11 09:11:36.168 INFO: Building model
2023-09-11 09:11:36.168 INFO: Hidden irreps: 256x0e + 256x1o
2023-09-11 09:11:39.796 INFO: DistributedDataParallel(
  (module): ScaleShiftMACE(
    (node_embedding): LinearNodeEmbeddingBlock(
      (linear): Linear(89x0e -> 256x0e | 22784 weights)
    )
    (radial_embedding): RadialEmbeddingBlock(
      (bessel_fn): BesselBasis(r_max=4.5, num_basis=8, trainable=False)
      (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
    )
    (spherical_harmonics): SphericalHarmonics()
    (atomic_energies_fn): AtomicEnergiesBlock(energies=[-3.6674, -1.3220, -3.4782, -4.7250, -7.7279, -8.4045, -7.3594, -7.2844, -4.8962, -0.0301, -2.7527, -2.8138, -4.8444, -7.6966, -6.9632, -4.6738, -2.8140, -0.0623, -2.6252, -5.3848, -7.9162, -10.2708, -8.6724, -9.2372, -8.3056, -7.0547, -5.5709, -5.1741, -3.2510, -1.2880, -3.5322, -4.7113, -3.9718, -3.8862, -2.5183, 6.7068, -2.5661, -4.9390, -10.1536, -11.8571, -12.1416, -8.7861, -8.7954, -7.7784, -6.8387, -4.8812, -2.0606, -0.6440, -2.7886, -3.8168, -3.5880, -2.8806, -1.6361, 9.7960, -2.7486, -4.9867, -8.9295, -8.7417, -8.0122, -8.2336, -7.6245, -8.1614, -13.5915, -18.5381, -7.6446, -8.1150, -7.6146, -6.8296, -7.8200, -3.5770, -7.4692, -12.7706, -14.1110, -9.3544, -11.3765, -9.6116, -7.3213, -5.3043, -2.3873, 0.2479, -2.3155, -3.7254, -3.4302, -5.0659, -11.0175, -12.2443, -13.8466, -14.9527, -15.3033])
    (interactions): ModuleList(
      (0): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
        (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
        (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
        (skip_tp): FullyConnectedTensorProduct(256x0e x 89x0e -> 256x0e+256x1o | 5832704 paths | 5832704 weights)
        (reshape): reshape_irreps()
      )
      (1): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(256x0e+256x1o -> 256x0e+256x1o | 131072 weights)
        (conv_tp): TensorProduct(256x0e+256x1o x 1x0e+1x1o+1x2e+1x3o -> 512x0e+768x1o+768x2e+512x3o | 2560 paths | 2560 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 2560]
        (linear): Linear(512x0e+768x1o+768x2e+512x3o -> 256x0e+256x1o+256x2e+256x3o | 655360 weights)
        (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o x 89x0e -> 256x0e | 5832704 paths | 5832704 weights)
        (reshape): reshape_irreps()
      )
    )
    (products): ModuleList(
      (0): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x256 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x256 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
            (1): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x6x256 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x256 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(256x0e+256x1o -> 256x0e+256x1o | 131072 weights)
      )
      (1): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x256 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x256 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(256x0e -> 256x0e | 65536 weights)
      )
    )
    (readouts): ModuleList(
      (0): LinearReadoutBlock(
        (linear): Linear(256x0e+256x1o -> 1x0e | 256 weights)
      )
      (1): NonLinearReadoutBlock(
        (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
        (non_linearity): Activation [x] (16x0e -> 16x0e)
        (linear_2): Linear(16x0e -> 1x0e | 16 weights)
      )
    )
    (scale_shift): ScaleShiftBlock(scale=0.804340, shift=0.164779)
  )
)
2023-09-11 09:11:39.800 INFO: Number of parameters: 15847440
2023-09-11 09:11:39.801 INFO: Optimizer: AcceleratedOptimizer (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.01
    maximize: False
    name: interactions_decay
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.01
    maximize: False
    name: interactions_no_decay
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2023-09-11 09:11:39.801 INFO: Using gradient clipping with tolerance=10.000
2023-09-11 09:11:39.801 INFO: Started training
2023-09-11 09:11:41.883 INFO: Reducer buckets have been rebuilt in this iteration.
2023-09-11 09:11:41.884 INFO: Reducer buckets have been rebuilt in this iteration.
2023-09-11 09:11:41.884 INFO: Reducer buckets have been rebuilt in this iteration.
2023-09-11 09:11:41.884 INFO: Reducer buckets have been rebuilt in this iteration.
2023-09-11 11:18:51.667 INFO: Epoch 0: loss=0.0071, MAE_E_per_atom=91.0 meV, MAE_F=154.7 meV / A
2023-09-11 11:18:51.668 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-0
2023-09-11 11:18:51.804 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-0/pytorch_model.bin
2023-09-11 11:18:52.173 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-0/optimizer.bin
2023-09-11 11:18:52.176 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-0/random_states_0.pkl
2023-09-11 15:25:16.056 INFO: Epoch 2: loss=0.0058, MAE_E_per_atom=61.3 meV, MAE_F=116.7 meV / A
2023-09-11 15:25:16.089 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-2
2023-09-11 15:25:16.216 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-2/pytorch_model.bin
2023-09-11 15:25:16.562 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-2/optimizer.bin
2023-09-11 15:25:16.563 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-2/random_states_0.pkl
2023-09-11 19:31:18.498 INFO: Epoch 4: loss=0.0044, MAE_E_per_atom=54.7 meV, MAE_F=108.9 meV / A
2023-09-11 19:31:18.555 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-4
2023-09-11 19:31:18.760 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-4/pytorch_model.bin
2023-09-11 19:31:19.174 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-4/optimizer.bin
2023-09-11 19:31:19.175 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-4/random_states_0.pkl
2023-09-11 23:37:16.975 INFO: Epoch 6: loss=0.0035, MAE_E_per_atom=48.9 meV, MAE_F=101.4 meV / A
2023-09-11 23:37:17.022 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-6
2023-09-11 23:37:17.220 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-6/pytorch_model.bin
2023-09-11 23:37:17.680 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-6/optimizer.bin
2023-09-11 23:37:17.681 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-6/random_states_0.pkl
2023-09-12 03:43:47.451 INFO: Epoch 8: loss=0.0037, MAE_E_per_atom=47.6 meV, MAE_F=99.4 meV / A
2023-09-12 07:50:24.267 INFO: Epoch 10: loss=0.0035, MAE_E_per_atom=44.3 meV, MAE_F=94.7 meV / A
2023-09-12 11:57:44.826 INFO: Epoch 12: loss=0.0035, MAE_E_per_atom=47.0 meV, MAE_F=100.7 meV / A
2023-09-12 16:06:41.366 INFO: Epoch 14: loss=0.0027, MAE_E_per_atom=43.9 meV, MAE_F=95.3 meV / A
2023-09-12 16:06:41.405 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-14
2023-09-12 16:06:41.551 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-14/pytorch_model.bin
2023-09-12 16:06:41.944 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-14/optimizer.bin
2023-09-12 16:06:41.945 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-14/random_states_0.pkl
2023-09-12 20:19:02.908 INFO: Epoch 16: loss=0.0021, MAE_E_per_atom=42.1 meV, MAE_F=91.3 meV / A
2023-09-12 20:19:02.947 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-16
2023-09-12 20:19:03.074 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-16/pytorch_model.bin
2023-09-12 20:19:03.411 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-16/optimizer.bin
2023-09-12 20:19:03.412 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-16/random_states_0.pkl
2023-09-13 00:35:35.064 INFO: Epoch 18: loss=0.0025, MAE_E_per_atom=42.2 meV, MAE_F=92.4 meV / A
2023-09-13 04:54:17.373 INFO: Epoch 20: loss=0.0030, MAE_E_per_atom=40.7 meV, MAE_F=89.5 meV / A
2023-09-13 09:18:42.863 INFO: Epoch 22: loss=0.0029, MAE_E_per_atom=39.4 meV, MAE_F=86.8 meV / A
2023-09-13 13:47:32.199 INFO: Epoch 24: loss=0.0035, MAE_E_per_atom=40.7 meV, MAE_F=89.0 meV / A
2023-09-13 18:24:54.835 INFO: Epoch 26: loss=0.0031, MAE_E_per_atom=38.3 meV, MAE_F=85.6 meV / A
2023-09-13 23:07:53.844 INFO: Epoch 28: loss=0.0023, MAE_E_per_atom=38.3 meV, MAE_F=85.4 meV / A
2023-09-14 04:02:16.050 INFO: Epoch 30: loss=0.0021, MAE_E_per_atom=38.3 meV, MAE_F=84.4 meV / A
2023-09-14 04:02:16.096 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-30
2023-09-14 04:02:16.243 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-30/pytorch_model.bin
2023-09-14 04:02:16.608 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-30/optimizer.bin
2023-09-14 04:02:16.609 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-30/random_states_0.pkl
2023-09-14 09:00:28.747 INFO: Epoch 32: loss=0.0021, MAE_E_per_atom=39.6 meV, MAE_F=86.4 meV / A
2023-09-14 14:20:05.907 INFO: Epoch 34: loss=0.0021, MAE_E_per_atom=36.5 meV, MAE_F=83.2 meV / A
2023-09-14 20:02:35.859 INFO: Epoch 36: loss=0.0019, MAE_E_per_atom=36.2 meV, MAE_F=81.6 meV / A
2023-09-14 20:02:35.897 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-36
2023-09-14 20:02:36.019 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-36/pytorch_model.bin
2023-09-14 20:02:36.352 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-36/optimizer.bin
2023-09-14 20:02:36.354 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-36/random_states_0.pkl
2023-09-15 01:45:01.228 INFO: Epoch 38: loss=0.0021, MAE_E_per_atom=36.3 meV, MAE_F=82.5 meV / A
2023-09-15 07:36:44.741 INFO: Epoch 40: loss=0.0026, MAE_E_per_atom=36.0 meV, MAE_F=81.8 meV / A
2023-09-15 13:33:46.272 INFO: Epoch 42: loss=0.0017, MAE_E_per_atom=36.2 meV, MAE_F=81.4 meV / A
2023-09-15 13:33:46.307 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-42
2023-09-15 13:33:46.431 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-42/pytorch_model.bin
2023-09-15 13:33:46.765 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-42/optimizer.bin
2023-09-15 13:33:46.766 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-42/random_states_0.pkl
2023-09-15 19:41:41.585 INFO: Epoch 44: loss=0.0022, MAE_E_per_atom=36.5 meV, MAE_F=82.9 meV / A
2023-09-16 01:59:44.862 INFO: Epoch 46: loss=0.0019, MAE_E_per_atom=34.9 meV, MAE_F=79.8 meV / A
2023-09-16 08:17:10.161 INFO: Epoch 48: loss=0.0025, MAE_E_per_atom=35.4 meV, MAE_F=81.0 meV / A
2023-09-16 14:55:31.710 INFO: Epoch 50: loss=0.0023, MAE_E_per_atom=34.4 meV, MAE_F=79.2 meV / A
2023-09-16 21:42:55.749 INFO: Epoch 52: loss=0.0019, MAE_E_per_atom=35.0 meV, MAE_F=79.7 meV / A
2023-09-17 04:41:59.102 INFO: Epoch 54: loss=0.0024, MAE_E_per_atom=33.6 meV, MAE_F=78.1 meV / A
2023-09-17 11:46:01.221 INFO: Epoch 56: loss=0.0018, MAE_E_per_atom=33.9 meV, MAE_F=77.7 meV / A
2023-09-17 19:03:53.123 INFO: Epoch 58: loss=0.0016, MAE_E_per_atom=35.6 meV, MAE_F=82.5 meV / A
2023-09-17 19:03:53.154 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-58
2023-09-17 19:03:53.279 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-58/pytorch_model.bin
2023-09-17 19:03:53.612 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-58/optimizer.bin
2023-09-17 19:03:53.613 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-58/random_states_0.pkl
2023-09-18 02:30:15.278 INFO: Epoch 60: loss=0.0017, MAE_E_per_atom=34.2 meV, MAE_F=78.5 meV / A
2023-09-18 09:57:37.246 INFO: Epoch 62: loss=0.0017, MAE_E_per_atom=33.1 meV, MAE_F=77.4 meV / A
2023-09-18 17:17:58.939 INFO: MACE version: 0.1.0
2023-09-18 17:17:58.939 INFO: Configuration: Namespace(name='MACE_MPtrj_2022.9', seed=42, log_dir='data-train-result/logs', model_dir='data-train-result', checkpoints_dir='data-train-result/checkpoints', results_dir='data-train-result/results', downloads_dir='data-train-result/downloads', default_dtype='float64', log_level='INFO', error_table='PerAtomMAE', model='ScaleShiftMACE', r_max=5.0, num_radial_basis=8, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='32x0e', num_channels=256, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=True, compute_forces=True, train_file='./data-train-preprocessed/train.h5', valid_file='./data-train-preprocessed/valid.h5', valid_fraction=0.1, test_file=None, test_dir=None, num_workers=8, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file='./data-train-preprocessed/statistics.json', E0s=None, energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='weighted', forces_weight=1.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=0.5, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=32, valid_batch_size=32, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=100, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=True, save_cpu=False, clip_grad=10.0, wandb=False, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-09-18 17:17:58.939 INFO: Using statistics json file
2023-09-18 17:17:58.939 INFO: Using atomic numbers from statistics file
2023-09-18 17:17:58.940 INFO: AtomicNumberTable: (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 89, 90, 91, 92, 93, 94)
2023-09-18 17:17:58.940 INFO: Atomic Energies not in training file, using command line argument E0s
2023-09-18 17:17:58.940 INFO: Atomic energies: [-3.6673775936325184, -1.321978574671279, -3.47815910592578, -4.724966512505185, -7.727941403300326, -8.404543836565129, -7.359429774977432, -7.284436081345614, -4.896162007436489, -0.03005797428312995, -2.7527187727369, -2.8138258116559136, -4.844369939040846, -7.6966307568316115, -6.96321292174237, -4.673811566998673, -2.813984104722163, -0.06233472731112788, -2.6251773081704863, -5.384791381758609, -7.916197568907359, -10.270820955634214, -8.672390387555845, -9.2371580345617, -8.305620224433062, -7.054671703876374, -5.570915377375696, -5.174147851464132, -3.251035550574451, -1.2879654275024013, -3.5321835252059812, -4.711328365973749, -3.9717755452456673, -3.886221455984922, -2.5183143168985502, 6.706842222672468, -2.566057480857263, -4.938993788294903, -10.153603816562159, -11.857062150232505, -12.14164656151253, -8.786094380920531, -8.795434431218645, -7.778351502991773, -6.838726494373795, -4.881216430056056, -2.0605586704343675, -0.6439905162993389, -2.788575343692543, -3.816810475940441, -3.587983770584603, -2.8805917608627976, -1.6360524330360255, 9.796001071919388, -2.7486371263604354, -4.986670776340143, -8.929476698318382, -8.74170685282431, -8.01217127881877, -8.233598378021814, -7.62454389634746, -8.161368139142393, -13.591451290378114, -18.538136714242995, -7.644552511106582, -8.115049752450005, -7.614570319217799, -6.82962645334957, -7.820026786949461, -3.5770491745130024, -7.469205400904766, -12.770648602823787, -14.110986902146283, -9.354405708044254, -11.376459286198285, -9.611613368883013, -7.321263077561875, -5.304305597659051, -2.3873175082519373, 0.24792131307789267, -2.31553585581406, -3.7254481655069127, -3.4301772252097935, -5.065907805804548, -11.017529306980132, -12.244262478240024, -13.846602972246156, -14.952721865054968, -15.303292182007306]
2023-09-18 17:18:03.428 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1.000)
2023-09-18 17:18:03.430 INFO: Average number of neighbors: 25.57754135131836
2023-09-18 17:18:03.430 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': True, 'dipoles': False}
2023-09-18 17:18:03.430 INFO: Building model
2023-09-18 17:18:03.430 INFO: Hidden irreps: 256x0e + 256x1o
2023-09-18 17:18:07.656 INFO: Loading states from data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-58
2023-09-18 17:18:07.796 INFO: All model weights loaded successfully
2023-09-18 17:18:08.164 INFO: All optimizer states loaded successfully
2023-09-18 17:18:08.164 INFO: All scheduler states loaded successfully
2023-09-18 17:18:08.167 INFO: All random states loaded successfully
2023-09-18 17:18:08.167 INFO: Loading in 0 custom states
2023-09-18 17:18:08.168 INFO: DistributedDataParallel(
  (module): ScaleShiftMACE(
    (node_embedding): LinearNodeEmbeddingBlock(
      (linear): Linear(89x0e -> 256x0e | 22784 weights)
    )
    (radial_embedding): RadialEmbeddingBlock(
      (bessel_fn): BesselBasis(r_max=4.5, num_basis=8, trainable=False)
      (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
    )
    (spherical_harmonics): SphericalHarmonics()
    (atomic_energies_fn): AtomicEnergiesBlock(energies=[-3.6674, -1.3220, -3.4782, -4.7250, -7.7279, -8.4045, -7.3594, -7.2844, -4.8962, -0.0301, -2.7527, -2.8138, -4.8444, -7.6966, -6.9632, -4.6738, -2.8140, -0.0623, -2.6252, -5.3848, -7.9162, -10.2708, -8.6724, -9.2372, -8.3056, -7.0547, -5.5709, -5.1741, -3.2510, -1.2880, -3.5322, -4.7113, -3.9718, -3.8862, -2.5183, 6.7068, -2.5661, -4.9390, -10.1536, -11.8571, -12.1416, -8.7861, -8.7954, -7.7784, -6.8387, -4.8812, -2.0606, -0.6440, -2.7886, -3.8168, -3.5880, -2.8806, -1.6361, 9.7960, -2.7486, -4.9867, -8.9295, -8.7417, -8.0122, -8.2336, -7.6245, -8.1614, -13.5915, -18.5381, -7.6446, -8.1150, -7.6146, -6.8296, -7.8200, -3.5770, -7.4692, -12.7706, -14.1110, -9.3544, -11.3765, -9.6116, -7.3213, -5.3043, -2.3873, 0.2479, -2.3155, -3.7254, -3.4302, -5.0659, -11.0175, -12.2443, -13.8466, -14.9527, -15.3033])
    (interactions): ModuleList(
      (0): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
        (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
        (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
        (skip_tp): FullyConnectedTensorProduct(256x0e x 89x0e -> 256x0e+256x1o | 5832704 paths | 5832704 weights)
        (reshape): reshape_irreps()
      )
      (1): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(256x0e+256x1o -> 256x0e+256x1o | 131072 weights)
        (conv_tp): TensorProduct(256x0e+256x1o x 1x0e+1x1o+1x2e+1x3o -> 512x0e+768x1o+768x2e+512x3o | 2560 paths | 2560 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 2560]
        (linear): Linear(512x0e+768x1o+768x2e+512x3o -> 256x0e+256x1o+256x2e+256x3o | 655360 weights)
        (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o x 89x0e -> 256x0e | 5832704 paths | 5832704 weights)
        (reshape): reshape_irreps()
      )
    )
    (products): ModuleList(
      (0): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x256 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x256 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
            (1): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x6x256 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x256 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(256x0e+256x1o -> 256x0e+256x1o | 131072 weights)
      )
      (1): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x256 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x256 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(256x0e -> 256x0e | 65536 weights)
      )
    )
    (readouts): ModuleList(
      (0): LinearReadoutBlock(
        (linear): Linear(256x0e+256x1o -> 1x0e | 256 weights)
      )
      (1): NonLinearReadoutBlock(
        (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
        (non_linearity): Activation [x] (16x0e -> 16x0e)
        (linear_2): Linear(16x0e -> 1x0e | 16 weights)
      )
    )
    (scale_shift): ScaleShiftBlock(scale=0.804340, shift=0.164779)
  )
)
2023-09-18 17:18:08.172 INFO: Number of parameters: 15847440
2023-09-18 17:18:08.172 INFO: Optimizer: AcceleratedOptimizer (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.01
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.01
    maximize: False
    name: interactions_decay
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.01
    maximize: False
    name: interactions_no_decay
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.01
    maximize: False
    name: products
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.01
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2023-09-18 17:18:08.172 INFO: Using gradient clipping with tolerance=10.000
2023-09-18 17:18:08.172 INFO: Started training
2023-09-18 17:18:10.354 INFO: Reducer buckets have been rebuilt in this iteration.
2023-09-18 17:18:10.356 INFO: Reducer buckets have been rebuilt in this iteration.
2023-09-18 17:18:10.356 INFO: Reducer buckets have been rebuilt in this iteration.
2023-09-18 17:18:10.356 INFO: Reducer buckets have been rebuilt in this iteration.
2023-09-18 19:24:50.782 INFO: Epoch 58: loss=0.0016, MAE_E_per_atom=33.4 meV, MAE_F=78.3 meV / A
2023-09-18 19:24:50.784 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-58
2023-09-18 19:24:51.032 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-58/pytorch_model.bin
2023-09-18 19:24:51.563 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-58/optimizer.bin
2023-09-18 19:24:51.567 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-58/random_states_0.pkl
2023-09-18 23:30:06.010 INFO: Epoch 60: loss=0.0018, MAE_E_per_atom=33.8 meV, MAE_F=78.0 meV / A
2023-09-19 03:35:20.749 INFO: Epoch 62: loss=0.0017, MAE_E_per_atom=33.2 meV, MAE_F=76.4 meV / A
2023-09-19 07:40:42.201 INFO: Epoch 64: loss=0.0017, MAE_E_per_atom=35.2 meV, MAE_F=80.4 meV / A
2023-09-19 11:46:03.057 INFO: Epoch 66: loss=0.0017, MAE_E_per_atom=32.9 meV, MAE_F=76.6 meV / A
2023-09-19 15:51:35.475 INFO: Epoch 68: loss=0.0019, MAE_E_per_atom=32.4 meV, MAE_F=75.5 meV / A
2023-09-19 19:57:41.950 INFO: Epoch 70: loss=0.0016, MAE_E_per_atom=32.9 meV, MAE_F=75.9 meV / A
2023-09-20 00:04:26.457 INFO: Epoch 72: loss=0.0024, MAE_E_per_atom=32.8 meV, MAE_F=75.7 meV / A
2023-09-20 04:13:19.594 INFO: Epoch 74: loss=0.0015, MAE_E_per_atom=32.3 meV, MAE_F=74.6 meV / A
2023-09-20 04:13:19.634 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-74
2023-09-20 04:13:19.778 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-74/pytorch_model.bin
2023-09-20 04:13:20.169 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-74/optimizer.bin
2023-09-20 04:13:20.170 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-74/random_states_0.pkl
2023-09-20 08:24:28.895 INFO: Epoch 76: loss=0.0016, MAE_E_per_atom=32.2 meV, MAE_F=74.9 meV / A
2023-09-20 12:41:02.570 INFO: Epoch 78: loss=0.0016, MAE_E_per_atom=32.2 meV, MAE_F=74.8 meV / A
2023-09-20 16:58:58.001 INFO: Epoch 80: loss=0.0019, MAE_E_per_atom=31.5 meV, MAE_F=73.4 meV / A
2023-09-20 21:20:01.810 INFO: Epoch 82: loss=0.0020, MAE_E_per_atom=31.8 meV, MAE_F=73.9 meV / A
2023-09-21 01:44:48.011 INFO: Epoch 84: loss=0.0022, MAE_E_per_atom=31.6 meV, MAE_F=73.8 meV / A
2023-09-21 06:14:40.716 INFO: Epoch 86: loss=0.0017, MAE_E_per_atom=31.3 meV, MAE_F=72.8 meV / A
2023-09-21 10:49:52.878 INFO: Epoch 88: loss=0.0019, MAE_E_per_atom=31.4 meV, MAE_F=73.5 meV / A
2023-09-21 15:29:51.548 INFO: Epoch 90: loss=0.0015, MAE_E_per_atom=30.9 meV, MAE_F=72.7 meV / A
2023-09-21 15:29:51.625 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-90
2023-09-21 15:29:51.842 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-90/pytorch_model.bin
2023-09-21 15:29:52.179 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-90/optimizer.bin
2023-09-21 15:29:52.180 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-90/random_states_0.pkl
2023-09-21 20:20:31.686 INFO: Epoch 92: loss=0.0018, MAE_E_per_atom=30.7 meV, MAE_F=72.4 meV / A
2023-09-22 01:15:30.168 INFO: Epoch 94: loss=0.0015, MAE_E_per_atom=30.9 meV, MAE_F=71.9 meV / A
2023-09-22 06:16:09.024 INFO: Epoch 96: loss=0.0017, MAE_E_per_atom=36.4 meV, MAE_F=81.3 meV / A
2023-09-22 11:26:00.341 INFO: Epoch 98: loss=0.0018, MAE_E_per_atom=32.1 meV, MAE_F=74.8 meV / A
2023-09-22 13:57:10.542 INFO: Training complete
2023-09-22 13:57:10.542 INFO: Computing metrics for training, validation, and test sets
2023-09-22 13:57:10.543 INFO: Loading states from data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-90
2023-09-22 13:57:10.622 INFO: All model weights loaded successfully
2023-09-22 13:57:10.823 INFO: All optimizer states loaded successfully
2023-09-22 13:57:10.823 INFO: All scheduler states loaded successfully
2023-09-22 13:57:10.824 INFO: All random states loaded successfully
2023-09-22 13:57:10.824 INFO: Loading in 0 custom states
2023-09-22 13:57:10.824 INFO: Loaded model from epoch 90
2023-09-22 13:57:10.824 INFO: Evaluating train ...
2023-09-22 15:10:11.894 INFO: Evaluating valid ...
2023-09-22 15:25:16.732 INFO: 
+-------------+--------------------+-----------------+------------------+
| config_type | MAE E / meV / atom | MAE F / meV / A | relative F MAE % |
+-------------+--------------------+-----------------+------------------+
|    train    |        30.5        |       71.6      |      45.27       |
|    valid    |        30.9        |       72.7      |      47.17       |
+-------------+--------------------+-----------------+------------------+
2023-09-22 15:25:16.734 INFO: Saving model to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42.model
2023-09-22 15:25:17.079 INFO: Done
2023-10-20 14:57:36.333 INFO: MACE version: 0.1.0
2023-10-20 14:57:36.333 INFO: Configuration: Namespace(name='MACE_MPtrj_2022.9', seed=42, log_dir='data-train-result/logs', model_dir='data-train-result', checkpoints_dir='data-train-result/checkpoints', results_dir='data-train-result/results', downloads_dir='data-train-result/downloads', default_dtype='float64', log_level='INFO', error_table='PerAtomMAE', model='ScaleShiftMACE', r_max=5.0, num_radial_basis=8, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='32x0e', num_channels=256, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=True, compute_forces=True, train_file='./data-train-preprocessed/train.h5', valid_file='./data-train-preprocessed/valid.h5', valid_fraction=0.1, test_file=None, test_dir=None, num_workers=8, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file='./data-train-preprocessed/statistics.json', E0s=None, energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='weighted', forces_weight=1.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=0.1, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=32, valid_batch_size=32, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=250, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=True, restart_lr=0.002, save_cpu=False, clip_grad=10.0, wandb=False, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-10-20 14:57:36.333 INFO: Using statistics json file
2023-10-20 14:57:36.333 INFO: Using atomic numbers from statistics file
2023-10-20 14:57:36.334 INFO: AtomicNumberTable: (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 89, 90, 91, 92, 93, 94)
2023-10-20 14:57:36.334 INFO: Atomic Energies not in training file, using command line argument E0s
2023-10-20 14:57:36.334 INFO: Atomic energies: [-3.6673775936325184, -1.321978574671279, -3.47815910592578, -4.724966512505185, -7.727941403300326, -8.404543836565129, -7.359429774977432, -7.284436081345614, -4.896162007436489, -0.03005797428312995, -2.7527187727369, -2.8138258116559136, -4.844369939040846, -7.6966307568316115, -6.96321292174237, -4.673811566998673, -2.813984104722163, -0.06233472731112788, -2.6251773081704863, -5.384791381758609, -7.916197568907359, -10.270820955634214, -8.672390387555845, -9.2371580345617, -8.305620224433062, -7.054671703876374, -5.570915377375696, -5.174147851464132, -3.251035550574451, -1.2879654275024013, -3.5321835252059812, -4.711328365973749, -3.9717755452456673, -3.886221455984922, -2.5183143168985502, 6.706842222672468, -2.566057480857263, -4.938993788294903, -10.153603816562159, -11.857062150232505, -12.14164656151253, -8.786094380920531, -8.795434431218645, -7.778351502991773, -6.838726494373795, -4.881216430056056, -2.0605586704343675, -0.6439905162993389, -2.788575343692543, -3.816810475940441, -3.587983770584603, -2.8805917608627976, -1.6360524330360255, 9.796001071919388, -2.7486371263604354, -4.986670776340143, -8.929476698318382, -8.74170685282431, -8.01217127881877, -8.233598378021814, -7.62454389634746, -8.161368139142393, -13.591451290378114, -18.538136714242995, -7.644552511106582, -8.115049752450005, -7.614570319217799, -6.82962645334957, -7.820026786949461, -3.5770491745130024, -7.469205400904766, -12.770648602823787, -14.110986902146283, -9.354405708044254, -11.376459286198285, -9.611613368883013, -7.321263077561875, -5.304305597659051, -2.3873175082519373, 0.24792131307789267, -2.31553585581406, -3.7254481655069127, -3.4301772252097935, -5.065907805804548, -11.017529306980132, -12.244262478240024, -13.846602972246156, -14.952721865054968, -15.303292182007306]
2023-10-20 14:57:36.382 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1.000)
2023-10-20 14:57:36.382 INFO: Average number of neighbors: 25.57754135131836
2023-10-20 14:57:36.382 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': True, 'dipoles': False}
2023-10-20 14:57:36.382 INFO: Building model
2023-10-20 14:57:36.382 INFO: Hidden irreps: 256x0e + 256x1o
2023-10-20 14:57:39.880 INFO: Loading states from data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-90
2023-10-20 14:57:39.950 INFO: All model weights loaded successfully
2023-10-20 14:57:40.143 INFO: All optimizer states loaded successfully
2023-10-20 14:57:40.143 INFO: All scheduler states loaded successfully
2023-10-20 14:57:40.145 INFO: All random states loaded successfully
2023-10-20 14:57:40.146 INFO: Loading in 0 custom states
2023-10-20 14:57:40.146 INFO: DistributedDataParallel(
  (module): ScaleShiftMACE(
    (node_embedding): LinearNodeEmbeddingBlock(
      (linear): Linear(89x0e -> 256x0e | 22784 weights)
    )
    (radial_embedding): RadialEmbeddingBlock(
      (bessel_fn): BesselBasis(r_max=4.5, num_basis=8, trainable=False)
      (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
    )
    (spherical_harmonics): SphericalHarmonics()
    (atomic_energies_fn): AtomicEnergiesBlock(energies=[-3.6674, -1.3220, -3.4782, -4.7250, -7.7279, -8.4045, -7.3594, -7.2844, -4.8962, -0.0301, -2.7527, -2.8138, -4.8444, -7.6966, -6.9632, -4.6738, -2.8140, -0.0623, -2.6252, -5.3848, -7.9162, -10.2708, -8.6724, -9.2372, -8.3056, -7.0547, -5.5709, -5.1741, -3.2510, -1.2880, -3.5322, -4.7113, -3.9718, -3.8862, -2.5183, 6.7068, -2.5661, -4.9390, -10.1536, -11.8571, -12.1416, -8.7861, -8.7954, -7.7784, -6.8387, -4.8812, -2.0606, -0.6440, -2.7886, -3.8168, -3.5880, -2.8806, -1.6361, 9.7960, -2.7486, -4.9867, -8.9295, -8.7417, -8.0122, -8.2336, -7.6245, -8.1614, -13.5915, -18.5381, -7.6446, -8.1150, -7.6146, -6.8296, -7.8200, -3.5770, -7.4692, -12.7706, -14.1110, -9.3544, -11.3765, -9.6116, -7.3213, -5.3043, -2.3873, 0.2479, -2.3155, -3.7254, -3.4302, -5.0659, -11.0175, -12.2443, -13.8466, -14.9527, -15.3033])
    (interactions): ModuleList(
      (0): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
        (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
        (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
        (skip_tp): FullyConnectedTensorProduct(256x0e x 89x0e -> 256x0e+256x1o | 5832704 paths | 5832704 weights)
        (reshape): reshape_irreps()
      )
      (1): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(256x0e+256x1o -> 256x0e+256x1o | 131072 weights)
        (conv_tp): TensorProduct(256x0e+256x1o x 1x0e+1x1o+1x2e+1x3o -> 512x0e+768x1o+768x2e+512x3o | 2560 paths | 2560 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 2560]
        (linear): Linear(512x0e+768x1o+768x2e+512x3o -> 256x0e+256x1o+256x2e+256x3o | 655360 weights)
        (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o x 89x0e -> 256x0e | 5832704 paths | 5832704 weights)
        (reshape): reshape_irreps()
      )
    )
    (products): ModuleList(
      (0): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x256 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x256 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
            (1): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x6x256 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x256 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(256x0e+256x1o -> 256x0e+256x1o | 131072 weights)
      )
      (1): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x256 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x256 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(256x0e -> 256x0e | 65536 weights)
      )
    )
    (readouts): ModuleList(
      (0): LinearReadoutBlock(
        (linear): Linear(256x0e+256x1o -> 1x0e | 256 weights)
      )
      (1): NonLinearReadoutBlock(
        (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
        (non_linearity): Activation [x] (16x0e -> 16x0e)
        (linear_2): Linear(16x0e -> 1x0e | 16 weights)
      )
    )
    (scale_shift): ScaleShiftBlock(scale=0.804340, shift=0.164779)
  )
)
2023-10-20 14:57:40.150 INFO: Number of parameters: 15847440
2023-10-20 14:57:40.151 INFO: Optimizer: AcceleratedOptimizer (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.002
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.002
    maximize: False
    name: interactions_decay
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.002
    maximize: False
    name: interactions_no_decay
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.002
    maximize: False
    name: products
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.002
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2023-10-20 14:57:40.151 INFO: Using gradient clipping with tolerance=10.000
2023-10-20 14:57:40.151 INFO: Started training
2023-10-20 14:57:42.215 INFO: Reducer buckets have been rebuilt in this iteration.
2023-10-20 14:57:42.215 INFO: Reducer buckets have been rebuilt in this iteration.
2023-10-20 14:57:42.215 INFO: Reducer buckets have been rebuilt in this iteration.
2023-10-20 14:57:42.216 INFO: Reducer buckets have been rebuilt in this iteration.
2023-10-20 17:04:55.100 INFO: Epoch 90: loss=0.0013, MAE_E_per_atom=29.4 meV, MAE_F=70.4 meV / A
2023-10-20 17:04:55.101 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-90
2023-10-20 17:04:55.289 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-90/pytorch_model.bin
2023-10-20 17:04:55.801 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-90/optimizer.bin
2023-10-20 17:04:55.805 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-90/random_states_0.pkl
2023-10-20 21:11:26.897 INFO: Epoch 92: loss=0.0015, MAE_E_per_atom=28.8 meV, MAE_F=69.7 meV / A
2023-10-21 01:18:05.647 INFO: Epoch 94: loss=0.0014, MAE_E_per_atom=28.7 meV, MAE_F=69.4 meV / A
2023-10-21 05:24:59.300 INFO: Epoch 96: loss=0.0013, MAE_E_per_atom=28.6 meV, MAE_F=69.1 meV / A
2023-10-21 05:24:59.335 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-96
2023-10-21 05:24:59.468 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-96/pytorch_model.bin
2023-10-21 05:24:59.824 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-96/optimizer.bin
2023-10-21 05:24:59.825 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-96/random_states_0.pkl
2023-10-21 09:31:50.986 INFO: Epoch 98: loss=0.0014, MAE_E_per_atom=28.5 meV, MAE_F=68.9 meV / A
2023-10-21 13:39:03.138 INFO: Epoch 100: loss=0.0015, MAE_E_per_atom=28.3 meV, MAE_F=68.7 meV / A
2023-10-21 17:46:28.938 INFO: Epoch 102: loss=0.0015, MAE_E_per_atom=28.4 meV, MAE_F=68.9 meV / A
2023-10-21 21:54:51.251 INFO: Epoch 104: loss=0.0016, MAE_E_per_atom=28.0 meV, MAE_F=68.5 meV / A
2023-10-22 02:04:46.783 INFO: Epoch 106: loss=0.0013, MAE_E_per_atom=28.2 meV, MAE_F=68.3 meV / A
2023-10-22 06:18:06.375 INFO: Epoch 108: loss=0.0014, MAE_E_per_atom=28.0 meV, MAE_F=68.4 meV / A
2023-10-22 10:34:37.415 INFO: Epoch 110: loss=0.0015, MAE_E_per_atom=27.9 meV, MAE_F=68.2 meV / A
2023-10-22 14:55:27.797 INFO: Epoch 112: loss=0.0015, MAE_E_per_atom=28.0 meV, MAE_F=68.0 meV / A
2023-10-22 19:21:20.941 INFO: Epoch 114: loss=0.0015, MAE_E_per_atom=27.9 meV, MAE_F=68.2 meV / A
2023-10-22 23:52:28.607 INFO: Epoch 116: loss=0.0016, MAE_E_per_atom=27.7 meV, MAE_F=67.9 meV / A
2023-10-23 04:29:18.651 INFO: Epoch 118: loss=0.0014, MAE_E_per_atom=27.9 meV, MAE_F=67.8 meV / A
2023-10-23 09:11:30.954 INFO: Epoch 120: loss=0.0015, MAE_E_per_atom=27.8 meV, MAE_F=67.7 meV / A
2023-10-23 12:24:04.234 INFO: MACE version: 0.1.0
2023-10-23 12:24:04.235 INFO: Configuration: Namespace(name='MACE_MPtrj_2022.9', seed=42, log_dir='data-train-result/logs', model_dir='data-train-result', checkpoints_dir='data-train-result/checkpoints', results_dir='data-train-result/results', downloads_dir='data-train-result/downloads', default_dtype='float64', log_level='INFO', error_table='PerAtomMAE', model='ScaleShiftMACE', r_max=5.0, num_radial_basis=8, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='32x0e', num_channels=256, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=True, compute_forces=True, train_file='./data-train-preprocessed/train.h5', valid_file='./data-train-preprocessed/valid.h5', valid_fraction=0.1, test_file=None, test_dir=None, num_workers=8, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file='./data-train-preprocessed/statistics.json', E0s=None, energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='weighted', forces_weight=1.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=0.1, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=32, valid_batch_size=32, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=250, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=True, restart_lr=0.002, save_cpu=False, clip_grad=10.0, wandb=False, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-10-23 12:24:04.235 INFO: Using statistics json file
2023-10-23 12:24:04.235 INFO: Using atomic numbers from statistics file
2023-10-23 12:24:04.235 INFO: AtomicNumberTable: (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 89, 90, 91, 92, 93, 94)
2023-10-23 12:24:04.235 INFO: Atomic Energies not in training file, using command line argument E0s
2023-10-23 12:24:04.236 INFO: Atomic energies: [-3.6673775936325184, -1.321978574671279, -3.47815910592578, -4.724966512505185, -7.727941403300326, -8.404543836565129, -7.359429774977432, -7.284436081345614, -4.896162007436489, -0.03005797428312995, -2.7527187727369, -2.8138258116559136, -4.844369939040846, -7.6966307568316115, -6.96321292174237, -4.673811566998673, -2.813984104722163, -0.06233472731112788, -2.6251773081704863, -5.384791381758609, -7.916197568907359, -10.270820955634214, -8.672390387555845, -9.2371580345617, -8.305620224433062, -7.054671703876374, -5.570915377375696, -5.174147851464132, -3.251035550574451, -1.2879654275024013, -3.5321835252059812, -4.711328365973749, -3.9717755452456673, -3.886221455984922, -2.5183143168985502, 6.706842222672468, -2.566057480857263, -4.938993788294903, -10.153603816562159, -11.857062150232505, -12.14164656151253, -8.786094380920531, -8.795434431218645, -7.778351502991773, -6.838726494373795, -4.881216430056056, -2.0605586704343675, -0.6439905162993389, -2.788575343692543, -3.816810475940441, -3.587983770584603, -2.8805917608627976, -1.6360524330360255, 9.796001071919388, -2.7486371263604354, -4.986670776340143, -8.929476698318382, -8.74170685282431, -8.01217127881877, -8.233598378021814, -7.62454389634746, -8.161368139142393, -13.591451290378114, -18.538136714242995, -7.644552511106582, -8.115049752450005, -7.614570319217799, -6.82962645334957, -7.820026786949461, -3.5770491745130024, -7.469205400904766, -12.770648602823787, -14.110986902146283, -9.354405708044254, -11.376459286198285, -9.611613368883013, -7.321263077561875, -5.304305597659051, -2.3873175082519373, 0.24792131307789267, -2.31553585581406, -3.7254481655069127, -3.4301772252097935, -5.065907805804548, -11.017529306980132, -12.244262478240024, -13.846602972246156, -14.952721865054968, -15.303292182007306]
2023-10-23 12:24:04.293 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1.000)
2023-10-23 12:24:04.293 INFO: Average number of neighbors: 25.57754135131836
2023-10-23 12:24:04.293 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': True, 'dipoles': False}
2023-10-23 12:24:04.293 INFO: Building model
2023-10-23 12:24:04.293 INFO: Hidden irreps: 256x0e + 256x1o
2023-10-23 12:24:07.815 INFO: Loading states from data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-96
2023-10-23 12:24:07.896 INFO: All model weights loaded successfully
2023-10-23 12:24:08.110 INFO: All optimizer states loaded successfully
2023-10-23 12:24:08.111 INFO: All scheduler states loaded successfully
2023-10-23 12:24:08.115 INFO: All random states loaded successfully
2023-10-23 12:24:08.115 INFO: Loading in 0 custom states
2023-10-23 12:24:08.116 INFO: DistributedDataParallel(
  (module): ScaleShiftMACE(
    (node_embedding): LinearNodeEmbeddingBlock(
      (linear): Linear(89x0e -> 256x0e | 22784 weights)
    )
    (radial_embedding): RadialEmbeddingBlock(
      (bessel_fn): BesselBasis(r_max=4.5, num_basis=8, trainable=False)
      (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
    )
    (spherical_harmonics): SphericalHarmonics()
    (atomic_energies_fn): AtomicEnergiesBlock(energies=[-3.6674, -1.3220, -3.4782, -4.7250, -7.7279, -8.4045, -7.3594, -7.2844, -4.8962, -0.0301, -2.7527, -2.8138, -4.8444, -7.6966, -6.9632, -4.6738, -2.8140, -0.0623, -2.6252, -5.3848, -7.9162, -10.2708, -8.6724, -9.2372, -8.3056, -7.0547, -5.5709, -5.1741, -3.2510, -1.2880, -3.5322, -4.7113, -3.9718, -3.8862, -2.5183, 6.7068, -2.5661, -4.9390, -10.1536, -11.8571, -12.1416, -8.7861, -8.7954, -7.7784, -6.8387, -4.8812, -2.0606, -0.6440, -2.7886, -3.8168, -3.5880, -2.8806, -1.6361, 9.7960, -2.7486, -4.9867, -8.9295, -8.7417, -8.0122, -8.2336, -7.6245, -8.1614, -13.5915, -18.5381, -7.6446, -8.1150, -7.6146, -6.8296, -7.8200, -3.5770, -7.4692, -12.7706, -14.1110, -9.3544, -11.3765, -9.6116, -7.3213, -5.3043, -2.3873, 0.2479, -2.3155, -3.7254, -3.4302, -5.0659, -11.0175, -12.2443, -13.8466, -14.9527, -15.3033])
    (interactions): ModuleList(
      (0): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
        (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
        (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
        (skip_tp): FullyConnectedTensorProduct(256x0e x 89x0e -> 256x0e+256x1o | 5832704 paths | 5832704 weights)
        (reshape): reshape_irreps()
      )
      (1): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(256x0e+256x1o -> 256x0e+256x1o | 131072 weights)
        (conv_tp): TensorProduct(256x0e+256x1o x 1x0e+1x1o+1x2e+1x3o -> 512x0e+768x1o+768x2e+512x3o | 2560 paths | 2560 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 2560]
        (linear): Linear(512x0e+768x1o+768x2e+512x3o -> 256x0e+256x1o+256x2e+256x3o | 655360 weights)
        (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o x 89x0e -> 256x0e | 5832704 paths | 5832704 weights)
        (reshape): reshape_irreps()
      )
    )
    (products): ModuleList(
      (0): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x256 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x256 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
            (1): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x6x256 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x256 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(256x0e+256x1o -> 256x0e+256x1o | 131072 weights)
      )
      (1): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x256 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x256 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(256x0e -> 256x0e | 65536 weights)
      )
    )
    (readouts): ModuleList(
      (0): LinearReadoutBlock(
        (linear): Linear(256x0e+256x1o -> 1x0e | 256 weights)
      )
      (1): NonLinearReadoutBlock(
        (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
        (non_linearity): Activation [x] (16x0e -> 16x0e)
        (linear_2): Linear(16x0e -> 1x0e | 16 weights)
      )
    )
    (scale_shift): ScaleShiftBlock(scale=0.804340, shift=0.164779)
  )
)
2023-10-23 12:24:08.120 INFO: Number of parameters: 15847440
2023-10-23 12:24:08.120 INFO: Optimizer: AcceleratedOptimizer (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.002
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.002
    maximize: False
    name: interactions_decay
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.002
    maximize: False
    name: interactions_no_decay
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.002
    maximize: False
    name: products
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.002
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2023-10-23 12:24:08.120 INFO: Using gradient clipping with tolerance=10.000
2023-10-23 12:24:08.121 INFO: Started training
2023-10-23 12:24:10.178 INFO: Reducer buckets have been rebuilt in this iteration.
2023-10-23 12:24:10.178 INFO: Reducer buckets have been rebuilt in this iteration.
2023-10-23 12:24:10.178 INFO: Reducer buckets have been rebuilt in this iteration.
2023-10-23 12:24:10.178 INFO: Reducer buckets have been rebuilt in this iteration.
2023-10-23 14:31:18.997 INFO: Epoch 96: loss=0.0012, MAE_E_per_atom=28.2 meV, MAE_F=69.0 meV / A
2023-10-23 14:31:18.998 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-96
2023-10-23 14:31:19.217 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-96/pytorch_model.bin
2023-10-23 14:31:19.736 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-96/optimizer.bin
2023-10-23 14:31:19.738 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-96/random_states_0.pkl
2023-10-23 18:37:41.947 INFO: Epoch 98: loss=0.0015, MAE_E_per_atom=28.3 meV, MAE_F=68.9 meV / A
2023-10-23 22:43:55.631 INFO: Epoch 100: loss=0.0014, MAE_E_per_atom=28.3 meV, MAE_F=68.8 meV / A
2023-10-24 02:50:33.115 INFO: Epoch 102: loss=0.0013, MAE_E_per_atom=28.3 meV, MAE_F=68.5 meV / A
2023-10-24 06:57:08.848 INFO: Epoch 104: loss=0.0015, MAE_E_per_atom=28.2 meV, MAE_F=68.4 meV / A
2023-10-24 10:01:02.055 INFO: MACE version: 0.1.0
2023-10-24 10:01:02.055 INFO: Configuration: Namespace(name='MACE_MPtrj_2022.9', seed=42, log_dir='data-train-result/logs', model_dir='data-train-result', checkpoints_dir='data-train-result/checkpoints', results_dir='data-train-result/results', downloads_dir='data-train-result/downloads', default_dtype='float64', log_level='INFO', error_table='PerAtomMAE', model='ScaleShiftMACE', r_max=5.0, num_radial_basis=8, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='32x0e', num_channels=256, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=True, compute_forces=True, train_file='./data-train-preprocessed/train.h5', valid_file='./data-train-preprocessed/valid.h5', valid_fraction=0.1, test_file=None, test_dir=None, num_workers=8, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file='./data-train-preprocessed/statistics.json', E0s=None, energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='weighted', forces_weight=1.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=0.1, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=32, valid_batch_size=32, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=250, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=True, restart_lr=0.002, save_cpu=False, clip_grad=10.0, wandb=False, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-10-24 10:01:02.056 INFO: Using statistics json file
2023-10-24 10:01:02.056 INFO: Using atomic numbers from statistics file
2023-10-24 10:01:02.056 INFO: AtomicNumberTable: (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 89, 90, 91, 92, 93, 94)
2023-10-24 10:01:02.056 INFO: Atomic Energies not in training file, using command line argument E0s
2023-10-24 10:01:02.057 INFO: Atomic energies: [-3.6673775936325184, -1.321978574671279, -3.47815910592578, -4.724966512505185, -7.727941403300326, -8.404543836565129, -7.359429774977432, -7.284436081345614, -4.896162007436489, -0.03005797428312995, -2.7527187727369, -2.8138258116559136, -4.844369939040846, -7.6966307568316115, -6.96321292174237, -4.673811566998673, -2.813984104722163, -0.06233472731112788, -2.6251773081704863, -5.384791381758609, -7.916197568907359, -10.270820955634214, -8.672390387555845, -9.2371580345617, -8.305620224433062, -7.054671703876374, -5.570915377375696, -5.174147851464132, -3.251035550574451, -1.2879654275024013, -3.5321835252059812, -4.711328365973749, -3.9717755452456673, -3.886221455984922, -2.5183143168985502, 6.706842222672468, -2.566057480857263, -4.938993788294903, -10.153603816562159, -11.857062150232505, -12.14164656151253, -8.786094380920531, -8.795434431218645, -7.778351502991773, -6.838726494373795, -4.881216430056056, -2.0605586704343675, -0.6439905162993389, -2.788575343692543, -3.816810475940441, -3.587983770584603, -2.8805917608627976, -1.6360524330360255, 9.796001071919388, -2.7486371263604354, -4.986670776340143, -8.929476698318382, -8.74170685282431, -8.01217127881877, -8.233598378021814, -7.62454389634746, -8.161368139142393, -13.591451290378114, -18.538136714242995, -7.644552511106582, -8.115049752450005, -7.614570319217799, -6.82962645334957, -7.820026786949461, -3.5770491745130024, -7.469205400904766, -12.770648602823787, -14.110986902146283, -9.354405708044254, -11.376459286198285, -9.611613368883013, -7.321263077561875, -5.304305597659051, -2.3873175082519373, 0.24792131307789267, -2.31553585581406, -3.7254481655069127, -3.4301772252097935, -5.065907805804548, -11.017529306980132, -12.244262478240024, -13.846602972246156, -14.952721865054968, -15.303292182007306]
2023-10-24 10:01:02.105 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1.000)
2023-10-24 10:01:02.105 INFO: Average number of neighbors: 25.57754135131836
2023-10-24 10:01:02.105 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': True, 'dipoles': False}
2023-10-24 10:01:02.105 INFO: Building model
2023-10-24 10:01:02.105 INFO: Hidden irreps: 256x0e + 256x1o
2023-10-24 10:01:05.652 INFO: Loading states from data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-96
2023-10-24 10:01:05.764 INFO: All model weights loaded successfully
2023-10-24 10:01:05.968 INFO: All optimizer states loaded successfully
2023-10-24 10:01:05.968 INFO: All scheduler states loaded successfully
2023-10-24 10:01:05.975 INFO: All random states loaded successfully
2023-10-24 10:01:05.976 INFO: Loading in 0 custom states
2023-10-24 10:01:05.977 INFO: DistributedDataParallel(
  (module): ScaleShiftMACE(
    (node_embedding): LinearNodeEmbeddingBlock(
      (linear): Linear(89x0e -> 256x0e | 22784 weights)
    )
    (radial_embedding): RadialEmbeddingBlock(
      (bessel_fn): BesselBasis(r_max=4.5, num_basis=8, trainable=False)
      (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
    )
    (spherical_harmonics): SphericalHarmonics()
    (atomic_energies_fn): AtomicEnergiesBlock(energies=[-3.6674, -1.3220, -3.4782, -4.7250, -7.7279, -8.4045, -7.3594, -7.2844, -4.8962, -0.0301, -2.7527, -2.8138, -4.8444, -7.6966, -6.9632, -4.6738, -2.8140, -0.0623, -2.6252, -5.3848, -7.9162, -10.2708, -8.6724, -9.2372, -8.3056, -7.0547, -5.5709, -5.1741, -3.2510, -1.2880, -3.5322, -4.7113, -3.9718, -3.8862, -2.5183, 6.7068, -2.5661, -4.9390, -10.1536, -11.8571, -12.1416, -8.7861, -8.7954, -7.7784, -6.8387, -4.8812, -2.0606, -0.6440, -2.7886, -3.8168, -3.5880, -2.8806, -1.6361, 9.7960, -2.7486, -4.9867, -8.9295, -8.7417, -8.0122, -8.2336, -7.6245, -8.1614, -13.5915, -18.5381, -7.6446, -8.1150, -7.6146, -6.8296, -7.8200, -3.5770, -7.4692, -12.7706, -14.1110, -9.3544, -11.3765, -9.6116, -7.3213, -5.3043, -2.3873, 0.2479, -2.3155, -3.7254, -3.4302, -5.0659, -11.0175, -12.2443, -13.8466, -14.9527, -15.3033])
    (interactions): ModuleList(
      (0): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
        (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
        (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
        (skip_tp): FullyConnectedTensorProduct(256x0e x 89x0e -> 256x0e+256x1o | 5832704 paths | 5832704 weights)
        (reshape): reshape_irreps()
      )
      (1): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(256x0e+256x1o -> 256x0e+256x1o | 131072 weights)
        (conv_tp): TensorProduct(256x0e+256x1o x 1x0e+1x1o+1x2e+1x3o -> 512x0e+768x1o+768x2e+512x3o | 2560 paths | 2560 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 2560]
        (linear): Linear(512x0e+768x1o+768x2e+512x3o -> 256x0e+256x1o+256x2e+256x3o | 655360 weights)
        (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o x 89x0e -> 256x0e | 5832704 paths | 5832704 weights)
        (reshape): reshape_irreps()
      )
    )
    (products): ModuleList(
      (0): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x256 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x256 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
            (1): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x6x256 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x256 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(256x0e+256x1o -> 256x0e+256x1o | 131072 weights)
      )
      (1): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x256 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x256 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(256x0e -> 256x0e | 65536 weights)
      )
    )
    (readouts): ModuleList(
      (0): LinearReadoutBlock(
        (linear): Linear(256x0e+256x1o -> 1x0e | 256 weights)
      )
      (1): NonLinearReadoutBlock(
        (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
        (non_linearity): Activation [x] (16x0e -> 16x0e)
        (linear_2): Linear(16x0e -> 1x0e | 16 weights)
      )
    )
    (scale_shift): ScaleShiftBlock(scale=0.804340, shift=0.164779)
  )
)
2023-10-24 10:01:05.982 INFO: Number of parameters: 15847440
2023-10-24 10:01:05.983 INFO: Optimizer: AcceleratedOptimizer (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.002
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.002
    maximize: False
    name: interactions_decay
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.002
    maximize: False
    name: interactions_no_decay
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.002
    maximize: False
    name: products
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.002
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2023-10-24 10:01:05.983 INFO: Using gradient clipping with tolerance=10.000
2023-10-24 10:01:05.983 INFO: Started training
2023-10-24 10:01:08.076 INFO: Reducer buckets have been rebuilt in this iteration.
2023-10-24 10:01:08.076 INFO: Reducer buckets have been rebuilt in this iteration.
2023-10-24 10:01:08.076 INFO: Reducer buckets have been rebuilt in this iteration.
2023-10-24 10:01:08.076 INFO: Reducer buckets have been rebuilt in this iteration.
2023-10-24 12:07:43.555 INFO: Epoch 96: loss=0.0029, MAE_E_per_atom=24.1 meV, MAE_F=68.3 meV / A
2023-10-24 12:07:43.557 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-96
2023-10-24 12:07:43.753 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-96/pytorch_model.bin
2023-10-24 12:07:44.309 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-96/optimizer.bin
2023-10-24 12:07:44.312 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-96/random_states_0.pkl
2023-10-24 16:12:54.110 INFO: Epoch 98: loss=0.0028, MAE_E_per_atom=22.8 meV, MAE_F=67.5 meV / A
2023-10-24 16:12:54.150 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-98
2023-10-24 16:12:54.342 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-98/pytorch_model.bin
2023-10-24 16:12:54.785 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-98/optimizer.bin
2023-10-24 16:12:54.786 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-98/random_states_0.pkl
2023-10-24 20:18:07.306 INFO: Epoch 100: loss=0.0028, MAE_E_per_atom=22.1 meV, MAE_F=67.1 meV / A
2023-10-24 20:18:07.344 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-100
2023-10-24 20:18:07.537 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-100/pytorch_model.bin
2023-10-24 20:18:08.074 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-100/optimizer.bin
2023-10-24 20:18:08.076 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-100/random_states_0.pkl
2023-10-25 00:23:35.437 INFO: Epoch 102: loss=0.0028, MAE_E_per_atom=21.8 meV, MAE_F=66.6 meV / A
2023-10-25 00:23:35.471 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-102
2023-10-25 00:23:35.608 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-102/pytorch_model.bin
2023-10-25 00:23:35.962 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-102/optimizer.bin
2023-10-25 00:23:35.963 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-102/random_states_0.pkl
2023-10-25 04:29:02.894 INFO: Epoch 104: loss=0.0027, MAE_E_per_atom=21.4 meV, MAE_F=66.2 meV / A
2023-10-25 04:29:02.928 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-104
2023-10-25 04:29:03.060 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-104/pytorch_model.bin
2023-10-25 04:29:03.413 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-104/optimizer.bin
2023-10-25 04:29:03.414 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-104/random_states_0.pkl
2023-10-25 08:34:52.453 INFO: Epoch 106: loss=0.0027, MAE_E_per_atom=21.1 meV, MAE_F=65.9 meV / A
2023-10-25 08:34:52.489 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-106
2023-10-25 08:34:52.625 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-106/pytorch_model.bin
2023-10-25 08:34:52.989 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-106/optimizer.bin
2023-10-25 08:34:52.990 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-106/random_states_0.pkl
2023-10-25 12:41:10.433 INFO: Epoch 108: loss=0.0027, MAE_E_per_atom=20.8 meV, MAE_F=65.7 meV / A
2023-10-25 12:41:10.470 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-108
2023-10-25 12:41:10.661 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-108/pytorch_model.bin
2023-10-25 12:41:11.061 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-108/optimizer.bin
2023-10-25 12:41:11.062 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-108/random_states_0.pkl
2023-10-25 16:48:04.301 INFO: Epoch 110: loss=0.0027, MAE_E_per_atom=20.7 meV, MAE_F=65.3 meV / A
2023-10-25 16:48:04.334 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-110
2023-10-25 16:48:04.470 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-110/pytorch_model.bin
2023-10-25 16:48:04.834 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-110/optimizer.bin
2023-10-25 16:48:04.835 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-110/random_states_0.pkl
2023-10-25 20:57:18.759 INFO: Epoch 112: loss=0.0027, MAE_E_per_atom=20.5 meV, MAE_F=65.0 meV / A
2023-10-25 20:57:18.795 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-112
2023-10-25 20:57:18.982 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-112/pytorch_model.bin
2023-10-25 20:57:19.502 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-112/optimizer.bin
2023-10-25 20:57:19.503 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-112/random_states_0.pkl
2023-10-26 01:08:56.349 INFO: Epoch 114: loss=0.0027, MAE_E_per_atom=20.3 meV, MAE_F=64.9 meV / A
2023-10-26 01:08:56.385 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-114
2023-10-26 01:08:56.565 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-114/pytorch_model.bin
2023-10-26 01:08:57.071 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-114/optimizer.bin
2023-10-26 01:08:57.072 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-114/random_states_0.pkl
2023-10-26 05:24:55.029 INFO: Epoch 116: loss=0.0026, MAE_E_per_atom=20.1 meV, MAE_F=64.6 meV / A
2023-10-26 05:24:55.062 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-116
2023-10-26 05:24:55.196 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-116/pytorch_model.bin
2023-10-26 05:24:55.543 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-116/optimizer.bin
2023-10-26 05:24:55.544 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-116/random_states_0.pkl
2023-10-26 09:44:49.555 INFO: Epoch 118: loss=0.0026, MAE_E_per_atom=20.0 meV, MAE_F=64.3 meV / A
2023-10-26 09:44:49.600 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-118
2023-10-26 09:44:49.741 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-118/pytorch_model.bin
2023-10-26 09:44:50.093 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-118/optimizer.bin
2023-10-26 09:44:50.095 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-118/random_states_0.pkl
2023-10-26 11:56:52.407 INFO: MACE version: 0.1.0
2023-10-26 11:56:52.407 INFO: Configuration: Namespace(name='MACE_MPtrj_2022.9', seed=42, log_dir='data-train-result/logs', model_dir='data-train-result', checkpoints_dir='data-train-result/checkpoints', results_dir='data-train-result/results', downloads_dir='data-train-result/downloads', default_dtype='float64', log_level='INFO', error_table='PerAtomMAE', model='ScaleShiftMACE', r_max=5.0, num_radial_basis=8, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='32x0e', num_channels=256, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=True, compute_forces=True, train_file='./data-train-preprocessed/train.h5', valid_file='./data-train-preprocessed/valid.h5', valid_fraction=0.1, test_file=None, test_dir=None, num_workers=8, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file='./data-train-preprocessed/statistics.json', E0s=None, energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='weighted', forces_weight=1.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=0.1, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=32, valid_batch_size=32, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=250, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=True, restart_lr=0.005, save_cpu=False, clip_grad=10.0, wandb=False, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-10-26 11:56:52.408 INFO: Using statistics json file
2023-10-26 11:56:52.408 INFO: Using atomic numbers from statistics file
2023-10-26 11:56:52.408 INFO: AtomicNumberTable: (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 89, 90, 91, 92, 93, 94)
2023-10-26 11:56:52.408 INFO: Atomic Energies not in training file, using command line argument E0s
2023-10-26 11:56:52.409 INFO: Atomic energies: [-3.6673775936325184, -1.321978574671279, -3.47815910592578, -4.724966512505185, -7.727941403300326, -8.404543836565129, -7.359429774977432, -7.284436081345614, -4.896162007436489, -0.03005797428312995, -2.7527187727369, -2.8138258116559136, -4.844369939040846, -7.6966307568316115, -6.96321292174237, -4.673811566998673, -2.813984104722163, -0.06233472731112788, -2.6251773081704863, -5.384791381758609, -7.916197568907359, -10.270820955634214, -8.672390387555845, -9.2371580345617, -8.305620224433062, -7.054671703876374, -5.570915377375696, -5.174147851464132, -3.251035550574451, -1.2879654275024013, -3.5321835252059812, -4.711328365973749, -3.9717755452456673, -3.886221455984922, -2.5183143168985502, 6.706842222672468, -2.566057480857263, -4.938993788294903, -10.153603816562159, -11.857062150232505, -12.14164656151253, -8.786094380920531, -8.795434431218645, -7.778351502991773, -6.838726494373795, -4.881216430056056, -2.0605586704343675, -0.6439905162993389, -2.788575343692543, -3.816810475940441, -3.587983770584603, -2.8805917608627976, -1.6360524330360255, 9.796001071919388, -2.7486371263604354, -4.986670776340143, -8.929476698318382, -8.74170685282431, -8.01217127881877, -8.233598378021814, -7.62454389634746, -8.161368139142393, -13.591451290378114, -18.538136714242995, -7.644552511106582, -8.115049752450005, -7.614570319217799, -6.82962645334957, -7.820026786949461, -3.5770491745130024, -7.469205400904766, -12.770648602823787, -14.110986902146283, -9.354405708044254, -11.376459286198285, -9.611613368883013, -7.321263077561875, -5.304305597659051, -2.3873175082519373, 0.24792131307789267, -2.31553585581406, -3.7254481655069127, -3.4301772252097935, -5.065907805804548, -11.017529306980132, -12.244262478240024, -13.846602972246156, -14.952721865054968, -15.303292182007306]
2023-10-26 11:56:52.463 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1.000)
2023-10-26 11:56:52.463 INFO: Average number of neighbors: 25.57754135131836
2023-10-26 11:56:52.463 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': True, 'dipoles': False}
2023-10-26 11:56:52.463 INFO: Building model
2023-10-26 11:56:52.463 INFO: Hidden irreps: 256x0e + 256x1o
2023-10-26 11:56:55.851 INFO: Loading states from data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-118
2023-10-26 11:56:55.931 INFO: All model weights loaded successfully
2023-10-26 11:56:56.139 INFO: All optimizer states loaded successfully
2023-10-26 11:56:56.139 INFO: All scheduler states loaded successfully
2023-10-26 11:56:56.142 INFO: All random states loaded successfully
2023-10-26 11:56:56.143 INFO: Loading in 0 custom states
2023-10-26 11:56:56.143 INFO: DistributedDataParallel(
  (module): ScaleShiftMACE(
    (node_embedding): LinearNodeEmbeddingBlock(
      (linear): Linear(89x0e -> 256x0e | 22784 weights)
    )
    (radial_embedding): RadialEmbeddingBlock(
      (bessel_fn): BesselBasis(r_max=4.5, num_basis=8, trainable=False)
      (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
    )
    (spherical_harmonics): SphericalHarmonics()
    (atomic_energies_fn): AtomicEnergiesBlock(energies=[-3.6674, -1.3220, -3.4782, -4.7250, -7.7279, -8.4045, -7.3594, -7.2844, -4.8962, -0.0301, -2.7527, -2.8138, -4.8444, -7.6966, -6.9632, -4.6738, -2.8140, -0.0623, -2.6252, -5.3848, -7.9162, -10.2708, -8.6724, -9.2372, -8.3056, -7.0547, -5.5709, -5.1741, -3.2510, -1.2880, -3.5322, -4.7113, -3.9718, -3.8862, -2.5183, 6.7068, -2.5661, -4.9390, -10.1536, -11.8571, -12.1416, -8.7861, -8.7954, -7.7784, -6.8387, -4.8812, -2.0606, -0.6440, -2.7886, -3.8168, -3.5880, -2.8806, -1.6361, 9.7960, -2.7486, -4.9867, -8.9295, -8.7417, -8.0122, -8.2336, -7.6245, -8.1614, -13.5915, -18.5381, -7.6446, -8.1150, -7.6146, -6.8296, -7.8200, -3.5770, -7.4692, -12.7706, -14.1110, -9.3544, -11.3765, -9.6116, -7.3213, -5.3043, -2.3873, 0.2479, -2.3155, -3.7254, -3.4302, -5.0659, -11.0175, -12.2443, -13.8466, -14.9527, -15.3033])
    (interactions): ModuleList(
      (0): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
        (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
        (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
        (skip_tp): FullyConnectedTensorProduct(256x0e x 89x0e -> 256x0e+256x1o | 5832704 paths | 5832704 weights)
        (reshape): reshape_irreps()
      )
      (1): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(256x0e+256x1o -> 256x0e+256x1o | 131072 weights)
        (conv_tp): TensorProduct(256x0e+256x1o x 1x0e+1x1o+1x2e+1x3o -> 512x0e+768x1o+768x2e+512x3o | 2560 paths | 2560 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 2560]
        (linear): Linear(512x0e+768x1o+768x2e+512x3o -> 256x0e+256x1o+256x2e+256x3o | 655360 weights)
        (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o x 89x0e -> 256x0e | 5832704 paths | 5832704 weights)
        (reshape): reshape_irreps()
      )
    )
    (products): ModuleList(
      (0): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x256 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x256 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
            (1): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x6x256 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x256 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(256x0e+256x1o -> 256x0e+256x1o | 131072 weights)
      )
      (1): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x256 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x256 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(256x0e -> 256x0e | 65536 weights)
      )
    )
    (readouts): ModuleList(
      (0): LinearReadoutBlock(
        (linear): Linear(256x0e+256x1o -> 1x0e | 256 weights)
      )
      (1): NonLinearReadoutBlock(
        (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
        (non_linearity): Activation [x] (16x0e -> 16x0e)
        (linear_2): Linear(16x0e -> 1x0e | 16 weights)
      )
    )
    (scale_shift): ScaleShiftBlock(scale=0.804340, shift=0.164779)
  )
)
2023-10-26 11:56:56.148 INFO: Number of parameters: 15847440
2023-10-26 11:56:56.148 INFO: Optimizer: AcceleratedOptimizer (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.005
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.005
    maximize: False
    name: interactions_decay
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.005
    maximize: False
    name: interactions_no_decay
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.005
    maximize: False
    name: products
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.005
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2023-10-26 11:56:56.148 INFO: Using gradient clipping with tolerance=10.000
2023-10-26 11:56:56.148 INFO: Started training
2023-10-26 11:56:58.198 INFO: Reducer buckets have been rebuilt in this iteration.
2023-10-26 11:56:58.200 INFO: Reducer buckets have been rebuilt in this iteration.
2023-10-26 11:56:58.200 INFO: Reducer buckets have been rebuilt in this iteration.
2023-10-26 11:56:58.200 INFO: Reducer buckets have been rebuilt in this iteration.
2023-10-26 14:04:11.194 INFO: Epoch 118: loss=0.0027, MAE_E_per_atom=21.7 meV, MAE_F=66.0 meV / A
2023-10-26 14:04:11.197 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-118
2023-10-26 14:04:11.470 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-118/pytorch_model.bin
2023-10-26 14:04:12.197 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-118/optimizer.bin
2023-10-26 14:04:12.201 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-118/random_states_0.pkl
2023-10-26 18:10:29.444 INFO: Epoch 120: loss=0.0027, MAE_E_per_atom=21.5 meV, MAE_F=65.7 meV / A
2023-10-26 18:10:29.478 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-120
2023-10-26 18:10:29.659 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-120/pytorch_model.bin
2023-10-26 18:10:30.177 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-120/optimizer.bin
2023-10-26 18:10:30.179 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-120/random_states_0.pkl
2023-10-26 22:16:55.206 INFO: Epoch 122: loss=0.0027, MAE_E_per_atom=21.2 meV, MAE_F=65.4 meV / A
2023-10-26 22:16:55.237 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-122
2023-10-26 22:16:55.369 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-122/pytorch_model.bin
2023-10-26 22:16:55.720 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-122/optimizer.bin
2023-10-26 22:16:55.721 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-122/random_states_0.pkl
2023-10-27 02:23:21.823 INFO: Epoch 124: loss=0.0027, MAE_E_per_atom=21.0 meV, MAE_F=65.0 meV / A
2023-10-27 02:23:21.858 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-124
2023-10-27 02:23:22.006 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-124/pytorch_model.bin
2023-10-27 02:23:22.373 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-124/optimizer.bin
2023-10-27 02:23:22.374 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-124/random_states_0.pkl
2023-10-27 06:29:55.961 INFO: Epoch 126: loss=0.0027, MAE_E_per_atom=20.7 meV, MAE_F=64.9 meV / A
2023-10-27 06:29:55.998 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-126
2023-10-27 06:29:56.188 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-126/pytorch_model.bin
2023-10-27 06:29:56.627 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-126/optimizer.bin
2023-10-27 06:29:56.629 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-126/random_states_0.pkl
2023-10-27 10:37:00.617 INFO: Epoch 128: loss=0.0027, MAE_E_per_atom=20.5 meV, MAE_F=64.6 meV / A
2023-10-27 10:37:00.658 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-128
2023-10-27 10:37:00.854 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-128/pytorch_model.bin
2023-10-27 10:37:01.336 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-128/optimizer.bin
2023-10-27 10:37:01.337 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-128/random_states_0.pkl
2023-10-27 14:43:25.273 INFO: Epoch 130: loss=0.0026, MAE_E_per_atom=20.3 meV, MAE_F=64.5 meV / A
2023-10-27 14:43:25.306 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-130
2023-10-27 14:43:25.441 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-130/pytorch_model.bin
2023-10-27 14:43:25.801 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-130/optimizer.bin
2023-10-27 14:43:25.802 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-130/random_states_0.pkl
2023-10-27 18:51:26.487 INFO: Epoch 132: loss=0.0026, MAE_E_per_atom=20.2 meV, MAE_F=64.1 meV / A
2023-10-27 18:51:26.522 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-132
2023-10-27 18:51:26.654 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-132/pytorch_model.bin
2023-10-27 18:51:27.005 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-132/optimizer.bin
2023-10-27 18:51:27.007 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-132/random_states_0.pkl
2023-10-27 21:35:42.857 INFO: MACE version: 0.1.0
2023-10-27 21:35:42.857 INFO: Configuration: Namespace(name='MACE_MPtrj_2022.9', seed=42, log_dir='data-train-result/logs', model_dir='data-train-result', checkpoints_dir='data-train-result/checkpoints', results_dir='data-train-result/results', downloads_dir='data-train-result/downloads', default_dtype='float64', log_level='INFO', error_table='PerAtomMAE', model='ScaleShiftMACE', r_max=5.0, num_radial_basis=8, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='32x0e', num_channels=256, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=True, compute_forces=True, train_file='./data-train-preprocessed/train.h5', valid_file='./data-train-preprocessed/valid.h5', valid_fraction=0.1, test_file=None, test_dir=None, num_workers=8, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file='./data-train-preprocessed/statistics.json', E0s=None, energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='weighted', forces_weight=1.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=0.1, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=32, valid_batch_size=32, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=150, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=True, restart_lr=0.003, save_cpu=False, clip_grad=10.0, wandb=False, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-10-27 21:35:42.857 INFO: Using statistics json file
2023-10-27 21:35:42.857 INFO: Using atomic numbers from statistics file
2023-10-27 21:35:42.858 INFO: AtomicNumberTable: (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 89, 90, 91, 92, 93, 94)
2023-10-27 21:35:42.858 INFO: Atomic Energies not in training file, using command line argument E0s
2023-10-27 21:35:42.858 INFO: Atomic energies: [-3.6673775936325184, -1.321978574671279, -3.47815910592578, -4.724966512505185, -7.727941403300326, -8.404543836565129, -7.359429774977432, -7.284436081345614, -4.896162007436489, -0.03005797428312995, -2.7527187727369, -2.8138258116559136, -4.844369939040846, -7.6966307568316115, -6.96321292174237, -4.673811566998673, -2.813984104722163, -0.06233472731112788, -2.6251773081704863, -5.384791381758609, -7.916197568907359, -10.270820955634214, -8.672390387555845, -9.2371580345617, -8.305620224433062, -7.054671703876374, -5.570915377375696, -5.174147851464132, -3.251035550574451, -1.2879654275024013, -3.5321835252059812, -4.711328365973749, -3.9717755452456673, -3.886221455984922, -2.5183143168985502, 6.706842222672468, -2.566057480857263, -4.938993788294903, -10.153603816562159, -11.857062150232505, -12.14164656151253, -8.786094380920531, -8.795434431218645, -7.778351502991773, -6.838726494373795, -4.881216430056056, -2.0605586704343675, -0.6439905162993389, -2.788575343692543, -3.816810475940441, -3.587983770584603, -2.8805917608627976, -1.6360524330360255, 9.796001071919388, -2.7486371263604354, -4.986670776340143, -8.929476698318382, -8.74170685282431, -8.01217127881877, -8.233598378021814, -7.62454389634746, -8.161368139142393, -13.591451290378114, -18.538136714242995, -7.644552511106582, -8.115049752450005, -7.614570319217799, -6.82962645334957, -7.820026786949461, -3.5770491745130024, -7.469205400904766, -12.770648602823787, -14.110986902146283, -9.354405708044254, -11.376459286198285, -9.611613368883013, -7.321263077561875, -5.304305597659051, -2.3873175082519373, 0.24792131307789267, -2.31553585581406, -3.7254481655069127, -3.4301772252097935, -5.065907805804548, -11.017529306980132, -12.244262478240024, -13.846602972246156, -14.952721865054968, -15.303292182007306]
2023-10-27 21:35:42.896 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1.000)
2023-10-27 21:35:42.896 INFO: Average number of neighbors: 25.57754135131836
2023-10-27 21:35:42.896 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': True, 'dipoles': False}
2023-10-27 21:35:42.896 INFO: Building model
2023-10-27 21:35:42.896 INFO: Hidden irreps: 256x0e + 256x1o
2023-10-27 21:35:46.190 INFO: Loading states from data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-132
2023-10-27 21:35:46.272 INFO: All model weights loaded successfully
2023-10-27 21:35:46.495 INFO: All optimizer states loaded successfully
2023-10-27 21:35:46.495 INFO: All scheduler states loaded successfully
2023-10-27 21:35:46.499 INFO: All random states loaded successfully
2023-10-27 21:35:46.500 INFO: Loading in 0 custom states
2023-10-27 21:35:46.500 INFO: DistributedDataParallel(
  (module): ScaleShiftMACE(
    (node_embedding): LinearNodeEmbeddingBlock(
      (linear): Linear(89x0e -> 256x0e | 22784 weights)
    )
    (radial_embedding): RadialEmbeddingBlock(
      (bessel_fn): BesselBasis(r_max=4.5, num_basis=8, trainable=False)
      (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
    )
    (spherical_harmonics): SphericalHarmonics()
    (atomic_energies_fn): AtomicEnergiesBlock(energies=[-3.6674, -1.3220, -3.4782, -4.7250, -7.7279, -8.4045, -7.3594, -7.2844, -4.8962, -0.0301, -2.7527, -2.8138, -4.8444, -7.6966, -6.9632, -4.6738, -2.8140, -0.0623, -2.6252, -5.3848, -7.9162, -10.2708, -8.6724, -9.2372, -8.3056, -7.0547, -5.5709, -5.1741, -3.2510, -1.2880, -3.5322, -4.7113, -3.9718, -3.8862, -2.5183, 6.7068, -2.5661, -4.9390, -10.1536, -11.8571, -12.1416, -8.7861, -8.7954, -7.7784, -6.8387, -4.8812, -2.0606, -0.6440, -2.7886, -3.8168, -3.5880, -2.8806, -1.6361, 9.7960, -2.7486, -4.9867, -8.9295, -8.7417, -8.0122, -8.2336, -7.6245, -8.1614, -13.5915, -18.5381, -7.6446, -8.1150, -7.6146, -6.8296, -7.8200, -3.5770, -7.4692, -12.7706, -14.1110, -9.3544, -11.3765, -9.6116, -7.3213, -5.3043, -2.3873, 0.2479, -2.3155, -3.7254, -3.4302, -5.0659, -11.0175, -12.2443, -13.8466, -14.9527, -15.3033])
    (interactions): ModuleList(
      (0): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
        (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
        (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
        (skip_tp): FullyConnectedTensorProduct(256x0e x 89x0e -> 256x0e+256x1o | 5832704 paths | 5832704 weights)
        (reshape): reshape_irreps()
      )
      (1): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(256x0e+256x1o -> 256x0e+256x1o | 131072 weights)
        (conv_tp): TensorProduct(256x0e+256x1o x 1x0e+1x1o+1x2e+1x3o -> 512x0e+768x1o+768x2e+512x3o | 2560 paths | 2560 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 2560]
        (linear): Linear(512x0e+768x1o+768x2e+512x3o -> 256x0e+256x1o+256x2e+256x3o | 655360 weights)
        (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o x 89x0e -> 256x0e | 5832704 paths | 5832704 weights)
        (reshape): reshape_irreps()
      )
    )
    (products): ModuleList(
      (0): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x256 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x256 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
            (1): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x6x256 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x256 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(256x0e+256x1o -> 256x0e+256x1o | 131072 weights)
      )
      (1): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x256 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x256 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(256x0e -> 256x0e | 65536 weights)
      )
    )
    (readouts): ModuleList(
      (0): LinearReadoutBlock(
        (linear): Linear(256x0e+256x1o -> 1x0e | 256 weights)
      )
      (1): NonLinearReadoutBlock(
        (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
        (non_linearity): Activation [x] (16x0e -> 16x0e)
        (linear_2): Linear(16x0e -> 1x0e | 16 weights)
      )
    )
    (scale_shift): ScaleShiftBlock(scale=0.804340, shift=0.164779)
  )
)
2023-10-27 21:35:46.505 INFO: Number of parameters: 15847440
2023-10-27 21:35:46.505 INFO: Optimizer: AcceleratedOptimizer (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.003
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.003
    maximize: False
    name: interactions_decay
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.003
    maximize: False
    name: interactions_no_decay
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.003
    maximize: False
    name: products
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.003
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2023-10-27 21:35:46.505 INFO: Using gradient clipping with tolerance=10.000
2023-10-27 21:35:46.505 INFO: Started training
2023-10-27 21:35:48.554 INFO: Reducer buckets have been rebuilt in this iteration.
2023-10-27 21:35:48.554 INFO: Reducer buckets have been rebuilt in this iteration.
2023-10-27 21:35:48.554 INFO: Reducer buckets have been rebuilt in this iteration.
2023-10-27 21:35:48.554 INFO: Reducer buckets have been rebuilt in this iteration.
2023-10-27 23:43:11.004 INFO: Epoch 132: loss=0.0026, MAE_E_per_atom=19.1 meV, MAE_F=63.1 meV / A
2023-10-27 23:43:11.006 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-132
2023-10-27 23:43:11.281 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-132/pytorch_model.bin
2023-10-27 23:43:11.885 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-132/optimizer.bin
2023-10-27 23:43:11.887 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-132/random_states_0.pkl
2023-10-28 03:49:52.163 INFO: Epoch 134: loss=0.0026, MAE_E_per_atom=19.0 meV, MAE_F=62.8 meV / A
2023-10-28 03:49:52.199 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-134
2023-10-28 03:49:52.389 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-134/pytorch_model.bin
2023-10-28 03:49:52.860 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-134/optimizer.bin
2023-10-28 03:49:52.861 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-134/random_states_0.pkl
2023-10-28 07:56:41.562 INFO: Epoch 136: loss=0.0025, MAE_E_per_atom=18.9 meV, MAE_F=62.7 meV / A
2023-10-28 07:56:41.595 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-136
2023-10-28 07:56:41.728 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-136/pytorch_model.bin
2023-10-28 07:56:42.083 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-136/optimizer.bin
2023-10-28 07:56:42.084 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-136/random_states_0.pkl
2023-10-28 12:03:46.520 INFO: Epoch 138: loss=0.0025, MAE_E_per_atom=18.9 meV, MAE_F=62.5 meV / A
2023-10-28 12:03:46.564 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-138
2023-10-28 12:03:46.711 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-138/pytorch_model.bin
2023-10-28 12:03:47.064 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-138/optimizer.bin
2023-10-28 12:03:47.065 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-138/random_states_0.pkl
2023-10-28 16:10:49.719 INFO: Epoch 140: loss=0.0025, MAE_E_per_atom=18.7 meV, MAE_F=62.4 meV / A
2023-10-28 16:10:49.753 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-140
2023-10-28 16:10:49.937 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-140/pytorch_model.bin
2023-10-28 16:10:50.294 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-140/optimizer.bin
2023-10-28 16:10:50.295 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-140/random_states_0.pkl
2023-10-28 20:18:04.833 INFO: Epoch 142: loss=0.0025, MAE_E_per_atom=18.6 meV, MAE_F=62.2 meV / A
2023-10-28 20:18:04.866 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-142
2023-10-28 20:18:04.998 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-142/pytorch_model.bin
2023-10-28 20:18:05.349 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-142/optimizer.bin
2023-10-28 20:18:05.350 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-142/random_states_0.pkl
2023-10-29 00:25:51.018 INFO: Epoch 144: loss=0.0025, MAE_E_per_atom=18.6 meV, MAE_F=62.1 meV / A
2023-10-29 00:25:51.059 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-144
2023-10-29 00:25:51.252 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-144/pytorch_model.bin
2023-10-29 00:25:51.729 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-144/optimizer.bin
2023-10-29 00:25:51.730 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-144/random_states_0.pkl
2023-10-29 03:34:19.519 INFO: Epoch 146: loss=0.0025, MAE_E_per_atom=18.5 meV, MAE_F=61.9 meV / A
2023-10-29 03:34:19.551 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-146
2023-10-29 03:34:19.684 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-146/pytorch_model.bin
2023-10-29 03:34:20.041 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-146/optimizer.bin
2023-10-29 03:34:20.042 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-146/random_states_0.pkl
2023-10-29 07:45:03.261 INFO: Epoch 148: loss=0.0025, MAE_E_per_atom=18.4 meV, MAE_F=61.7 meV / A
2023-10-29 07:45:03.304 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-148
2023-10-29 07:45:03.496 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-148/pytorch_model.bin
2023-10-29 07:45:03.858 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-148/optimizer.bin
2023-10-29 07:45:03.859 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-148/random_states_0.pkl
2023-10-29 09:46:42.424 INFO: Training complete
2023-10-29 09:46:42.424 INFO: Computing metrics for training, validation, and test sets
2023-10-29 09:46:42.425 INFO: Loading states from data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-148
2023-10-29 09:46:42.499 INFO: All model weights loaded successfully
2023-10-29 09:46:42.683 INFO: All optimizer states loaded successfully
2023-10-29 09:46:42.683 INFO: All scheduler states loaded successfully
2023-10-29 09:46:42.684 INFO: All random states loaded successfully
2023-10-29 09:46:42.684 INFO: Loading in 0 custom states
2023-10-29 09:46:42.684 INFO: Loaded model from epoch 148
2023-10-29 09:46:42.684 INFO: Evaluating train ...
2023-10-29 10:36:02.588 INFO: Evaluating valid ...
2023-10-29 10:46:24.836 INFO: 
+-------------+--------------------+-----------------+------------------+
| config_type | MAE E / meV / atom | MAE F / meV / A | relative F MAE % |
+-------------+--------------------+-----------------+------------------+
|    train    |        17.8        |       59.9      |      37.90       |
|    valid    |        18.4        |       61.7      |      39.99       |
+-------------+--------------------+-----------------+------------------+
2023-10-29 10:46:24.839 INFO: Saving model to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42.model
2023-10-29 10:46:25.389 INFO: Done
2023-10-30 09:28:58.431 INFO: MACE version: 0.1.0
2023-10-30 09:28:58.431 INFO: Configuration: Namespace(name='MACE_MPtrj_2022.9', seed=42, log_dir='data-train-result/logs', model_dir='data-train-result', checkpoints_dir='data-train-result/checkpoints', results_dir='data-train-result/results', downloads_dir='data-train-result/downloads', default_dtype='float64', log_level='INFO', error_table='PerAtomMAE', model='ScaleShiftMACE', r_max=5.0, num_radial_basis=8, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='32x0e', num_channels=256, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=True, compute_forces=True, train_file='./data-train-preprocessed/train.h5', valid_file='./data-train-preprocessed/valid.h5', valid_fraction=0.1, test_file=None, test_dir=None, num_workers=8, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file='./data-train-preprocessed/statistics.json', E0s=None, energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='weighted', forces_weight=1.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=32, valid_batch_size=32, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=180, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=True, restart_lr=0.0005, save_cpu=False, clip_grad=10.0, wandb=False, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-10-30 09:28:58.431 INFO: Using statistics json file
2023-10-30 09:28:58.431 INFO: Using atomic numbers from statistics file
2023-10-30 09:28:58.431 INFO: AtomicNumberTable: (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 89, 90, 91, 92, 93, 94)
2023-10-30 09:28:58.431 INFO: Atomic Energies not in training file, using command line argument E0s
2023-10-30 09:28:58.432 INFO: Atomic energies: [-3.6673775936325184, -1.321978574671279, -3.47815910592578, -4.724966512505185, -7.727941403300326, -8.404543836565129, -7.359429774977432, -7.284436081345614, -4.896162007436489, -0.03005797428312995, -2.7527187727369, -2.8138258116559136, -4.844369939040846, -7.6966307568316115, -6.96321292174237, -4.673811566998673, -2.813984104722163, -0.06233472731112788, -2.6251773081704863, -5.384791381758609, -7.916197568907359, -10.270820955634214, -8.672390387555845, -9.2371580345617, -8.305620224433062, -7.054671703876374, -5.570915377375696, -5.174147851464132, -3.251035550574451, -1.2879654275024013, -3.5321835252059812, -4.711328365973749, -3.9717755452456673, -3.886221455984922, -2.5183143168985502, 6.706842222672468, -2.566057480857263, -4.938993788294903, -10.153603816562159, -11.857062150232505, -12.14164656151253, -8.786094380920531, -8.795434431218645, -7.778351502991773, -6.838726494373795, -4.881216430056056, -2.0605586704343675, -0.6439905162993389, -2.788575343692543, -3.816810475940441, -3.587983770584603, -2.8805917608627976, -1.6360524330360255, 9.796001071919388, -2.7486371263604354, -4.986670776340143, -8.929476698318382, -8.74170685282431, -8.01217127881877, -8.233598378021814, -7.62454389634746, -8.161368139142393, -13.591451290378114, -18.538136714242995, -7.644552511106582, -8.115049752450005, -7.614570319217799, -6.82962645334957, -7.820026786949461, -3.5770491745130024, -7.469205400904766, -12.770648602823787, -14.110986902146283, -9.354405708044254, -11.376459286198285, -9.611613368883013, -7.321263077561875, -5.304305597659051, -2.3873175082519373, 0.24792131307789267, -2.31553585581406, -3.7254481655069127, -3.4301772252097935, -5.065907805804548, -11.017529306980132, -12.244262478240024, -13.846602972246156, -14.952721865054968, -15.303292182007306]
2023-10-30 09:28:58.484 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1.000)
2023-10-30 09:28:58.484 INFO: Average number of neighbors: 25.57754135131836
2023-10-30 09:28:58.484 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': True, 'dipoles': False}
2023-10-30 09:28:58.484 INFO: Building model
2023-10-30 09:28:58.484 INFO: Hidden irreps: 256x0e + 256x1o
2023-10-30 09:29:01.931 INFO: Loading states from data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-148
2023-10-30 09:29:02.002 INFO: All model weights loaded successfully
2023-10-30 09:29:02.195 INFO: All optimizer states loaded successfully
2023-10-30 09:29:02.195 INFO: All scheduler states loaded successfully
2023-10-30 09:29:02.198 INFO: All random states loaded successfully
2023-10-30 09:29:02.199 INFO: Loading in 0 custom states
2023-10-30 09:29:02.200 INFO: DistributedDataParallel(
  (module): ScaleShiftMACE(
    (node_embedding): LinearNodeEmbeddingBlock(
      (linear): Linear(89x0e -> 256x0e | 22784 weights)
    )
    (radial_embedding): RadialEmbeddingBlock(
      (bessel_fn): BesselBasis(r_max=4.5, num_basis=8, trainable=False)
      (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
    )
    (spherical_harmonics): SphericalHarmonics()
    (atomic_energies_fn): AtomicEnergiesBlock(energies=[-3.6674, -1.3220, -3.4782, -4.7250, -7.7279, -8.4045, -7.3594, -7.2844, -4.8962, -0.0301, -2.7527, -2.8138, -4.8444, -7.6966, -6.9632, -4.6738, -2.8140, -0.0623, -2.6252, -5.3848, -7.9162, -10.2708, -8.6724, -9.2372, -8.3056, -7.0547, -5.5709, -5.1741, -3.2510, -1.2880, -3.5322, -4.7113, -3.9718, -3.8862, -2.5183, 6.7068, -2.5661, -4.9390, -10.1536, -11.8571, -12.1416, -8.7861, -8.7954, -7.7784, -6.8387, -4.8812, -2.0606, -0.6440, -2.7886, -3.8168, -3.5880, -2.8806, -1.6361, 9.7960, -2.7486, -4.9867, -8.9295, -8.7417, -8.0122, -8.2336, -7.6245, -8.1614, -13.5915, -18.5381, -7.6446, -8.1150, -7.6146, -6.8296, -7.8200, -3.5770, -7.4692, -12.7706, -14.1110, -9.3544, -11.3765, -9.6116, -7.3213, -5.3043, -2.3873, 0.2479, -2.3155, -3.7254, -3.4302, -5.0659, -11.0175, -12.2443, -13.8466, -14.9527, -15.3033])
    (interactions): ModuleList(
      (0): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
        (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
        (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
        (skip_tp): FullyConnectedTensorProduct(256x0e x 89x0e -> 256x0e+256x1o | 5832704 paths | 5832704 weights)
        (reshape): reshape_irreps()
      )
      (1): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(256x0e+256x1o -> 256x0e+256x1o | 131072 weights)
        (conv_tp): TensorProduct(256x0e+256x1o x 1x0e+1x1o+1x2e+1x3o -> 512x0e+768x1o+768x2e+512x3o | 2560 paths | 2560 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 2560]
        (linear): Linear(512x0e+768x1o+768x2e+512x3o -> 256x0e+256x1o+256x2e+256x3o | 655360 weights)
        (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o x 89x0e -> 256x0e | 5832704 paths | 5832704 weights)
        (reshape): reshape_irreps()
      )
    )
    (products): ModuleList(
      (0): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x256 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x256 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
            (1): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x6x256 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x256 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(256x0e+256x1o -> 256x0e+256x1o | 131072 weights)
      )
      (1): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x256 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x256 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(256x0e -> 256x0e | 65536 weights)
      )
    )
    (readouts): ModuleList(
      (0): LinearReadoutBlock(
        (linear): Linear(256x0e+256x1o -> 1x0e | 256 weights)
      )
      (1): NonLinearReadoutBlock(
        (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
        (non_linearity): Activation [x] (16x0e -> 16x0e)
        (linear_2): Linear(16x0e -> 1x0e | 16 weights)
      )
    )
    (scale_shift): ScaleShiftBlock(scale=0.804340, shift=0.164779)
  )
)
2023-10-30 09:29:02.204 INFO: Number of parameters: 15847440
2023-10-30 09:29:02.204 INFO: Optimizer: AcceleratedOptimizer (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: interactions_decay
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: interactions_no_decay
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: products
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2023-10-30 09:29:02.204 INFO: Using gradient clipping with tolerance=10.000
2023-10-30 09:29:02.204 INFO: Started training
2023-10-30 09:29:04.213 INFO: Reducer buckets have been rebuilt in this iteration.
2023-10-30 09:29:04.213 INFO: Reducer buckets have been rebuilt in this iteration.
2023-10-30 09:29:04.213 INFO: Reducer buckets have been rebuilt in this iteration.
2023-10-30 09:29:04.214 INFO: Reducer buckets have been rebuilt in this iteration.
2023-10-30 11:35:48.889 INFO: Epoch 148: loss=0.0024, MAE_E_per_atom=17.1 meV, MAE_F=60.5 meV / A
2023-10-30 11:35:48.890 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-148
2023-10-30 11:35:49.076 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-148/pytorch_model.bin
2023-10-30 11:35:49.597 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-148/optimizer.bin
2023-10-30 11:35:49.599 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-148/random_states_0.pkl
2023-10-30 15:41:05.290 INFO: Epoch 150: loss=0.0024, MAE_E_per_atom=16.9 meV, MAE_F=60.4 meV / A
2023-10-30 15:41:05.326 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-150
2023-10-30 15:41:05.513 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-150/pytorch_model.bin
2023-10-30 15:41:06.027 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-150/optimizer.bin
2023-10-30 15:41:06.029 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-150/random_states_0.pkl
2023-10-30 19:46:32.989 INFO: Epoch 152: loss=0.0024, MAE_E_per_atom=16.8 meV, MAE_F=60.3 meV / A
2023-10-30 19:46:33.024 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-152
2023-10-30 19:46:33.164 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-152/pytorch_model.bin
2023-10-30 19:46:33.537 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-152/optimizer.bin
2023-10-30 19:46:33.538 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-152/random_states_0.pkl
2023-10-30 23:52:14.352 INFO: Epoch 154: loss=0.0024, MAE_E_per_atom=16.8 meV, MAE_F=60.2 meV / A
2023-10-30 23:52:14.385 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-154
2023-10-30 23:52:14.519 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-154/pytorch_model.bin
2023-10-30 23:52:14.869 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-154/optimizer.bin
2023-10-30 23:52:14.870 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-154/random_states_0.pkl
2023-10-31 03:57:47.860 INFO: Epoch 156: loss=0.0024, MAE_E_per_atom=16.6 meV, MAE_F=60.1 meV / A
2023-10-31 03:57:47.898 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-156
2023-10-31 03:57:48.084 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-156/pytorch_model.bin
2023-10-31 03:57:48.515 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-156/optimizer.bin
2023-10-31 03:57:48.516 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-156/random_states_0.pkl
2023-10-31 08:03:36.988 INFO: Epoch 158: loss=0.0024, MAE_E_per_atom=16.6 meV, MAE_F=60.0 meV / A
2023-10-31 08:03:37.019 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-158
2023-10-31 08:03:37.149 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-158/pytorch_model.bin
2023-10-31 08:03:37.498 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-158/optimizer.bin
2023-10-31 08:03:37.499 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-158/random_states_0.pkl
2023-10-31 12:09:55.597 INFO: Epoch 160: loss=0.0024, MAE_E_per_atom=16.6 meV, MAE_F=59.9 meV / A
2023-10-31 12:09:55.632 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-160
2023-10-31 12:09:55.766 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-160/pytorch_model.bin
2023-10-31 12:09:56.124 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-160/optimizer.bin
2023-10-31 12:09:56.125 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-160/random_states_0.pkl
2023-10-31 16:17:02.940 INFO: Epoch 162: loss=0.0024, MAE_E_per_atom=16.5 meV, MAE_F=59.8 meV / A
2023-10-31 16:17:02.973 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-162
2023-10-31 16:17:03.108 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-162/pytorch_model.bin
2023-10-31 16:17:03.471 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-162/optimizer.bin
2023-10-31 16:17:03.472 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-162/random_states_0.pkl
2023-10-31 20:26:18.261 INFO: Epoch 164: loss=0.0024, MAE_E_per_atom=16.5 meV, MAE_F=59.8 meV / A
2023-10-31 20:26:18.298 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-164
2023-10-31 20:26:18.484 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-164/pytorch_model.bin
2023-10-31 20:26:18.853 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-164/optimizer.bin
2023-10-31 20:26:18.854 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-164/random_states_0.pkl
2023-11-01 00:37:38.999 INFO: Epoch 166: loss=0.0024, MAE_E_per_atom=16.4 meV, MAE_F=59.7 meV / A
2023-11-01 04:53:34.507 INFO: Epoch 168: loss=0.0024, MAE_E_per_atom=16.4 meV, MAE_F=59.6 meV / A
2023-11-01 09:13:29.750 INFO: Epoch 170: loss=0.0024, MAE_E_per_atom=16.3 meV, MAE_F=59.5 meV / A
2023-11-01 09:13:29.785 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-170
2023-11-01 09:13:29.919 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-170/pytorch_model.bin
2023-11-01 09:13:30.277 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-170/optimizer.bin
2023-11-01 09:13:30.278 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-170/random_states_0.pkl
2023-11-01 13:37:34.785 INFO: Epoch 172: loss=0.0024, MAE_E_per_atom=16.3 meV, MAE_F=59.5 meV / A
2023-11-01 13:37:34.821 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-172
2023-11-01 13:37:35.008 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-172/pytorch_model.bin
2023-11-01 13:37:35.406 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-172/optimizer.bin
2023-11-01 13:37:35.407 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-172/random_states_0.pkl
2023-11-01 18:07:14.022 INFO: Epoch 174: loss=0.0024, MAE_E_per_atom=16.3 meV, MAE_F=59.4 meV / A
2023-11-01 22:42:48.393 INFO: Epoch 176: loss=0.0024, MAE_E_per_atom=16.2 meV, MAE_F=59.4 meV / A
2023-11-01 22:42:48.429 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-176
2023-11-01 22:42:48.611 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-176/pytorch_model.bin
2023-11-01 22:42:48.990 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-176/optimizer.bin
2023-11-01 22:42:48.991 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-176/random_states_0.pkl
2023-11-02 03:24:39.955 INFO: Epoch 178: loss=0.0024, MAE_E_per_atom=16.2 meV, MAE_F=59.3 meV / A
2023-11-02 03:24:39.989 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-178
2023-11-02 03:24:40.165 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-178/pytorch_model.bin
2023-11-02 03:24:40.607 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-178/optimizer.bin
2023-11-02 03:24:40.608 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-178/random_states_0.pkl
2023-11-02 05:39:40.922 INFO: Training complete
2023-11-02 05:39:40.923 INFO: Computing metrics for training, validation, and test sets
2023-11-02 05:39:40.923 INFO: Loading states from data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-178
2023-11-02 05:39:40.999 INFO: All model weights loaded successfully
2023-11-02 05:39:41.218 INFO: All optimizer states loaded successfully
2023-11-02 05:39:41.219 INFO: All scheduler states loaded successfully
2023-11-02 05:39:41.219 INFO: All random states loaded successfully
2023-11-02 05:39:41.220 INFO: Loading in 0 custom states
2023-11-02 05:39:41.220 INFO: Loaded model from epoch 178
2023-11-02 05:39:41.220 INFO: Evaluating train ...
2023-11-02 06:44:39.046 INFO: Evaluating valid ...
2023-11-02 06:58:11.526 INFO: 
+-------------+--------------------+-----------------+------------------+
| config_type | MAE E / meV / atom | MAE F / meV / A | relative F MAE % |
+-------------+--------------------+-----------------+------------------+
|    train    |        15.5        |       57.2      |      36.19       |
|    valid    |        16.2        |       59.3      |      38.47       |
+-------------+--------------------+-----------------+------------------+
2023-11-02 06:58:11.528 INFO: Saving model to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42.model
2023-11-02 06:58:11.972 INFO: Done
2023-11-02 09:24:19.175 INFO: MACE version: 0.1.0
2023-11-02 09:24:19.175 INFO: Configuration: Namespace(name='MACE_MPtrj_2022.9', seed=42, log_dir='data-train-result/logs', model_dir='data-train-result', checkpoints_dir='data-train-result/checkpoints', results_dir='data-train-result/results', downloads_dir='data-train-result/downloads', default_dtype='float64', log_level='INFO', error_table='PerAtomMAE', model='ScaleShiftMACE', r_max=5.0, num_radial_basis=8, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='32x0e', num_channels=256, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=True, compute_forces=True, train_file='./data-train-preprocessed/train.h5', valid_file='./data-train-preprocessed/valid.h5', valid_fraction=0.1, test_file=None, test_dir=None, num_workers=8, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file='./data-train-preprocessed/statistics.json', E0s=None, energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='weighted', forces_weight=1.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=32, valid_batch_size=32, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=200, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=True, restart_lr=0.0002, save_cpu=False, clip_grad=10.0, wandb=False, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-11-02 09:24:19.175 INFO: Using statistics json file
2023-11-02 09:24:19.175 INFO: Using atomic numbers from statistics file
2023-11-02 09:24:19.175 INFO: AtomicNumberTable: (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 89, 90, 91, 92, 93, 94)
2023-11-02 09:24:19.176 INFO: Atomic Energies not in training file, using command line argument E0s
2023-11-02 09:24:19.176 INFO: Atomic energies: [-3.6673775936325184, -1.321978574671279, -3.47815910592578, -4.724966512505185, -7.727941403300326, -8.404543836565129, -7.359429774977432, -7.284436081345614, -4.896162007436489, -0.03005797428312995, -2.7527187727369, -2.8138258116559136, -4.844369939040846, -7.6966307568316115, -6.96321292174237, -4.673811566998673, -2.813984104722163, -0.06233472731112788, -2.6251773081704863, -5.384791381758609, -7.916197568907359, -10.270820955634214, -8.672390387555845, -9.2371580345617, -8.305620224433062, -7.054671703876374, -5.570915377375696, -5.174147851464132, -3.251035550574451, -1.2879654275024013, -3.5321835252059812, -4.711328365973749, -3.9717755452456673, -3.886221455984922, -2.5183143168985502, 6.706842222672468, -2.566057480857263, -4.938993788294903, -10.153603816562159, -11.857062150232505, -12.14164656151253, -8.786094380920531, -8.795434431218645, -7.778351502991773, -6.838726494373795, -4.881216430056056, -2.0605586704343675, -0.6439905162993389, -2.788575343692543, -3.816810475940441, -3.587983770584603, -2.8805917608627976, -1.6360524330360255, 9.796001071919388, -2.7486371263604354, -4.986670776340143, -8.929476698318382, -8.74170685282431, -8.01217127881877, -8.233598378021814, -7.62454389634746, -8.161368139142393, -13.591451290378114, -18.538136714242995, -7.644552511106582, -8.115049752450005, -7.614570319217799, -6.82962645334957, -7.820026786949461, -3.5770491745130024, -7.469205400904766, -12.770648602823787, -14.110986902146283, -9.354405708044254, -11.376459286198285, -9.611613368883013, -7.321263077561875, -5.304305597659051, -2.3873175082519373, 0.24792131307789267, -2.31553585581406, -3.7254481655069127, -3.4301772252097935, -5.065907805804548, -11.017529306980132, -12.244262478240024, -13.846602972246156, -14.952721865054968, -15.303292182007306]
2023-11-02 09:24:19.229 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1.000)
2023-11-02 09:24:19.229 INFO: Average number of neighbors: 25.57754135131836
2023-11-02 09:24:19.229 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': True, 'dipoles': False}
2023-11-02 09:24:19.229 INFO: Building model
2023-11-02 09:24:19.229 INFO: Hidden irreps: 256x0e + 256x1o
2023-11-02 09:24:22.568 INFO: Loading states from data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-178
2023-11-02 09:24:22.640 INFO: All model weights loaded successfully
2023-11-02 09:24:22.833 INFO: All optimizer states loaded successfully
2023-11-02 09:24:22.833 INFO: All scheduler states loaded successfully
2023-11-02 09:24:22.835 INFO: All random states loaded successfully
2023-11-02 09:24:22.835 INFO: Loading in 0 custom states
2023-11-02 09:24:22.836 INFO: DistributedDataParallel(
  (module): ScaleShiftMACE(
    (node_embedding): LinearNodeEmbeddingBlock(
      (linear): Linear(89x0e -> 256x0e | 22784 weights)
    )
    (radial_embedding): RadialEmbeddingBlock(
      (bessel_fn): BesselBasis(r_max=4.5, num_basis=8, trainable=False)
      (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
    )
    (spherical_harmonics): SphericalHarmonics()
    (atomic_energies_fn): AtomicEnergiesBlock(energies=[-3.6674, -1.3220, -3.4782, -4.7250, -7.7279, -8.4045, -7.3594, -7.2844, -4.8962, -0.0301, -2.7527, -2.8138, -4.8444, -7.6966, -6.9632, -4.6738, -2.8140, -0.0623, -2.6252, -5.3848, -7.9162, -10.2708, -8.6724, -9.2372, -8.3056, -7.0547, -5.5709, -5.1741, -3.2510, -1.2880, -3.5322, -4.7113, -3.9718, -3.8862, -2.5183, 6.7068, -2.5661, -4.9390, -10.1536, -11.8571, -12.1416, -8.7861, -8.7954, -7.7784, -6.8387, -4.8812, -2.0606, -0.6440, -2.7886, -3.8168, -3.5880, -2.8806, -1.6361, 9.7960, -2.7486, -4.9867, -8.9295, -8.7417, -8.0122, -8.2336, -7.6245, -8.1614, -13.5915, -18.5381, -7.6446, -8.1150, -7.6146, -6.8296, -7.8200, -3.5770, -7.4692, -12.7706, -14.1110, -9.3544, -11.3765, -9.6116, -7.3213, -5.3043, -2.3873, 0.2479, -2.3155, -3.7254, -3.4302, -5.0659, -11.0175, -12.2443, -13.8466, -14.9527, -15.3033])
    (interactions): ModuleList(
      (0): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
        (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
        (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
        (skip_tp): FullyConnectedTensorProduct(256x0e x 89x0e -> 256x0e+256x1o | 5832704 paths | 5832704 weights)
        (reshape): reshape_irreps()
      )
      (1): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(256x0e+256x1o -> 256x0e+256x1o | 131072 weights)
        (conv_tp): TensorProduct(256x0e+256x1o x 1x0e+1x1o+1x2e+1x3o -> 512x0e+768x1o+768x2e+512x3o | 2560 paths | 2560 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 2560]
        (linear): Linear(512x0e+768x1o+768x2e+512x3o -> 256x0e+256x1o+256x2e+256x3o | 655360 weights)
        (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o x 89x0e -> 256x0e | 5832704 paths | 5832704 weights)
        (reshape): reshape_irreps()
      )
    )
    (products): ModuleList(
      (0): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x256 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x256 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
            (1): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x6x256 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x256 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(256x0e+256x1o -> 256x0e+256x1o | 131072 weights)
      )
      (1): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x256 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x256 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(256x0e -> 256x0e | 65536 weights)
      )
    )
    (readouts): ModuleList(
      (0): LinearReadoutBlock(
        (linear): Linear(256x0e+256x1o -> 1x0e | 256 weights)
      )
      (1): NonLinearReadoutBlock(
        (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
        (non_linearity): Activation [x] (16x0e -> 16x0e)
        (linear_2): Linear(16x0e -> 1x0e | 16 weights)
      )
    )
    (scale_shift): ScaleShiftBlock(scale=0.804340, shift=0.164779)
  )
)
2023-11-02 09:24:22.840 INFO: Number of parameters: 15847440
2023-11-02 09:24:22.840 INFO: Optimizer: AcceleratedOptimizer (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    name: interactions_decay
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    name: interactions_no_decay
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    name: products
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2023-11-02 09:24:22.841 INFO: Using gradient clipping with tolerance=10.000
2023-11-02 09:24:22.841 INFO: Started training
2023-11-02 09:24:24.886 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-02 09:24:24.886 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-02 09:24:24.886 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-02 09:24:24.886 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-02 11:31:15.545 INFO: Epoch 178: loss=0.0023, MAE_E_per_atom=15.9 meV, MAE_F=59.1 meV / A
2023-11-02 11:31:15.547 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-178
2023-11-02 11:31:15.741 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-178/pytorch_model.bin
2023-11-02 11:31:16.263 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-178/optimizer.bin
2023-11-02 11:31:16.265 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-178/random_states_0.pkl
2023-11-02 15:37:00.171 INFO: Epoch 180: loss=0.0023, MAE_E_per_atom=15.9 meV, MAE_F=59.1 meV / A
2023-11-02 19:42:14.525 INFO: Epoch 182: loss=0.0023, MAE_E_per_atom=15.8 meV, MAE_F=59.1 meV / A
2023-11-02 23:48:15.572 INFO: Epoch 184: loss=0.0023, MAE_E_per_atom=15.9 meV, MAE_F=59.0 meV / A
2023-11-02 23:48:15.606 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-184
2023-11-02 23:48:15.740 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-184/pytorch_model.bin
2023-11-02 23:48:16.096 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-184/optimizer.bin
2023-11-02 23:48:16.097 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-184/random_states_0.pkl
2023-11-03 03:54:20.172 INFO: Epoch 186: loss=0.0023, MAE_E_per_atom=15.8 meV, MAE_F=59.0 meV / A
2023-11-03 08:00:47.795 INFO: Epoch 188: loss=0.0023, MAE_E_per_atom=15.8 meV, MAE_F=59.0 meV / A
2023-11-03 13:04:37.744 INFO: MACE version: 0.1.0
2023-11-03 13:04:37.745 INFO: Configuration: Namespace(name='MACE_MPtrj_2022.9', seed=42, log_dir='data-train-result/logs', model_dir='data-train-result', checkpoints_dir='data-train-result/checkpoints', results_dir='data-train-result/results', downloads_dir='data-train-result/downloads', default_dtype='float64', log_level='INFO', error_table='PerAtomMAE', model='ScaleShiftMACE', r_max=5.0, num_radial_basis=8, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='32x0e', num_channels=256, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=True, compute_forces=True, train_file='./data-train-preprocessed/train.h5', valid_file='./data-train-preprocessed/valid.h5', valid_fraction=0.1, test_file=None, test_dir=None, num_workers=8, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file='./data-train-preprocessed/statistics.json', E0s=None, energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='weighted', forces_weight=1.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=32, valid_batch_size=32, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=200, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=True, restart_lr=0.0002, save_cpu=False, clip_grad=10.0, wandb=False, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-11-03 13:04:37.746 INFO: Using statistics json file
2023-11-03 13:04:37.746 INFO: Using atomic numbers from statistics file
2023-11-03 13:04:37.746 INFO: AtomicNumberTable: (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 89, 90, 91, 92, 93, 94)
2023-11-03 13:04:37.746 INFO: Atomic Energies not in training file, using command line argument E0s
2023-11-03 13:04:37.747 INFO: Atomic energies: [-3.6673775936325184, -1.321978574671279, -3.47815910592578, -4.724966512505185, -7.727941403300326, -8.404543836565129, -7.359429774977432, -7.284436081345614, -4.896162007436489, -0.03005797428312995, -2.7527187727369, -2.8138258116559136, -4.844369939040846, -7.6966307568316115, -6.96321292174237, -4.673811566998673, -2.813984104722163, -0.06233472731112788, -2.6251773081704863, -5.384791381758609, -7.916197568907359, -10.270820955634214, -8.672390387555845, -9.2371580345617, -8.305620224433062, -7.054671703876374, -5.570915377375696, -5.174147851464132, -3.251035550574451, -1.2879654275024013, -3.5321835252059812, -4.711328365973749, -3.9717755452456673, -3.886221455984922, -2.5183143168985502, 6.706842222672468, -2.566057480857263, -4.938993788294903, -10.153603816562159, -11.857062150232505, -12.14164656151253, -8.786094380920531, -8.795434431218645, -7.778351502991773, -6.838726494373795, -4.881216430056056, -2.0605586704343675, -0.6439905162993389, -2.788575343692543, -3.816810475940441, -3.587983770584603, -2.8805917608627976, -1.6360524330360255, 9.796001071919388, -2.7486371263604354, -4.986670776340143, -8.929476698318382, -8.74170685282431, -8.01217127881877, -8.233598378021814, -7.62454389634746, -8.161368139142393, -13.591451290378114, -18.538136714242995, -7.644552511106582, -8.115049752450005, -7.614570319217799, -6.82962645334957, -7.820026786949461, -3.5770491745130024, -7.469205400904766, -12.770648602823787, -14.110986902146283, -9.354405708044254, -11.376459286198285, -9.611613368883013, -7.321263077561875, -5.304305597659051, -2.3873175082519373, 0.24792131307789267, -2.31553585581406, -3.7254481655069127, -3.4301772252097935, -5.065907805804548, -11.017529306980132, -12.244262478240024, -13.846602972246156, -14.952721865054968, -15.303292182007306]
2023-11-03 13:04:41.661 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1.000)
2023-11-03 13:04:41.663 INFO: Average number of neighbors: 25.57754135131836
2023-11-03 13:04:41.663 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': True, 'dipoles': False}
2023-11-03 13:04:41.663 INFO: Building model
2023-11-03 13:04:41.663 INFO: Hidden irreps: 256x0e + 256x1o
2023-11-03 13:04:45.548 INFO: Loading states from data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-184
2023-11-03 13:04:45.705 INFO: All model weights loaded successfully
2023-11-03 13:04:46.132 INFO: All optimizer states loaded successfully
2023-11-03 13:04:46.132 INFO: All scheduler states loaded successfully
2023-11-03 13:04:46.138 INFO: All random states loaded successfully
2023-11-03 13:04:46.138 INFO: Loading in 0 custom states
2023-11-03 13:04:46.140 INFO: DistributedDataParallel(
  (module): ScaleShiftMACE(
    (node_embedding): LinearNodeEmbeddingBlock(
      (linear): Linear(89x0e -> 256x0e | 22784 weights)
    )
    (radial_embedding): RadialEmbeddingBlock(
      (bessel_fn): BesselBasis(r_max=4.5, num_basis=8, trainable=False)
      (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
    )
    (spherical_harmonics): SphericalHarmonics()
    (atomic_energies_fn): AtomicEnergiesBlock(energies=[-3.6674, -1.3220, -3.4782, -4.7250, -7.7279, -8.4045, -7.3594, -7.2844, -4.8962, -0.0301, -2.7527, -2.8138, -4.8444, -7.6966, -6.9632, -4.6738, -2.8140, -0.0623, -2.6252, -5.3848, -7.9162, -10.2708, -8.6724, -9.2372, -8.3056, -7.0547, -5.5709, -5.1741, -3.2510, -1.2880, -3.5322, -4.7113, -3.9718, -3.8862, -2.5183, 6.7068, -2.5661, -4.9390, -10.1536, -11.8571, -12.1416, -8.7861, -8.7954, -7.7784, -6.8387, -4.8812, -2.0606, -0.6440, -2.7886, -3.8168, -3.5880, -2.8806, -1.6361, 9.7960, -2.7486, -4.9867, -8.9295, -8.7417, -8.0122, -8.2336, -7.6245, -8.1614, -13.5915, -18.5381, -7.6446, -8.1150, -7.6146, -6.8296, -7.8200, -3.5770, -7.4692, -12.7706, -14.1110, -9.3544, -11.3765, -9.6116, -7.3213, -5.3043, -2.3873, 0.2479, -2.3155, -3.7254, -3.4302, -5.0659, -11.0175, -12.2443, -13.8466, -14.9527, -15.3033])
    (interactions): ModuleList(
      (0): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
        (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
        (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
        (skip_tp): FullyConnectedTensorProduct(256x0e x 89x0e -> 256x0e+256x1o | 5832704 paths | 5832704 weights)
        (reshape): reshape_irreps()
      )
      (1): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(256x0e+256x1o -> 256x0e+256x1o | 131072 weights)
        (conv_tp): TensorProduct(256x0e+256x1o x 1x0e+1x1o+1x2e+1x3o -> 512x0e+768x1o+768x2e+512x3o | 2560 paths | 2560 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 2560]
        (linear): Linear(512x0e+768x1o+768x2e+512x3o -> 256x0e+256x1o+256x2e+256x3o | 655360 weights)
        (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o x 89x0e -> 256x0e | 5832704 paths | 5832704 weights)
        (reshape): reshape_irreps()
      )
    )
    (products): ModuleList(
      (0): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x256 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x256 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
            (1): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x6x256 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x256 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(256x0e+256x1o -> 256x0e+256x1o | 131072 weights)
      )
      (1): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x256 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x256 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(256x0e -> 256x0e | 65536 weights)
      )
    )
    (readouts): ModuleList(
      (0): LinearReadoutBlock(
        (linear): Linear(256x0e+256x1o -> 1x0e | 256 weights)
      )
      (1): NonLinearReadoutBlock(
        (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
        (non_linearity): Activation [x] (16x0e -> 16x0e)
        (linear_2): Linear(16x0e -> 1x0e | 16 weights)
      )
    )
    (scale_shift): ScaleShiftBlock(scale=0.804340, shift=0.164779)
  )
)
2023-11-03 13:04:46.144 INFO: Number of parameters: 15847440
2023-11-03 13:04:46.144 INFO: Optimizer: AcceleratedOptimizer (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    name: interactions_decay
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    name: interactions_no_decay
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    name: products
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0002
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2023-11-03 13:04:46.144 INFO: Using gradient clipping with tolerance=10.000
2023-11-03 13:04:46.144 INFO: Started training
2023-11-03 13:04:48.510 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-03 13:04:48.511 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-03 13:04:48.511 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-03 13:04:48.511 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-03 15:11:27.971 INFO: Epoch 184: loss=0.0023, MAE_E_per_atom=15.8 meV, MAE_F=59.0 meV / A
2023-11-03 15:11:27.972 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-184
2023-11-03 15:11:28.213 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-184/pytorch_model.bin
2023-11-03 15:11:28.912 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-184/optimizer.bin
2023-11-03 15:11:28.916 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-184/random_states_0.pkl
2023-11-03 19:17:07.976 INFO: Epoch 186: loss=0.0023, MAE_E_per_atom=15.8 meV, MAE_F=59.0 meV / A
2023-11-03 23:22:39.943 INFO: Epoch 188: loss=0.0023, MAE_E_per_atom=15.7 meV, MAE_F=59.0 meV / A
2023-11-04 03:28:29.915 INFO: Epoch 190: loss=0.0023, MAE_E_per_atom=15.8 meV, MAE_F=58.9 meV / A
2023-11-04 03:28:29.957 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-190
2023-11-04 03:28:30.143 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-190/pytorch_model.bin
2023-11-04 03:28:30.663 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-190/optimizer.bin
2023-11-04 03:28:30.665 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-190/random_states_0.pkl
2023-11-04 07:34:19.259 INFO: Epoch 192: loss=0.0023, MAE_E_per_atom=15.7 meV, MAE_F=58.9 meV / A
2023-11-04 11:40:24.587 INFO: Epoch 194: loss=0.0023, MAE_E_per_atom=15.7 meV, MAE_F=58.8 meV / A
2023-11-04 13:55:00.912 INFO: MACE version: 0.1.0
2023-11-04 13:55:00.912 INFO: Configuration: Namespace(name='MACE_MPtrj_2022.9', seed=42, log_dir='data-train-result/logs', model_dir='data-train-result', checkpoints_dir='data-train-result/checkpoints', results_dir='data-train-result/results', downloads_dir='data-train-result/downloads', default_dtype='float64', log_level='INFO', error_table='PerAtomMAE', model='ScaleShiftMACE', r_max=5.0, num_radial_basis=8, num_cutoff_basis=5, interaction='RealAgnosticResidualInteractionBlock', interaction_first='RealAgnosticResidualInteractionBlock', max_ell=3, correlation=3, num_interactions=2, MLP_irreps='16x0e', hidden_irreps='32x0e', num_channels=256, max_L=1, gate='silu', scaling='rms_forces_scaling', avg_num_neighbors=1, compute_avg_num_neighbors=True, compute_stress=True, compute_forces=True, train_file='./data-train-preprocessed/train.h5', valid_file='./data-train-preprocessed/valid.h5', valid_fraction=0.1, test_file=None, test_dir=None, num_workers=8, pin_memory=True, atomic_numbers=None, mean=None, std=None, statistics_file='./data-train-preprocessed/statistics.json', E0s=None, energy_key='energy', forces_key='forces', virials_key='virials', stress_key='stress', dipole_key='dipole', charges_key='charges', loss='weighted', forces_weight=1.0, swa_forces_weight=1.0, energy_weight=1.0, swa_energy_weight=1000.0, virials_weight=1.0, swa_virials_weight=10.0, stress_weight=1.0, swa_stress_weight=10.0, dipole_weight=1.0, swa_dipole_weight=1.0, config_type_weights='{"Default":1.0}', optimizer='adam', batch_size=32, valid_batch_size=32, lr=0.01, swa_lr=0.001, weight_decay=5e-07, amsgrad=True, scheduler='ReduceLROnPlateau', lr_factor=0.8, scheduler_patience=50, lr_scheduler_gamma=0.9993, swa=False, start_swa=None, ema=True, ema_decay=0.99, max_num_epochs=200, patience=2048, eval_interval=2, keep_checkpoints=False, restart_latest=True, restart_lr=0.001, save_cpu=False, clip_grad=10.0, wandb=False, wandb_project='', wandb_entity='', wandb_name='', wandb_log_hypers=['num_channels', 'max_L', 'correlation', 'lr', 'swa_lr', 'weight_decay', 'batch_size', 'max_num_epochs', 'start_swa', 'energy_weight', 'forces_weight'])
2023-11-04 13:55:00.912 INFO: Using statistics json file
2023-11-04 13:55:00.912 INFO: Using atomic numbers from statistics file
2023-11-04 13:55:00.912 INFO: AtomicNumberTable: (1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 89, 90, 91, 92, 93, 94)
2023-11-04 13:55:00.913 INFO: Atomic Energies not in training file, using command line argument E0s
2023-11-04 13:55:00.913 INFO: Atomic energies: [-3.6673775936325184, -1.321978574671279, -3.47815910592578, -4.724966512505185, -7.727941403300326, -8.404543836565129, -7.359429774977432, -7.284436081345614, -4.896162007436489, -0.03005797428312995, -2.7527187727369, -2.8138258116559136, -4.844369939040846, -7.6966307568316115, -6.96321292174237, -4.673811566998673, -2.813984104722163, -0.06233472731112788, -2.6251773081704863, -5.384791381758609, -7.916197568907359, -10.270820955634214, -8.672390387555845, -9.2371580345617, -8.305620224433062, -7.054671703876374, -5.570915377375696, -5.174147851464132, -3.251035550574451, -1.2879654275024013, -3.5321835252059812, -4.711328365973749, -3.9717755452456673, -3.886221455984922, -2.5183143168985502, 6.706842222672468, -2.566057480857263, -4.938993788294903, -10.153603816562159, -11.857062150232505, -12.14164656151253, -8.786094380920531, -8.795434431218645, -7.778351502991773, -6.838726494373795, -4.881216430056056, -2.0605586704343675, -0.6439905162993389, -2.788575343692543, -3.816810475940441, -3.587983770584603, -2.8805917608627976, -1.6360524330360255, 9.796001071919388, -2.7486371263604354, -4.986670776340143, -8.929476698318382, -8.74170685282431, -8.01217127881877, -8.233598378021814, -7.62454389634746, -8.161368139142393, -13.591451290378114, -18.538136714242995, -7.644552511106582, -8.115049752450005, -7.614570319217799, -6.82962645334957, -7.820026786949461, -3.5770491745130024, -7.469205400904766, -12.770648602823787, -14.110986902146283, -9.354405708044254, -11.376459286198285, -9.611613368883013, -7.321263077561875, -5.304305597659051, -2.3873175082519373, 0.24792131307789267, -2.31553585581406, -3.7254481655069127, -3.4301772252097935, -5.065907805804548, -11.017529306980132, -12.244262478240024, -13.846602972246156, -14.952721865054968, -15.303292182007306]
2023-11-04 13:55:00.974 INFO: WeightedEnergyForcesLoss(energy_weight=1.000, forces_weight=1.000)
2023-11-04 13:55:00.974 INFO: Average number of neighbors: 25.57754135131836
2023-11-04 13:55:00.974 INFO: Selected the following outputs: {'energy': True, 'forces': True, 'virials': False, 'stress': True, 'dipoles': False}
2023-11-04 13:55:00.974 INFO: Building model
2023-11-04 13:55:00.974 INFO: Hidden irreps: 256x0e + 256x1o
2023-11-04 13:55:04.480 INFO: Loading states from data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-190
2023-11-04 13:55:04.582 INFO: All model weights loaded successfully
2023-11-04 13:55:04.786 INFO: All optimizer states loaded successfully
2023-11-04 13:55:04.786 INFO: All scheduler states loaded successfully
2023-11-04 13:55:04.791 INFO: All random states loaded successfully
2023-11-04 13:55:04.792 INFO: Loading in 0 custom states
2023-11-04 13:55:04.793 INFO: DistributedDataParallel(
  (module): ScaleShiftMACE(
    (node_embedding): LinearNodeEmbeddingBlock(
      (linear): Linear(89x0e -> 256x0e | 22784 weights)
    )
    (radial_embedding): RadialEmbeddingBlock(
      (bessel_fn): BesselBasis(r_max=4.5, num_basis=8, trainable=False)
      (cutoff_fn): PolynomialCutoff(p=5.0, r_max=4.5)
    )
    (spherical_harmonics): SphericalHarmonics()
    (atomic_energies_fn): AtomicEnergiesBlock(energies=[-3.6674, -1.3220, -3.4782, -4.7250, -7.7279, -8.4045, -7.3594, -7.2844, -4.8962, -0.0301, -2.7527, -2.8138, -4.8444, -7.6966, -6.9632, -4.6738, -2.8140, -0.0623, -2.6252, -5.3848, -7.9162, -10.2708, -8.6724, -9.2372, -8.3056, -7.0547, -5.5709, -5.1741, -3.2510, -1.2880, -3.5322, -4.7113, -3.9718, -3.8862, -2.5183, 6.7068, -2.5661, -4.9390, -10.1536, -11.8571, -12.1416, -8.7861, -8.7954, -7.7784, -6.8387, -4.8812, -2.0606, -0.6440, -2.7886, -3.8168, -3.5880, -2.8806, -1.6361, 9.7960, -2.7486, -4.9867, -8.9295, -8.7417, -8.0122, -8.2336, -7.6245, -8.1614, -13.5915, -18.5381, -7.6446, -8.1150, -7.6146, -6.8296, -7.8200, -3.5770, -7.4692, -12.7706, -14.1110, -9.3544, -11.3765, -9.6116, -7.3213, -5.3043, -2.3873, 0.2479, -2.3155, -3.7254, -3.4302, -5.0659, -11.0175, -12.2443, -13.8466, -14.9527, -15.3033])
    (interactions): ModuleList(
      (0): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(256x0e -> 256x0e | 65536 weights)
        (conv_tp): TensorProduct(256x0e x 1x0e+1x1o+1x2e+1x3o -> 256x0e+256x1o+256x2e+256x3o | 1024 paths | 1024 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 1024]
        (linear): Linear(256x0e+256x1o+256x2e+256x3o -> 256x0e+256x1o+256x2e+256x3o | 262144 weights)
        (skip_tp): FullyConnectedTensorProduct(256x0e x 89x0e -> 256x0e+256x1o | 5832704 paths | 5832704 weights)
        (reshape): reshape_irreps()
      )
      (1): RealAgnosticResidualInteractionBlock(
        (linear_up): Linear(256x0e+256x1o -> 256x0e+256x1o | 131072 weights)
        (conv_tp): TensorProduct(256x0e+256x1o x 1x0e+1x1o+1x2e+1x3o -> 512x0e+768x1o+768x2e+512x3o | 2560 paths | 2560 weights)
        (conv_tp_weights): FullyConnectedNet[8, 64, 64, 64, 2560]
        (linear): Linear(512x0e+768x1o+768x2e+512x3o -> 256x0e+256x1o+256x2e+256x3o | 655360 weights)
        (skip_tp): FullyConnectedTensorProduct(256x0e+256x1o x 89x0e -> 256x0e | 5832704 paths | 5832704 weights)
        (reshape): reshape_irreps()
      )
    )
    (products): ModuleList(
      (0): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x256 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x256 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
            (1): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x6x256 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x256 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(256x0e+256x1o -> 256x0e+256x1o | 131072 weights)
      )
      (1): EquivariantProductBasisBlock(
        (symmetric_contractions): SymmetricContraction(
          (contractions): ModuleList(
            (0): Contraction(
              (contractions_weighting): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (contractions_features): ModuleList(
                (0-1): 2 x GraphModule()
              )
              (weights): ParameterList(
                  (0): Parameter containing: [torch.float64 of size 89x4x256 (GPU 0)]
                  (1): Parameter containing: [torch.float64 of size 89x1x256 (GPU 0)]
              )
              (graph_opt_main): GraphModule()
            )
          )
        )
        (linear): Linear(256x0e -> 256x0e | 65536 weights)
      )
    )
    (readouts): ModuleList(
      (0): LinearReadoutBlock(
        (linear): Linear(256x0e+256x1o -> 1x0e | 256 weights)
      )
      (1): NonLinearReadoutBlock(
        (linear_1): Linear(256x0e -> 16x0e | 4096 weights)
        (non_linearity): Activation [x] (16x0e -> 16x0e)
        (linear_2): Linear(16x0e -> 1x0e | 16 weights)
      )
    )
    (scale_shift): ScaleShiftBlock(scale=0.804340, shift=0.164779)
  )
)
2023-11-04 13:55:04.797 INFO: Number of parameters: 15847440
2023-11-04 13:55:04.797 INFO: Optimizer: AcceleratedOptimizer (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    name: embedding
    weight_decay: 0.0

Parameter Group 1
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    name: interactions_decay
    weight_decay: 5e-07

Parameter Group 2
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    name: interactions_no_decay
    weight_decay: 0.0

Parameter Group 3
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    name: products
    weight_decay: 5e-07

Parameter Group 4
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    name: readouts
    weight_decay: 0.0
)
2023-11-04 13:55:04.797 INFO: Using gradient clipping with tolerance=10.000
2023-11-04 13:55:04.798 INFO: Started training
2023-11-04 13:55:06.767 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-04 13:55:06.767 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-04 13:55:06.768 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-04 13:55:06.768 INFO: Reducer buckets have been rebuilt in this iteration.
2023-11-04 16:01:50.630 INFO: Epoch 190: loss=0.0024, MAE_E_per_atom=16.5 meV, MAE_F=59.5 meV / A
2023-11-04 16:01:50.632 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-190
2023-11-04 16:01:50.901 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-190/pytorch_model.bin
2023-11-04 16:01:51.564 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-190/optimizer.bin
2023-11-04 16:01:51.571 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-190/random_states_0.pkl
2023-11-04 20:07:18.877 INFO: Epoch 192: loss=0.0024, MAE_E_per_atom=16.5 meV, MAE_F=59.4 meV / A
2023-11-05 00:12:57.065 INFO: Epoch 194: loss=0.0024, MAE_E_per_atom=16.4 meV, MAE_F=59.3 meV / A
2023-11-05 00:12:57.102 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-194
2023-11-05 00:12:57.234 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-194/pytorch_model.bin
2023-11-05 00:12:57.586 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-194/optimizer.bin
2023-11-05 00:12:57.587 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-194/random_states_0.pkl
2023-11-05 04:18:43.641 INFO: Epoch 196: loss=0.0024, MAE_E_per_atom=16.5 meV, MAE_F=59.2 meV / A
2023-11-05 04:18:43.688 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-196
2023-11-05 04:18:43.880 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-196/pytorch_model.bin
2023-11-05 04:18:44.237 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-196/optimizer.bin
2023-11-05 04:18:44.238 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-196/random_states_0.pkl
2023-11-05 08:24:22.190 INFO: Epoch 198: loss=0.0024, MAE_E_per_atom=16.3 meV, MAE_F=59.2 meV / A
2023-11-05 08:24:22.234 INFO: Saving current state to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-198
2023-11-05 08:24:22.371 INFO: Model weights saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-198/pytorch_model.bin
2023-11-05 08:24:22.726 INFO: Optimizer state saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-198/optimizer.bin
2023-11-05 08:24:22.727 INFO: Random states saved in data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-198/random_states_0.pkl
2023-11-05 10:23:09.412 INFO: Training complete
2023-11-05 10:23:09.413 INFO: Computing metrics for training, validation, and test sets
2023-11-05 10:23:09.413 INFO: Loading states from data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42_epoch-198
2023-11-05 10:23:09.482 INFO: All model weights loaded successfully
2023-11-05 10:23:09.677 INFO: All optimizer states loaded successfully
2023-11-05 10:23:09.677 INFO: All scheduler states loaded successfully
2023-11-05 10:23:09.677 INFO: All random states loaded successfully
2023-11-05 10:23:09.678 INFO: Loading in 0 custom states
2023-11-05 10:23:09.678 INFO: Loaded model from epoch 198
2023-11-05 10:23:09.678 INFO: Evaluating train ...
2023-11-05 11:04:17.004 INFO: Evaluating valid ...
2023-11-05 11:12:40.613 INFO: 
+-------------+--------------------+-----------------+------------------+
| config_type | MAE E / meV / atom | MAE F / meV / A | relative F MAE % |
+-------------+--------------------+-----------------+------------------+
|    train    |        15.7        |       57.1      |      36.12       |
|    valid    |        16.3        |       59.2      |      38.39       |
+-------------+--------------------+-----------------+------------------+
2023-11-05 11:12:40.617 INFO: Saving model to data-train-result/checkpoints/MACE_MPtrj_2022.9_run-42.model
2023-11-05 11:12:41.216 INFO: Done
